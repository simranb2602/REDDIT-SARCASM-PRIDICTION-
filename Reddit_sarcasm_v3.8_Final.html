<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>0eeff75dfcd245008033e6ef24a9681b</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<div class="cell code" data-execution_count="1"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="snKZ9-OBdkff" data-outputId="78f4b2ae-040b-4556-8475-4c35f3ee3d45">
<div class="sourceCode" id="cb1"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pip install tensorflow</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pip install keras</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pip install KerasClassifier</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pip install swifter</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pip install emoji</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>python <span class="op">-</span>m spacy download en_core_web_md</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> google.colab <span class="im">import</span> drive</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>drive.mount(<span class="st">&#39;/content/drive&#39;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Requirement already satisfied: tensorflow in /usr/local/lib/python3.10/dist-packages (2.15.0)
Requirement already satisfied: absl-py&gt;=1.0.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow) (1.4.0)
Requirement already satisfied: astunparse&gt;=1.6.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow) (1.6.3)
Requirement already satisfied: flatbuffers&gt;=23.5.26 in /usr/local/lib/python3.10/dist-packages (from tensorflow) (24.3.25)
Requirement already satisfied: gast!=0.5.0,!=0.5.1,!=0.5.2,&gt;=0.2.1 in /usr/local/lib/python3.10/dist-packages (from tensorflow) (0.5.4)
Requirement already satisfied: google-pasta&gt;=0.1.1 in /usr/local/lib/python3.10/dist-packages (from tensorflow) (0.2.0)
Requirement already satisfied: h5py&gt;=2.9.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow) (3.9.0)
Requirement already satisfied: libclang&gt;=13.0.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow) (18.1.1)
Requirement already satisfied: ml-dtypes~=0.2.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow) (0.2.0)
Requirement already satisfied: numpy&lt;2.0.0,&gt;=1.23.5 in /usr/local/lib/python3.10/dist-packages (from tensorflow) (1.25.2)
Requirement already satisfied: opt-einsum&gt;=2.3.2 in /usr/local/lib/python3.10/dist-packages (from tensorflow) (3.3.0)
Requirement already satisfied: packaging in /usr/local/lib/python3.10/dist-packages (from tensorflow) (24.0)
Requirement already satisfied: protobuf!=4.21.0,!=4.21.1,!=4.21.2,!=4.21.3,!=4.21.4,!=4.21.5,&lt;5.0.0dev,&gt;=3.20.3 in /usr/local/lib/python3.10/dist-packages (from tensorflow) (3.20.3)
Requirement already satisfied: setuptools in /usr/local/lib/python3.10/dist-packages (from tensorflow) (67.7.2)
Requirement already satisfied: six&gt;=1.12.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow) (1.16.0)
Requirement already satisfied: termcolor&gt;=1.1.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow) (2.4.0)
Requirement already satisfied: typing-extensions&gt;=3.6.6 in /usr/local/lib/python3.10/dist-packages (from tensorflow) (4.11.0)
Requirement already satisfied: wrapt&lt;1.15,&gt;=1.11.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow) (1.14.1)
Requirement already satisfied: tensorflow-io-gcs-filesystem&gt;=0.23.1 in /usr/local/lib/python3.10/dist-packages (from tensorflow) (0.36.0)
Requirement already satisfied: grpcio&lt;2.0,&gt;=1.24.3 in /usr/local/lib/python3.10/dist-packages (from tensorflow) (1.62.1)
Requirement already satisfied: tensorboard&lt;2.16,&gt;=2.15 in /usr/local/lib/python3.10/dist-packages (from tensorflow) (2.15.2)
Requirement already satisfied: tensorflow-estimator&lt;2.16,&gt;=2.15.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow) (2.15.0)
Requirement already satisfied: keras&lt;2.16,&gt;=2.15.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow) (2.15.0)
Requirement already satisfied: wheel&lt;1.0,&gt;=0.23.0 in /usr/local/lib/python3.10/dist-packages (from astunparse&gt;=1.6.0-&gt;tensorflow) (0.43.0)
Requirement already satisfied: google-auth&lt;3,&gt;=1.6.3 in /usr/local/lib/python3.10/dist-packages (from tensorboard&lt;2.16,&gt;=2.15-&gt;tensorflow) (2.27.0)
Requirement already satisfied: google-auth-oauthlib&lt;2,&gt;=0.5 in /usr/local/lib/python3.10/dist-packages (from tensorboard&lt;2.16,&gt;=2.15-&gt;tensorflow) (1.2.0)
Requirement already satisfied: markdown&gt;=2.6.8 in /usr/local/lib/python3.10/dist-packages (from tensorboard&lt;2.16,&gt;=2.15-&gt;tensorflow) (3.6)
Requirement already satisfied: requests&lt;3,&gt;=2.21.0 in /usr/local/lib/python3.10/dist-packages (from tensorboard&lt;2.16,&gt;=2.15-&gt;tensorflow) (2.31.0)
Requirement already satisfied: tensorboard-data-server&lt;0.8.0,&gt;=0.7.0 in /usr/local/lib/python3.10/dist-packages (from tensorboard&lt;2.16,&gt;=2.15-&gt;tensorflow) (0.7.2)
Requirement already satisfied: werkzeug&gt;=1.0.1 in /usr/local/lib/python3.10/dist-packages (from tensorboard&lt;2.16,&gt;=2.15-&gt;tensorflow) (3.0.2)
Requirement already satisfied: cachetools&lt;6.0,&gt;=2.0.0 in /usr/local/lib/python3.10/dist-packages (from google-auth&lt;3,&gt;=1.6.3-&gt;tensorboard&lt;2.16,&gt;=2.15-&gt;tensorflow) (5.3.3)
Requirement already satisfied: pyasn1-modules&gt;=0.2.1 in /usr/local/lib/python3.10/dist-packages (from google-auth&lt;3,&gt;=1.6.3-&gt;tensorboard&lt;2.16,&gt;=2.15-&gt;tensorflow) (0.4.0)
Requirement already satisfied: rsa&lt;5,&gt;=3.1.4 in /usr/local/lib/python3.10/dist-packages (from google-auth&lt;3,&gt;=1.6.3-&gt;tensorboard&lt;2.16,&gt;=2.15-&gt;tensorflow) (4.9)
Requirement already satisfied: requests-oauthlib&gt;=0.7.0 in /usr/local/lib/python3.10/dist-packages (from google-auth-oauthlib&lt;2,&gt;=0.5-&gt;tensorboard&lt;2.16,&gt;=2.15-&gt;tensorflow) (1.3.1)
Requirement already satisfied: charset-normalizer&lt;4,&gt;=2 in /usr/local/lib/python3.10/dist-packages (from requests&lt;3,&gt;=2.21.0-&gt;tensorboard&lt;2.16,&gt;=2.15-&gt;tensorflow) (3.3.2)
Requirement already satisfied: idna&lt;4,&gt;=2.5 in /usr/local/lib/python3.10/dist-packages (from requests&lt;3,&gt;=2.21.0-&gt;tensorboard&lt;2.16,&gt;=2.15-&gt;tensorflow) (3.6)
Requirement already satisfied: urllib3&lt;3,&gt;=1.21.1 in /usr/local/lib/python3.10/dist-packages (from requests&lt;3,&gt;=2.21.0-&gt;tensorboard&lt;2.16,&gt;=2.15-&gt;tensorflow) (2.0.7)
Requirement already satisfied: certifi&gt;=2017.4.17 in /usr/local/lib/python3.10/dist-packages (from requests&lt;3,&gt;=2.21.0-&gt;tensorboard&lt;2.16,&gt;=2.15-&gt;tensorflow) (2024.2.2)
Requirement already satisfied: MarkupSafe&gt;=2.1.1 in /usr/local/lib/python3.10/dist-packages (from werkzeug&gt;=1.0.1-&gt;tensorboard&lt;2.16,&gt;=2.15-&gt;tensorflow) (2.1.5)
Requirement already satisfied: pyasn1&lt;0.7.0,&gt;=0.4.6 in /usr/local/lib/python3.10/dist-packages (from pyasn1-modules&gt;=0.2.1-&gt;google-auth&lt;3,&gt;=1.6.3-&gt;tensorboard&lt;2.16,&gt;=2.15-&gt;tensorflow) (0.6.0)
Requirement already satisfied: oauthlib&gt;=3.0.0 in /usr/local/lib/python3.10/dist-packages (from requests-oauthlib&gt;=0.7.0-&gt;google-auth-oauthlib&lt;2,&gt;=0.5-&gt;tensorboard&lt;2.16,&gt;=2.15-&gt;tensorflow) (3.2.2)
Requirement already satisfied: keras in /usr/local/lib/python3.10/dist-packages (2.15.0)
ERROR: Could not find a version that satisfies the requirement KerasClassifier (from versions: none)
ERROR: No matching distribution found for KerasClassifier
Collecting swifter
  Downloading swifter-1.4.0.tar.gz (1.2 MB)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 1.2/1.2 MB 20.0 MB/s eta 0:00:00
etadata (setup.py) ... ent already satisfied: pandas&gt;=1.0.0 in /usr/local/lib/python3.10/dist-packages (from swifter) (2.0.3)
Requirement already satisfied: psutil&gt;=5.6.6 in /usr/local/lib/python3.10/dist-packages (from swifter) (5.9.5)
Requirement already satisfied: dask[dataframe]&gt;=2.10.0 in /usr/local/lib/python3.10/dist-packages (from swifter) (2023.8.1)
Requirement already satisfied: tqdm&gt;=4.33.0 in /usr/local/lib/python3.10/dist-packages (from swifter) (4.66.2)
Requirement already satisfied: click&gt;=8.0 in /usr/local/lib/python3.10/dist-packages (from dask[dataframe]&gt;=2.10.0-&gt;swifter) (8.1.7)
Requirement already satisfied: cloudpickle&gt;=1.5.0 in /usr/local/lib/python3.10/dist-packages (from dask[dataframe]&gt;=2.10.0-&gt;swifter) (2.2.1)
Requirement already satisfied: fsspec&gt;=2021.09.0 in /usr/local/lib/python3.10/dist-packages (from dask[dataframe]&gt;=2.10.0-&gt;swifter) (2023.6.0)
Requirement already satisfied: packaging&gt;=20.0 in /usr/local/lib/python3.10/dist-packages (from dask[dataframe]&gt;=2.10.0-&gt;swifter) (24.0)
Requirement already satisfied: partd&gt;=1.2.0 in /usr/local/lib/python3.10/dist-packages (from dask[dataframe]&gt;=2.10.0-&gt;swifter) (1.4.1)
Requirement already satisfied: pyyaml&gt;=5.3.1 in /usr/local/lib/python3.10/dist-packages (from dask[dataframe]&gt;=2.10.0-&gt;swifter) (6.0.1)
Requirement already satisfied: toolz&gt;=0.10.0 in /usr/local/lib/python3.10/dist-packages (from dask[dataframe]&gt;=2.10.0-&gt;swifter) (0.12.1)
Requirement already satisfied: importlib-metadata&gt;=4.13.0 in /usr/local/lib/python3.10/dist-packages (from dask[dataframe]&gt;=2.10.0-&gt;swifter) (7.1.0)
Requirement already satisfied: python-dateutil&gt;=2.8.2 in /usr/local/lib/python3.10/dist-packages (from pandas&gt;=1.0.0-&gt;swifter) (2.8.2)
Requirement already satisfied: pytz&gt;=2020.1 in /usr/local/lib/python3.10/dist-packages (from pandas&gt;=1.0.0-&gt;swifter) (2023.4)
Requirement already satisfied: tzdata&gt;=2022.1 in /usr/local/lib/python3.10/dist-packages (from pandas&gt;=1.0.0-&gt;swifter) (2024.1)
Requirement already satisfied: numpy&gt;=1.21.0 in /usr/local/lib/python3.10/dist-packages (from pandas&gt;=1.0.0-&gt;swifter) (1.25.2)
Requirement already satisfied: zipp&gt;=0.5 in /usr/local/lib/python3.10/dist-packages (from importlib-metadata&gt;=4.13.0-&gt;dask[dataframe]&gt;=2.10.0-&gt;swifter) (3.18.1)
Requirement already satisfied: locket in /usr/local/lib/python3.10/dist-packages (from partd&gt;=1.2.0-&gt;dask[dataframe]&gt;=2.10.0-&gt;swifter) (1.0.0)
Requirement already satisfied: six&gt;=1.5 in /usr/local/lib/python3.10/dist-packages (from python-dateutil&gt;=2.8.2-&gt;pandas&gt;=1.0.0-&gt;swifter) (1.16.0)
Building wheels for collected packages: swifter
  Building wheel for swifter (setup.py) ... e=swifter-1.4.0-py3-none-any.whl size=16507 sha256=979ff35aeb7643444c4e9b1d46511bce35d7b95befac8ce9726cfb88bbebfc91
  Stored in directory: /root/.cache/pip/wheels/e4/cf/51/0904952972ee2c7aa3709437065278dc534ec1b8d2ad41b443
Successfully built swifter
Installing collected packages: swifter
Successfully installed swifter-1.4.0
Collecting emoji
  Downloading emoji-2.11.0-py2.py3-none-any.whl (433 kB)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 433.8/433.8 kB 9.4 MB/s eta 0:00:00
oji
Successfully installed emoji-2.11.0
Collecting en-core-web-md==3.7.1
  Downloading https://github.com/explosion/spacy-models/releases/download/en_core_web_md-3.7.1/en_core_web_md-3.7.1-py3-none-any.whl (42.8 MB)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 42.8/42.8 MB 41.1 MB/s eta 0:00:00
ent already satisfied: spacy&lt;3.8.0,&gt;=3.7.2 in /usr/local/lib/python3.10/dist-packages (from en-core-web-md==3.7.1) (3.7.4)
Requirement already satisfied: spacy-legacy&lt;3.1.0,&gt;=3.0.11 in /usr/local/lib/python3.10/dist-packages (from spacy&lt;3.8.0,&gt;=3.7.2-&gt;en-core-web-md==3.7.1) (3.0.12)
Requirement already satisfied: spacy-loggers&lt;2.0.0,&gt;=1.0.0 in /usr/local/lib/python3.10/dist-packages (from spacy&lt;3.8.0,&gt;=3.7.2-&gt;en-core-web-md==3.7.1) (1.0.5)
Requirement already satisfied: murmurhash&lt;1.1.0,&gt;=0.28.0 in /usr/local/lib/python3.10/dist-packages (from spacy&lt;3.8.0,&gt;=3.7.2-&gt;en-core-web-md==3.7.1) (1.0.10)
Requirement already satisfied: cymem&lt;2.1.0,&gt;=2.0.2 in /usr/local/lib/python3.10/dist-packages (from spacy&lt;3.8.0,&gt;=3.7.2-&gt;en-core-web-md==3.7.1) (2.0.8)
Requirement already satisfied: preshed&lt;3.1.0,&gt;=3.0.2 in /usr/local/lib/python3.10/dist-packages (from spacy&lt;3.8.0,&gt;=3.7.2-&gt;en-core-web-md==3.7.1) (3.0.9)
Requirement already satisfied: thinc&lt;8.3.0,&gt;=8.2.2 in /usr/local/lib/python3.10/dist-packages (from spacy&lt;3.8.0,&gt;=3.7.2-&gt;en-core-web-md==3.7.1) (8.2.3)
Requirement already satisfied: wasabi&lt;1.2.0,&gt;=0.9.1 in /usr/local/lib/python3.10/dist-packages (from spacy&lt;3.8.0,&gt;=3.7.2-&gt;en-core-web-md==3.7.1) (1.1.2)
Requirement already satisfied: srsly&lt;3.0.0,&gt;=2.4.3 in /usr/local/lib/python3.10/dist-packages (from spacy&lt;3.8.0,&gt;=3.7.2-&gt;en-core-web-md==3.7.1) (2.4.8)
Requirement already satisfied: catalogue&lt;2.1.0,&gt;=2.0.6 in /usr/local/lib/python3.10/dist-packages (from spacy&lt;3.8.0,&gt;=3.7.2-&gt;en-core-web-md==3.7.1) (2.0.10)
Requirement already satisfied: weasel&lt;0.4.0,&gt;=0.1.0 in /usr/local/lib/python3.10/dist-packages (from spacy&lt;3.8.0,&gt;=3.7.2-&gt;en-core-web-md==3.7.1) (0.3.4)
Requirement already satisfied: typer&lt;0.10.0,&gt;=0.3.0 in /usr/local/lib/python3.10/dist-packages (from spacy&lt;3.8.0,&gt;=3.7.2-&gt;en-core-web-md==3.7.1) (0.9.4)
Requirement already satisfied: smart-open&lt;7.0.0,&gt;=5.2.1 in /usr/local/lib/python3.10/dist-packages (from spacy&lt;3.8.0,&gt;=3.7.2-&gt;en-core-web-md==3.7.1) (6.4.0)
Requirement already satisfied: tqdm&lt;5.0.0,&gt;=4.38.0 in /usr/local/lib/python3.10/dist-packages (from spacy&lt;3.8.0,&gt;=3.7.2-&gt;en-core-web-md==3.7.1) (4.66.2)
Requirement already satisfied: requests&lt;3.0.0,&gt;=2.13.0 in /usr/local/lib/python3.10/dist-packages (from spacy&lt;3.8.0,&gt;=3.7.2-&gt;en-core-web-md==3.7.1) (2.31.0)
Requirement already satisfied: pydantic!=1.8,!=1.8.1,&lt;3.0.0,&gt;=1.7.4 in /usr/local/lib/python3.10/dist-packages (from spacy&lt;3.8.0,&gt;=3.7.2-&gt;en-core-web-md==3.7.1) (2.6.4)
Requirement already satisfied: jinja2 in /usr/local/lib/python3.10/dist-packages (from spacy&lt;3.8.0,&gt;=3.7.2-&gt;en-core-web-md==3.7.1) (3.1.3)
Requirement already satisfied: setuptools in /usr/local/lib/python3.10/dist-packages (from spacy&lt;3.8.0,&gt;=3.7.2-&gt;en-core-web-md==3.7.1) (67.7.2)
Requirement already satisfied: packaging&gt;=20.0 in /usr/local/lib/python3.10/dist-packages (from spacy&lt;3.8.0,&gt;=3.7.2-&gt;en-core-web-md==3.7.1) (24.0)
Requirement already satisfied: langcodes&lt;4.0.0,&gt;=3.2.0 in /usr/local/lib/python3.10/dist-packages (from spacy&lt;3.8.0,&gt;=3.7.2-&gt;en-core-web-md==3.7.1) (3.3.0)
Requirement already satisfied: numpy&gt;=1.19.0 in /usr/local/lib/python3.10/dist-packages (from spacy&lt;3.8.0,&gt;=3.7.2-&gt;en-core-web-md==3.7.1) (1.25.2)
Requirement already satisfied: annotated-types&gt;=0.4.0 in /usr/local/lib/python3.10/dist-packages (from pydantic!=1.8,!=1.8.1,&lt;3.0.0,&gt;=1.7.4-&gt;spacy&lt;3.8.0,&gt;=3.7.2-&gt;en-core-web-md==3.7.1) (0.6.0)
Requirement already satisfied: pydantic-core==2.16.3 in /usr/local/lib/python3.10/dist-packages (from pydantic!=1.8,!=1.8.1,&lt;3.0.0,&gt;=1.7.4-&gt;spacy&lt;3.8.0,&gt;=3.7.2-&gt;en-core-web-md==3.7.1) (2.16.3)
Requirement already satisfied: typing-extensions&gt;=4.6.1 in /usr/local/lib/python3.10/dist-packages (from pydantic!=1.8,!=1.8.1,&lt;3.0.0,&gt;=1.7.4-&gt;spacy&lt;3.8.0,&gt;=3.7.2-&gt;en-core-web-md==3.7.1) (4.11.0)
Requirement already satisfied: charset-normalizer&lt;4,&gt;=2 in /usr/local/lib/python3.10/dist-packages (from requests&lt;3.0.0,&gt;=2.13.0-&gt;spacy&lt;3.8.0,&gt;=3.7.2-&gt;en-core-web-md==3.7.1) (3.3.2)
Requirement already satisfied: idna&lt;4,&gt;=2.5 in /usr/local/lib/python3.10/dist-packages (from requests&lt;3.0.0,&gt;=2.13.0-&gt;spacy&lt;3.8.0,&gt;=3.7.2-&gt;en-core-web-md==3.7.1) (3.6)
Requirement already satisfied: urllib3&lt;3,&gt;=1.21.1 in /usr/local/lib/python3.10/dist-packages (from requests&lt;3.0.0,&gt;=2.13.0-&gt;spacy&lt;3.8.0,&gt;=3.7.2-&gt;en-core-web-md==3.7.1) (2.0.7)
Requirement already satisfied: certifi&gt;=2017.4.17 in /usr/local/lib/python3.10/dist-packages (from requests&lt;3.0.0,&gt;=2.13.0-&gt;spacy&lt;3.8.0,&gt;=3.7.2-&gt;en-core-web-md==3.7.1) (2024.2.2)
Requirement already satisfied: blis&lt;0.8.0,&gt;=0.7.8 in /usr/local/lib/python3.10/dist-packages (from thinc&lt;8.3.0,&gt;=8.2.2-&gt;spacy&lt;3.8.0,&gt;=3.7.2-&gt;en-core-web-md==3.7.1) (0.7.11)
Requirement already satisfied: confection&lt;1.0.0,&gt;=0.0.1 in /usr/local/lib/python3.10/dist-packages (from thinc&lt;8.3.0,&gt;=8.2.2-&gt;spacy&lt;3.8.0,&gt;=3.7.2-&gt;en-core-web-md==3.7.1) (0.1.4)
Requirement already satisfied: click&lt;9.0.0,&gt;=7.1.1 in /usr/local/lib/python3.10/dist-packages (from typer&lt;0.10.0,&gt;=0.3.0-&gt;spacy&lt;3.8.0,&gt;=3.7.2-&gt;en-core-web-md==3.7.1) (8.1.7)
Requirement already satisfied: cloudpathlib&lt;0.17.0,&gt;=0.7.0 in /usr/local/lib/python3.10/dist-packages (from weasel&lt;0.4.0,&gt;=0.1.0-&gt;spacy&lt;3.8.0,&gt;=3.7.2-&gt;en-core-web-md==3.7.1) (0.16.0)
Requirement already satisfied: MarkupSafe&gt;=2.0 in /usr/local/lib/python3.10/dist-packages (from jinja2-&gt;spacy&lt;3.8.0,&gt;=3.7.2-&gt;en-core-web-md==3.7.1) (2.1.5)
Installing collected packages: en-core-web-md
Successfully installed en-core-web-md-3.7.1
✔ Download and installation successful
You can now load the package via spacy.load(&#39;en_core_web_md&#39;)
⚠ Restart to reload dependencies
If you are in a Jupyter or Colab notebook, you may need to restart Python in
order to load all the package&#39;s dependencies. You can do this by selecting the
&#39;Restart kernel&#39; or &#39;Restart runtime&#39; option.
Mounted at /content/drive
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="2" id="BiGRTiPh8a-r">
<div class="sourceCode" id="cb3"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Important imports to be added</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re,nltk,swifter</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sn</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> nltk.tokenize <span class="im">import</span> TweetTokenizer</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> nltk.corpus <span class="im">import</span> stopwords</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.feature_extraction.text <span class="im">import</span> TfidfVectorizer</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LogisticRegression</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.pipeline <span class="im">import</span> Pipeline</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> accuracy_score, confusion_matrix</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> ConfusionMatrixDisplay</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> RandomForestClassifier</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn <span class="im">import</span> svm</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn <span class="im">import</span> tree</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> nltk.stem <span class="im">import</span> WordNetLemmatizer</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>warnings.filterwarnings(<span class="st">&#39;ignore&#39;</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="3"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="OmQBP7OCzB_N" data-outputId="42092a31-912c-4221-de00-867b77ed7302">
<div class="sourceCode" id="cb4"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> google.colab <span class="im">import</span> drive</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>drive.mount(<span class="st">&#39;/content/drive&#39;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Drive already mounted at /content/drive; to attempt to forcibly remount, call drive.mount(&quot;/content/drive&quot;, force_remount=True).
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="4"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="CkFNveEA8a-2" data-outputId="64aec168-674e-47fe-a985-13c2b651cace">
<div class="sourceCode" id="cb6"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> nltk</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co">#downloading stopwords library from nltk</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>nltk.download(<span class="st">&#39;stopwords&#39;</span>)</span></code></pre></div>
<div class="output stream stderr">
<pre><code>[nltk_data] Downloading package stopwords to /root/nltk_data...
[nltk_data]   Unzipping corpora/stopwords.zip.
</code></pre>
</div>
<div class="output execute_result" data-execution_count="4">
<pre><code>True</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="5" id="fgRCBp_J8a-3">
<div class="sourceCode" id="cb9"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co">#reading csv and filling out missing values</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>rawdf <span class="op">=</span> pd.read_csv(<span class="vs">r&#39;/content/drive/MyDrive/AML 2304/train-balanced-sarcasm.csv&#39;</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Sampling to get balanced sarcastic and non-sarcastic samples</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>sarcastic_samples <span class="op">=</span> rawdf[rawdf[<span class="st">&#39;label&#39;</span>] <span class="op">==</span> <span class="dv">1</span>].sample(n<span class="op">=</span><span class="dv">10000</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>non_sarcastic_samples <span class="op">=</span> rawdf[rawdf[<span class="st">&#39;label&#39;</span>] <span class="op">==</span> <span class="dv">0</span>].sample(n<span class="op">=</span><span class="dv">10000</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Combining the samples to create a balanced dataset</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.concat([sarcastic_samples, non_sarcastic_samples])</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Shuffle the dataset</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.sample(frac<span class="op">=</span><span class="dv">1</span>, random_state<span class="op">=</span><span class="dv">42</span>).reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.fillna(<span class="st">&#39;&#39;</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="6" id="FhyUyKPW8a-4">
<div class="sourceCode" id="cb10"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co">#taking only necessary comments</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df[[<span class="st">&#39;label&#39;</span>,<span class="st">&#39;comment&#39;</span>,<span class="st">&#39;author&#39;</span>,<span class="st">&#39;score&#39;</span>,<span class="st">&#39;created_utc&#39;</span>,<span class="st">&#39;parent_comment&#39;</span>]]</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="7"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:206}"
id="H1CBKoF68a-5" data-outputId="b051ac17-90ad-4cfb-c183-29ff0a69ea43">
<div class="sourceCode" id="cb11"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>df.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="7">

  <div id="df-098e76d7-f7ac-4c60-8448-949bc7c24a81" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>label</th>
      <th>comment</th>
      <th>author</th>
      <th>score</th>
      <th>created_utc</th>
      <th>parent_comment</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>Although mill decks would love to see you play...</td>
      <td>Zerotan</td>
      <td>2</td>
      <td>2015-07-23 19:38:00</td>
      <td>Correct me if I'm mistaken, but this card turn...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>you just have one of those faces i guess</td>
      <td>Rollingten</td>
      <td>1</td>
      <td>2013-04-29 19:33:39</td>
      <td>how you think you can discern that is beyond me</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>Thanks Samsung, we really needed this in the w...</td>
      <td>ProGamerGov</td>
      <td>12</td>
      <td>2014-09-16 20:50:15</td>
      <td>Who goes there? Samsung unveils robot sentry t...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>I still think Lloyd McClendon somehow wins it ...</td>
      <td>SaddestClown</td>
      <td>7</td>
      <td>2015-08-31 00:20:45</td>
      <td>If the Rangers win the division, Banister HAS ...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>That was actually completely unintentional.</td>
      <td>virulentArachnid</td>
      <td>1</td>
      <td>2014-07-21 10:16:39</td>
      <td>I see what you did there.</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-098e76d7-f7ac-4c60-8448-949bc7c24a81')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-098e76d7-f7ac-4c60-8448-949bc7c24a81 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-098e76d7-f7ac-4c60-8448-949bc7c24a81');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-84d2c6e3-c626-43af-a85f-28ba77d6ab9b">
  <button class="colab-df-quickchart" onclick="quickchart('df-84d2c6e3-c626-43af-a85f-28ba77d6ab9b')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-84d2c6e3-c626-43af-a85f-28ba77d6ab9b button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

    </div>
  </div>

</div>
</div>
<div class="cell markdown" id="DtrypYHs8a-6">
<p><strong>Exploratory Data Analysis</strong></p>
</div>
<div class="cell code" data-execution_count="8"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:484}"
id="h_OmFldq8a-9" data-outputId="75902e76-fe2f-4425-ff24-60d85693c806">
<div class="sourceCode" id="cb12"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>sns.countplot(x<span class="op">=</span><span class="st">&quot;label&quot;</span>,data<span class="op">=</span>df,hue<span class="op">=</span><span class="st">&quot;label&quot;</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;The percentage of Non-Sarcastic comments is&quot;</span>,<span class="bu">sum</span>(df[<span class="st">&#39;label&#39;</span>]<span class="op">==</span><span class="dv">0</span>)<span class="op">/</span>(<span class="bu">len</span>(df[<span class="st">&#39;label&#39;</span>]))<span class="op">*</span><span class="dv">100</span>)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;The percentage of Sarcastic comments is&quot;</span>,<span class="bu">sum</span>(df[<span class="st">&#39;label&#39;</span>]<span class="op">==</span><span class="dv">1</span>)<span class="op">/</span>(<span class="bu">len</span>(df[<span class="st">&#39;label&#39;</span>]))<span class="op">*</span><span class="dv">100</span>)</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_bbbc7c3ec5c04b7191d21d4c180a5040/a6c27131bde7f658c0fa06629f3dfbe11619cd46.png" /></p>
</div>
<div class="output stream stdout">
<pre><code>The percentage of Non-Sarcastic comments is 50.0
The percentage of Sarcastic comments is 50.0
</code></pre>
</div>
</div>
<div class="cell markdown" id="zd2Ecs8p8a--">
<p>We can see from the countplot that this dataset is balanced</p>
</div>
<div class="cell code" data-execution_count="9" id="mQSvW7pW8a-_">
<div class="sourceCode" id="cb14"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> clean_text(comment):</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Cleaning the text by removing links, usernames, HTML tags, expansion of words, username removal, etc.</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    text <span class="op">=</span> <span class="bu">str</span>(comment)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Remove URLs</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>    text <span class="op">=</span> re.sub(<span class="vs">r&#39;http[s]?://(?:[a-zA-Z]|[0-9]|[$-_@.&amp;+]|[!*\(\), ]|(?:%[0-9a-fA-F][0-9a-fA-F]))+&#39;</span>, <span class="st">&#39; &#39;</span>, text)</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Remove HTML tags</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>    text <span class="op">=</span> re.sub(<span class="st">&quot;&lt;.*?&gt;&quot;</span>, <span class="st">&quot; &quot;</span>, text)</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Remove numbers</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>    text <span class="op">=</span> re.sub(<span class="vs">r&quot;[0-9]+&quot;</span>, <span class="st">&quot; &quot;</span>, text)</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Remove reddit handles</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>    text <span class="op">=</span> re.sub(<span class="vs">r&quot;@[A-Za-z0-9]+&quot;</span>, <span class="st">&quot; &quot;</span>, text)</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Replace contractions</span></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>    text <span class="op">=</span> re.sub(<span class="vs">r&quot;won&#39;t&quot;</span>, <span class="st">&quot;will not&quot;</span>, text)</span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>    text <span class="op">=</span> re.sub(<span class="vs">r&quot;can\&#39;t&quot;</span>, <span class="st">&quot;can not&quot;</span>, text)</span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>    text <span class="op">=</span> re.sub(<span class="vs">r&quot;n\&#39;t&quot;</span>, <span class="st">&quot; not&quot;</span>, text)</span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>    text <span class="op">=</span> re.sub(<span class="vs">r&quot;\&#39;re&quot;</span>, <span class="st">&quot; are&quot;</span>, text)</span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>    text <span class="op">=</span> re.sub(<span class="vs">r&quot;\&#39;s&quot;</span>, <span class="st">&quot; is&quot;</span>, text)</span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>    text <span class="op">=</span> re.sub(<span class="vs">r&quot;\&#39;d&quot;</span>, <span class="st">&quot; would&quot;</span>, text)</span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>    text <span class="op">=</span> re.sub(<span class="vs">r&quot;\&#39;ll&quot;</span>, <span class="st">&quot; will&quot;</span>, text)</span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>    text <span class="op">=</span> re.sub(<span class="vs">r&quot;\&#39;t&quot;</span>, <span class="st">&quot; not&quot;</span>, text)</span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>    text <span class="op">=</span> re.sub(<span class="vs">r&quot;\&#39;ve&quot;</span>, <span class="st">&quot; have&quot;</span>, text)</span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>    text <span class="op">=</span> re.sub(<span class="vs">r&quot;\&#39;m&quot;</span>, <span class="st">&quot; am&quot;</span>, text)</span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Remove special characters</span></span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a>    text <span class="op">=</span> text.replace(<span class="st">&#39;</span><span class="ch">\\</span><span class="st">r&#39;</span>, <span class="st">&#39; &#39;</span>)</span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a>    text <span class="op">=</span> text.replace(<span class="st">&#39;</span><span class="ch">\\</span><span class="st">&quot;&#39;</span>, <span class="st">&#39; &#39;</span>)</span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a>    text <span class="op">=</span> text.replace(<span class="st">&#39;</span><span class="ch">\\</span><span class="st">n&#39;</span>, <span class="st">&#39; &#39;</span>)</span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> text</span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply text cleaning on comment and parent comment</span></span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&quot;cleanV1_comment&quot;</span>] <span class="op">=</span> df[<span class="st">&quot;comment&quot;</span>].<span class="bu">apply</span>(clean_text)</span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&quot;cleanV1_parent_comment&quot;</span>] <span class="op">=</span> df[<span class="st">&quot;parent_comment&quot;</span>].<span class="bu">apply</span>(clean_text)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="10"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:293}"
id="mUNkkkFL8a_B" data-outputId="fea523cc-6f86-4c97-b7a1-d8467f7a7bcf">
<div class="sourceCode" id="cb15"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>df.head(<span class="dv">5</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="10">

  <div id="df-cb14271c-de18-46df-9ede-0af92e262c13" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>label</th>
      <th>comment</th>
      <th>author</th>
      <th>score</th>
      <th>created_utc</th>
      <th>parent_comment</th>
      <th>cleanV1_comment</th>
      <th>cleanV1_parent_comment</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>Although mill decks would love to see you play...</td>
      <td>Zerotan</td>
      <td>2</td>
      <td>2015-07-23 19:38:00</td>
      <td>Correct me if I'm mistaken, but this card turn...</td>
      <td>Although mill decks would love to see you play...</td>
      <td>Correct me if I am mistaken, but this card tur...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>you just have one of those faces i guess</td>
      <td>Rollingten</td>
      <td>1</td>
      <td>2013-04-29 19:33:39</td>
      <td>how you think you can discern that is beyond me</td>
      <td>you just have one of those faces i guess</td>
      <td>how you think you can discern that is beyond me</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>Thanks Samsung, we really needed this in the w...</td>
      <td>ProGamerGov</td>
      <td>12</td>
      <td>2014-09-16 20:50:15</td>
      <td>Who goes there? Samsung unveils robot sentry t...</td>
      <td>Thanks Samsung, we really needed this in the w...</td>
      <td>Who goes there? Samsung unveils robot sentry t...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>I still think Lloyd McClendon somehow wins it ...</td>
      <td>SaddestClown</td>
      <td>7</td>
      <td>2015-08-31 00:20:45</td>
      <td>If the Rangers win the division, Banister HAS ...</td>
      <td>I still think Lloyd McClendon somehow wins it ...</td>
      <td>If the Rangers win the division, Banister HAS ...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>That was actually completely unintentional.</td>
      <td>virulentArachnid</td>
      <td>1</td>
      <td>2014-07-21 10:16:39</td>
      <td>I see what you did there.</td>
      <td>That was actually completely unintentional.</td>
      <td>I see what you did there.</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-cb14271c-de18-46df-9ede-0af92e262c13')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-cb14271c-de18-46df-9ede-0af92e262c13 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-cb14271c-de18-46df-9ede-0af92e262c13');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-9fd72bb5-92dd-4503-b374-b17710eb34cb">
  <button class="colab-df-quickchart" onclick="quickchart('df-9fd72bb5-92dd-4503-b374-b17710eb34cb')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-9fd72bb5-92dd-4503-b374-b17710eb34cb button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="11" id="HkJRaUir8a_C">
<div class="sourceCode" id="cb16"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co">#function to lowercase all except all caps word</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> lowercase_except_caps(sentence):</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#print(sentence)</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  words <span class="op">=</span> sentence.split()</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  modified_words <span class="op">=</span> []</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> word <span class="kw">in</span> words:</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> word.isupper():</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>      modified_words.append(word)</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>      modified_words.append(word.lower())</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="st">&quot; &quot;</span>.join(modified_words)</span></code></pre></div>
</div>
<div class="cell markdown" id="jvdKAWOm8a_D">
<p><strong>Abbreviation Replacement</strong></p>
</div>
<div class="cell code" data-execution_count="12"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:423}"
id="xkOjC4qR8a_D" data-outputId="2df37335-f81e-4ecb-e428-b912ca9f711c">
<div class="sourceCode" id="cb17"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co">#csv to dataframe</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>abbrslang<span class="op">=</span>pd.read_csv(<span class="vs">r&#39;/content/drive/MyDrive/AML 2304/Abbr.csv&#39;</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>abbrslang</span></code></pre></div>
<div class="output execute_result" data-execution_count="12">

  <div id="df-b52d7fa2-de3a-412b-884e-659781740c70" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Abbr</th>
      <th>Meaning</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>@TEOTD</td>
      <td>At the end of the day</td>
    </tr>
    <tr>
      <th>1</th>
      <td>143</td>
      <td>I love you</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2G2BT</td>
      <td>Too good to be true</td>
    </tr>
    <tr>
      <th>3</th>
      <td>404</td>
      <td>I don't know</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4EAE</td>
      <td>Forever and ever</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>426</th>
      <td>BS</td>
      <td>Bullshit</td>
    </tr>
    <tr>
      <th>427</th>
      <td>NYC</td>
      <td>New York City</td>
    </tr>
    <tr>
      <th>428</th>
      <td>VR</td>
      <td>Virtual Reality</td>
    </tr>
    <tr>
      <th>429</th>
      <td>GTA</td>
      <td>Grand Theft Auto</td>
    </tr>
    <tr>
      <th>430</th>
      <td>RIP</td>
      <td>Rest In Peace</td>
    </tr>
  </tbody>
</table>
<p>431 rows × 2 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-b52d7fa2-de3a-412b-884e-659781740c70')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-b52d7fa2-de3a-412b-884e-659781740c70 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-b52d7fa2-de3a-412b-884e-659781740c70');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-19a53669-1946-4cef-99aa-91bca93c13be">
  <button class="colab-df-quickchart" onclick="quickchart('df-19a53669-1946-4cef-99aa-91bca93c13be')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-19a53669-1946-4cef-99aa-91bca93c13be button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

  <div id="id_0505db2b-f58c-4922-9e72-b333f8d26525">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('abbrslang')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_0505db2b-f58c-4922-9e72-b333f8d26525 button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('abbrslang');
      }
      })();
    </script>
  </div>

    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="13" id="3DJmhq6_8a_E">
<div class="sourceCode" id="cb18"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>abbrslangDict<span class="op">=</span>abbrslang.to_dict(orient<span class="op">=</span><span class="st">&#39;records&#39;</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="14"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:521}"
id="IQO_eopL8a_E" data-outputId="979fcc5e-cbdb-4820-cf7b-f85330291952">
<div class="sourceCode" id="cb19"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> expand_abbr(text, abbr_dict):</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Regex for 2 or more capital letters (excluding common abbreviations)</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>    pattern1 <span class="op">=</span> <span class="vs">r&quot;\b([A-Z]{2,}(?!\.[A-Z]{2,}))\b&quot;</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Regex for common abbreviations (Mr., Mrs., etc.)</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>    pattern2 <span class="op">=</span> <span class="vs">r&quot;\b([A-Z]{2,}\.?)\b&quot;</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Combine both patterns</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>    combined_pattern <span class="op">=</span> re.<span class="bu">compile</span>(<span class="st">&quot;|&quot;</span>.join([pattern1, pattern2]))</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>    detected_abbr <span class="op">=</span> []  <span class="co"># List to store detected abbreviations</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> expand_match(match):</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>        matched_abbr <span class="op">=</span> match.group()</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>        detected_abbr.append(matched_abbr)  <span class="co"># Store detected abbreviation</span></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> entry <span class="kw">in</span> abbr_dict:</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> matched_abbr.upper() <span class="op">==</span> entry[<span class="st">&#39;Abbr&#39;</span>]:</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> entry[<span class="st">&#39;Meaning&#39;</span>]</span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> matched_abbr  <span class="co"># Use default if not found</span></span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(text, <span class="bu">str</span>):</span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>        text <span class="op">=</span> <span class="bu">str</span>(text)  <span class="co"># Convert non-string inputs to strings</span></span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>    expanded_text <span class="op">=</span> combined_pattern.sub(expand_match, text)</span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> expanded_text, detected_abbr</span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;abbr_comment&#39;</span>], df[<span class="st">&#39;detected_abbr&#39;</span>] <span class="op">=</span> <span class="bu">zip</span>(<span class="op">*</span>df[<span class="st">&#39;cleanV1_comment&#39;</span>].<span class="bu">apply</span>(expand_abbr, args<span class="op">=</span>(abbrslangDict,)))</span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;abbr_parent_comment&#39;</span>], df[<span class="st">&#39;detected_parent_abbr&#39;</span>] <span class="op">=</span> <span class="bu">zip</span>(<span class="op">*</span>df[<span class="st">&#39;cleanV1_parent_comment&#39;</span>].<span class="bu">apply</span>(expand_abbr, args<span class="op">=</span>(abbrslangDict,)))</span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a>df.head(<span class="dv">5</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="14">

  <div id="df-4e04139d-30de-46d8-9eea-c4defaca58f0" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>label</th>
      <th>comment</th>
      <th>author</th>
      <th>score</th>
      <th>created_utc</th>
      <th>parent_comment</th>
      <th>cleanV1_comment</th>
      <th>cleanV1_parent_comment</th>
      <th>abbr_comment</th>
      <th>detected_abbr</th>
      <th>abbr_parent_comment</th>
      <th>detected_parent_abbr</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>Although mill decks would love to see you play...</td>
      <td>Zerotan</td>
      <td>2</td>
      <td>2015-07-23 19:38:00</td>
      <td>Correct me if I'm mistaken, but this card turn...</td>
      <td>Although mill decks would love to see you play...</td>
      <td>Correct me if I am mistaken, but this card tur...</td>
      <td>Although mill decks would love to see you play...</td>
      <td>[]</td>
      <td>Correct me if I am mistaken, but this card tur...</td>
      <td>[]</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>you just have one of those faces i guess</td>
      <td>Rollingten</td>
      <td>1</td>
      <td>2013-04-29 19:33:39</td>
      <td>how you think you can discern that is beyond me</td>
      <td>you just have one of those faces i guess</td>
      <td>how you think you can discern that is beyond me</td>
      <td>you just have one of those faces i guess</td>
      <td>[]</td>
      <td>how you think you can discern that is beyond me</td>
      <td>[]</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>Thanks Samsung, we really needed this in the w...</td>
      <td>ProGamerGov</td>
      <td>12</td>
      <td>2014-09-16 20:50:15</td>
      <td>Who goes there? Samsung unveils robot sentry t...</td>
      <td>Thanks Samsung, we really needed this in the w...</td>
      <td>Who goes there? Samsung unveils robot sentry t...</td>
      <td>Thanks Samsung, we really needed this in the w...</td>
      <td>[]</td>
      <td>Who goes there? Samsung unveils robot sentry t...</td>
      <td>[]</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>I still think Lloyd McClendon somehow wins it ...</td>
      <td>SaddestClown</td>
      <td>7</td>
      <td>2015-08-31 00:20:45</td>
      <td>If the Rangers win the division, Banister HAS ...</td>
      <td>I still think Lloyd McClendon somehow wins it ...</td>
      <td>If the Rangers win the division, Banister HAS ...</td>
      <td>I still think Lloyd McClendon somehow wins it ...</td>
      <td>[]</td>
      <td>If the Rangers win the division, Banister HAS ...</td>
      <td>[HAS, AL]</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>That was actually completely unintentional.</td>
      <td>virulentArachnid</td>
      <td>1</td>
      <td>2014-07-21 10:16:39</td>
      <td>I see what you did there.</td>
      <td>That was actually completely unintentional.</td>
      <td>I see what you did there.</td>
      <td>That was actually completely unintentional.</td>
      <td>[]</td>
      <td>I see what you did there.</td>
      <td>[]</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-4e04139d-30de-46d8-9eea-c4defaca58f0')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-4e04139d-30de-46d8-9eea-c4defaca58f0 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-4e04139d-30de-46d8-9eea-c4defaca58f0');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-7a454215-3824-4e22-910c-698f9d58281f">
  <button class="colab-df-quickchart" onclick="quickchart('df-7a454215-3824-4e22-910c-698f9d58281f')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-7a454215-3824-4e22-910c-698f9d58281f button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="15" id="Rfbei0r28a_F">
<div class="sourceCode" id="cb20"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> Counter</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Flatten the list of lists from detected_abbr and detected_parent_abbr columns into separate lists</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>detected_abbr_flat <span class="op">=</span> [word <span class="cf">for</span> sublist <span class="kw">in</span> df[<span class="st">&#39;detected_abbr&#39;</span>] <span class="cf">if</span> sublist <span class="cf">for</span> word <span class="kw">in</span> sublist]</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>detected_parent_abbr_flat <span class="op">=</span> [word <span class="cf">for</span> sublist <span class="kw">in</span> df[<span class="st">&#39;detected_parent_abbr&#39;</span>] <span class="cf">if</span> sublist <span class="cf">for</span> word <span class="kw">in</span> sublist]</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Count the frequency of each word in detected_abbr and detected_parent_abbr</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>abbr_freq <span class="op">=</span> Counter(detected_abbr_flat)</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>parent_abbr_freq <span class="op">=</span> Counter(detected_parent_abbr_flat)</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the Counter objects to DataFrames</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>abbr_freq_df <span class="op">=</span> pd.DataFrame.from_dict(abbr_freq, orient<span class="op">=</span><span class="st">&#39;index&#39;</span>, columns<span class="op">=</span>[<span class="st">&#39;abbr_comment_freq&#39;</span>])</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>parent_abbr_freq_df <span class="op">=</span> pd.DataFrame.from_dict(parent_abbr_freq, orient<span class="op">=</span><span class="st">&#39;index&#39;</span>, columns<span class="op">=</span>[<span class="st">&#39;parent_abbr_comment_freq&#39;</span>])</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Reset the index to make the &#39;word&#39; a column</span></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>abbr_freq_df.reset_index(inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>parent_abbr_freq_df.reset_index(inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Rename the &#39;index&#39; column to &#39;comment_abbr&#39; and &#39;parent_comment_abbr&#39;</span></span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>abbr_freq_df.rename(columns<span class="op">=</span>{<span class="st">&#39;index&#39;</span>: <span class="st">&#39;comment_abbr&#39;</span>}, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>parent_abbr_freq_df.rename(columns<span class="op">=</span>{<span class="st">&#39;index&#39;</span>: <span class="st">&#39;parent_comment_abbr&#39;</span>}, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Save the DataFrames to a CSV file</span></span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>output_df <span class="op">=</span> pd.concat([abbr_freq_df, parent_abbr_freq_df], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a>output_df.to_csv(<span class="st">&#39;/content/drive/MyDrive/AML 2304/Abbr_word_frequency.csv&#39;</span>, index<span class="op">=</span><span class="va">False</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="16" id="IR1boJfl8a_F">
<div class="sourceCode" id="cb21"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>df.to_csv(<span class="st">&#39;/content/drive/MyDrive/AML 2304/Abbr_log.csv&#39;</span>, index<span class="op">=</span><span class="va">False</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="17"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:521}"
id="g0UI7BWA8a_G" data-outputId="07aa89ac-7eeb-49ad-bbfd-cada1baa64ad">
<div class="sourceCode" id="cb22"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>df.head(<span class="dv">5</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="17">

  <div id="df-4c072b93-cd36-4b8a-b129-49b35a006791" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>label</th>
      <th>comment</th>
      <th>author</th>
      <th>score</th>
      <th>created_utc</th>
      <th>parent_comment</th>
      <th>cleanV1_comment</th>
      <th>cleanV1_parent_comment</th>
      <th>abbr_comment</th>
      <th>detected_abbr</th>
      <th>abbr_parent_comment</th>
      <th>detected_parent_abbr</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>Although mill decks would love to see you play...</td>
      <td>Zerotan</td>
      <td>2</td>
      <td>2015-07-23 19:38:00</td>
      <td>Correct me if I'm mistaken, but this card turn...</td>
      <td>Although mill decks would love to see you play...</td>
      <td>Correct me if I am mistaken, but this card tur...</td>
      <td>Although mill decks would love to see you play...</td>
      <td>[]</td>
      <td>Correct me if I am mistaken, but this card tur...</td>
      <td>[]</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>you just have one of those faces i guess</td>
      <td>Rollingten</td>
      <td>1</td>
      <td>2013-04-29 19:33:39</td>
      <td>how you think you can discern that is beyond me</td>
      <td>you just have one of those faces i guess</td>
      <td>how you think you can discern that is beyond me</td>
      <td>you just have one of those faces i guess</td>
      <td>[]</td>
      <td>how you think you can discern that is beyond me</td>
      <td>[]</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>Thanks Samsung, we really needed this in the w...</td>
      <td>ProGamerGov</td>
      <td>12</td>
      <td>2014-09-16 20:50:15</td>
      <td>Who goes there? Samsung unveils robot sentry t...</td>
      <td>Thanks Samsung, we really needed this in the w...</td>
      <td>Who goes there? Samsung unveils robot sentry t...</td>
      <td>Thanks Samsung, we really needed this in the w...</td>
      <td>[]</td>
      <td>Who goes there? Samsung unveils robot sentry t...</td>
      <td>[]</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>I still think Lloyd McClendon somehow wins it ...</td>
      <td>SaddestClown</td>
      <td>7</td>
      <td>2015-08-31 00:20:45</td>
      <td>If the Rangers win the division, Banister HAS ...</td>
      <td>I still think Lloyd McClendon somehow wins it ...</td>
      <td>If the Rangers win the division, Banister HAS ...</td>
      <td>I still think Lloyd McClendon somehow wins it ...</td>
      <td>[]</td>
      <td>If the Rangers win the division, Banister HAS ...</td>
      <td>[HAS, AL]</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>That was actually completely unintentional.</td>
      <td>virulentArachnid</td>
      <td>1</td>
      <td>2014-07-21 10:16:39</td>
      <td>I see what you did there.</td>
      <td>That was actually completely unintentional.</td>
      <td>I see what you did there.</td>
      <td>That was actually completely unintentional.</td>
      <td>[]</td>
      <td>I see what you did there.</td>
      <td>[]</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-4c072b93-cd36-4b8a-b129-49b35a006791')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-4c072b93-cd36-4b8a-b129-49b35a006791 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-4c072b93-cd36-4b8a-b129-49b35a006791');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-877aba88-b9ed-4b1a-b131-256e3422fb23">
  <button class="colab-df-quickchart" onclick="quickchart('df-877aba88-b9ed-4b1a-b131-256e3422fb23')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-877aba88-b9ed-4b1a-b131-256e3422fb23 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

    </div>
  </div>

</div>
</div>
<section id="slang-handling" class="cell markdown" id="FjDAakjSPG5j">
<h1>Slang Handling</h1>
</section>
<div class="cell code" data-execution_count="18"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:938}"
id="v7L-uh8JPGEf" data-outputId="96bc692d-d1e2-4b1b-b480-c9a1765491ef">
<div class="sourceCode" id="cb23"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the CSV file into a DataFrame</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>slangs_df <span class="op">=</span> pd.read_csv(<span class="st">&#39;/content/drive/MyDrive/AML 2304/Slangs.csv&#39;</span>)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a dictionary from the DataFrame</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>slangs_dict <span class="op">=</span> <span class="bu">dict</span>(<span class="bu">zip</span>(slangs_df[<span class="st">&#39;slangs&#39;</span>], slangs_df[<span class="st">&#39;meanings&#39;</span>]))</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to replace slangs in a sentence and store detected slangs</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> replace_slangs(sentence):</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>    words <span class="op">=</span> sentence.split()</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>    replaced_words <span class="op">=</span> []</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>    detected_slangs <span class="op">=</span> []</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> word <span class="kw">in</span> words:</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>        meaning <span class="op">=</span> slangs_dict.get(word, word)</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> meaning <span class="op">!=</span> word:</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>            detected_slangs.append((word, meaning))</span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>        replaced_words.append(meaning)</span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">&#39; &#39;</span>.join(replaced_words), detected_slangs</span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;slang_comment&#39;</span>], df[<span class="st">&#39;detected_slangs&#39;</span>] <span class="op">=</span> <span class="bu">zip</span>(<span class="op">*</span>df[<span class="st">&#39;abbr_comment&#39;</span>].<span class="bu">apply</span>(replace_slangs))</span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;slang_parent_comment&#39;</span>], df[<span class="st">&#39;detected_parent_slangs&#39;</span>] <span class="op">=</span> <span class="bu">zip</span>(<span class="op">*</span>df[<span class="st">&#39;abbr_parent_comment&#39;</span>].<span class="bu">apply</span>(replace_slangs))</span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the updated DataFrame</span></span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a>df.tail(<span class="dv">10</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="18">

  <div id="df-914dce0b-de1b-4c1d-b273-4f8e300e5b9e" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>label</th>
      <th>comment</th>
      <th>author</th>
      <th>score</th>
      <th>created_utc</th>
      <th>parent_comment</th>
      <th>cleanV1_comment</th>
      <th>cleanV1_parent_comment</th>
      <th>abbr_comment</th>
      <th>detected_abbr</th>
      <th>abbr_parent_comment</th>
      <th>detected_parent_abbr</th>
      <th>slang_comment</th>
      <th>detected_slangs</th>
      <th>slang_parent_comment</th>
      <th>detected_parent_slangs</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>19990</th>
      <td>0</td>
      <td>I love fisting creepers.</td>
      <td>Omnisophic</td>
      <td>2</td>
      <td>2016-01-05 19:07:26</td>
      <td>That is the puss way. A non puss way would jus...</td>
      <td>I love fisting creepers.</td>
      <td>That is the puss way. A non puss way would jus...</td>
      <td>I love fisting creepers.</td>
      <td>[]</td>
      <td>That is the puss way. A non puss way would jus...</td>
      <td>[]</td>
      <td>I love fisting creepers.</td>
      <td>[]</td>
      <td>That is the puss way. A non puss way would jus...</td>
      <td>[]</td>
    </tr>
    <tr>
      <th>19991</th>
      <td>0</td>
      <td>If that's the case I'm the Vladimir Putin of FB.</td>
      <td>Caligullama</td>
      <td>1</td>
      <td>2015-07-05 19:38:36</td>
      <td>Is this just the international diplomacy equiv...</td>
      <td>If that is the case I am the Vladimir Putin of...</td>
      <td>Is this just the international diplomacy equiv...</td>
      <td>If that is the case I am the Vladimir Putin of...</td>
      <td>[FB]</td>
      <td>Is this just the international diplomacy equiv...</td>
      <td>[]</td>
      <td>If that is the case I am the Vladimir Putin of...</td>
      <td>[]</td>
      <td>Is this just the international diplomacy equiv...</td>
      <td>[]</td>
    </tr>
    <tr>
      <th>19992</th>
      <td>1</td>
      <td>My gardener?</td>
      <td>Emperor_Twinkie</td>
      <td>5</td>
      <td>2015-07-13 17:18:03</td>
      <td>We need to elect a low-income hispanic female ...</td>
      <td>My gardener?</td>
      <td>We need to elect a low-income hispanic female ...</td>
      <td>My gardener?</td>
      <td>[]</td>
      <td>We need to elect a low-income hispanic female ...</td>
      <td>[]</td>
      <td>My gardener?</td>
      <td>[]</td>
      <td>We need to elect a low-income hispanic female ...</td>
      <td>[]</td>
    </tr>
    <tr>
      <th>19993</th>
      <td>0</td>
      <td>Don't see a path to a Bernie victory based on ...</td>
      <td>comradebillyboy</td>
      <td>5</td>
      <td>2016-03-27 19:22:03</td>
      <td>Bernie Sanders path to victory ?</td>
      <td>Do not see a path to a Bernie victory based on...</td>
      <td>Bernie Sanders path to victory ?</td>
      <td>Do not see a path to a Bernie victory based on...</td>
      <td>[]</td>
      <td>Bernie Sanders path to victory ?</td>
      <td>[]</td>
      <td>Do not see a path to a Bernie victory based on...</td>
      <td>[]</td>
      <td>Bernie Sanders path to victory ?</td>
      <td>[]</td>
    </tr>
    <tr>
      <th>19994</th>
      <td>1</td>
      <td>Dave?</td>
      <td>velinxs</td>
      <td>1</td>
      <td>2016-08-21 17:42:02</td>
      <td>Can confirm, scared to share my opinions aroun...</td>
      <td>Dave?</td>
      <td>Can confirm, scared to share my opinions aroun...</td>
      <td>Dave?</td>
      <td>[]</td>
      <td>Can confirm, scared to share my opinions aroun...</td>
      <td>[]</td>
      <td>Dave?</td>
      <td>[]</td>
      <td>Can confirm, scared to share my opinions aroun...</td>
      <td>[]</td>
    </tr>
    <tr>
      <th>19995</th>
      <td>0</td>
      <td>Venting all the way *vent vent vent*</td>
      <td>iElectricLewis</td>
      <td>15</td>
      <td>2016-11-15 08:03:28</td>
      <td>over the hills we vent</td>
      <td>Venting all the way *vent vent vent*</td>
      <td>over the hills we vent</td>
      <td>Venting all the way *vent vent vent*</td>
      <td>[]</td>
      <td>over the hills we vent</td>
      <td>[]</td>
      <td>Venting all the way *vent vent vent*</td>
      <td>[]</td>
      <td>over the hills we vent</td>
      <td>[]</td>
    </tr>
    <tr>
      <th>19996</th>
      <td>0</td>
      <td>LOL, wow.</td>
      <td>TooPoetic</td>
      <td>2</td>
      <td>2016-12-22 23:15:42</td>
      <td>That's quite literally what they believe. 76 (...</td>
      <td>LOL, wow.</td>
      <td>That is quite literally what they believe.   (...</td>
      <td>Laughing out loud, wow.</td>
      <td>[LOL]</td>
      <td>That is quite literally what they believe.   (...</td>
      <td>[]</td>
      <td>Laughing out loud, wow.</td>
      <td>[]</td>
      <td>That is quite literally what they believe. (or...</td>
      <td>[]</td>
    </tr>
    <tr>
      <th>19997</th>
      <td>1</td>
      <td>Wow, he's so smart.</td>
      <td>llortoftrolls</td>
      <td>4</td>
      <td>2016-05-10 22:17:36</td>
      <td>Roger Ver: Paypal 2.0 Is An Acceptable Risk Fo...</td>
      <td>Wow, he is so smart.</td>
      <td>Roger Ver: Paypal  .  Is An Acceptable Risk Fo...</td>
      <td>Wow, he is so smart.</td>
      <td>[]</td>
      <td>Roger Ver: Paypal  .  Is An Acceptable Risk Fo...</td>
      <td>[]</td>
      <td>Wow, he is so smart.</td>
      <td>[]</td>
      <td>Roger Ver: Paypal . Is An Acceptable Risk For ...</td>
      <td>[]</td>
    </tr>
    <tr>
      <th>19998</th>
      <td>1</td>
      <td>Yeah because it's really difficult to get guns...</td>
      <td>AK47Uprising</td>
      <td>14</td>
      <td>2014-07-20 14:04:45</td>
      <td>BREAKING: California Gov. Jerry Brown Signs Ne...</td>
      <td>Yeah because it is really difficult to get gun...</td>
      <td>BREAKING: California Gov. Jerry Brown Signs Ne...</td>
      <td>Yeah because it is really difficult to get gun...</td>
      <td>[]</td>
      <td>BREAKING: California Gov. Jerry Brown Signs Ne...</td>
      <td>[BREAKING, AB]</td>
      <td>Yeah because it is really difficult to get gun...</td>
      <td>[]</td>
      <td>BREAKING: California Gov. Jerry Brown Signs Ne...</td>
      <td>[]</td>
    </tr>
    <tr>
      <th>19999</th>
      <td>0</td>
      <td>Cat.</td>
      <td>MistaJay2</td>
      <td>8</td>
      <td>2015-05-30 20:05:36</td>
      <td>Cat.</td>
      <td>Cat.</td>
      <td>Cat.</td>
      <td>Cat.</td>
      <td>[]</td>
      <td>Cat.</td>
      <td>[]</td>
      <td>Cat.</td>
      <td>[]</td>
      <td>Cat.</td>
      <td>[]</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-914dce0b-de1b-4c1d-b273-4f8e300e5b9e')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-914dce0b-de1b-4c1d-b273-4f8e300e5b9e button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-914dce0b-de1b-4c1d-b273-4f8e300e5b9e');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-9dbd80a2-a855-4a55-917f-b36512500bde">
  <button class="colab-df-quickchart" onclick="quickchart('df-9dbd80a2-a855-4a55-917f-b36512500bde')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-9dbd80a2-a855-4a55-917f-b36512500bde button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="19" id="mOn6e5KcRzOD">
<div class="sourceCode" id="cb24"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> Counter</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Flatten the list of lists from detected_slangs and detected_parent_slangs columns into separate lists</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>detected_slang_flat <span class="op">=</span> [word <span class="cf">for</span> sublist <span class="kw">in</span> df[<span class="st">&#39;detected_slangs&#39;</span>] <span class="cf">if</span> sublist <span class="cf">for</span> word <span class="kw">in</span> sublist]</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>detected_parent_slang_flat <span class="op">=</span> [word <span class="cf">for</span> sublist <span class="kw">in</span> df[<span class="st">&#39;detected_parent_slangs&#39;</span>] <span class="cf">if</span> sublist <span class="cf">for</span> word <span class="kw">in</span> sublist]</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Count the frequency of each word in detected_slangs and detected_parent_slangs</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>slang_freq <span class="op">=</span> Counter(detected_slang_flat)</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>parent_slang_freq <span class="op">=</span> Counter(detected_parent_slang_flat)</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the Counter objects to DataFrames</span></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>slang_freq_df <span class="op">=</span> pd.DataFrame.from_dict(slang_freq, orient<span class="op">=</span><span class="st">&#39;index&#39;</span>, columns<span class="op">=</span>[<span class="st">&#39;slang_comment_freq&#39;</span>])</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>parent_slang_freq_df <span class="op">=</span> pd.DataFrame.from_dict(parent_slang_freq, orient<span class="op">=</span><span class="st">&#39;index&#39;</span>, columns<span class="op">=</span>[<span class="st">&#39;parent_slang_comment_freq&#39;</span>])</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Reset the index to make the &#39;word&#39; a column</span></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>slang_freq_df.reset_index(inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>parent_slang_freq_df.reset_index(inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Rename the &#39;index&#39; column to &#39;comment_slangs&#39; and &#39;parent_comment_slangs&#39;</span></span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>slang_freq_df.rename(columns<span class="op">=</span>{<span class="st">&#39;index&#39;</span>: <span class="st">&#39;comment_slangs&#39;</span>}, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>parent_slang_freq_df.rename(columns<span class="op">=</span>{<span class="st">&#39;index&#39;</span>: <span class="st">&#39;parent_comment_slangs&#39;</span>}, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Save the DataFrames to a CSV file</span></span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>output_df <span class="op">=</span> pd.concat([slang_freq_df, parent_slang_freq_df], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a>output_df.to_csv(<span class="st">&#39;/content/drive/MyDrive/AML 2304/Slang_word_frequency.csv&#39;</span>, index<span class="op">=</span><span class="va">False</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="20" id="pMu5hOa2RzAe">
<div class="sourceCode" id="cb25"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>df.to_csv(<span class="st">&#39;/content/drive/MyDrive/AML 2304/Slang_log.csv&#39;</span>, index<span class="op">=</span><span class="va">False</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="21"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:521}"
id="vA0rWIHHSB2h" data-outputId="e3581743-cece-455a-9105-072e8be46ce0">
<div class="sourceCode" id="cb26"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>df.head(<span class="dv">5</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="21">

  <div id="df-1529e09f-57fa-4161-af54-2e2642da4e12" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>label</th>
      <th>comment</th>
      <th>author</th>
      <th>score</th>
      <th>created_utc</th>
      <th>parent_comment</th>
      <th>cleanV1_comment</th>
      <th>cleanV1_parent_comment</th>
      <th>abbr_comment</th>
      <th>detected_abbr</th>
      <th>abbr_parent_comment</th>
      <th>detected_parent_abbr</th>
      <th>slang_comment</th>
      <th>detected_slangs</th>
      <th>slang_parent_comment</th>
      <th>detected_parent_slangs</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>Although mill decks would love to see you play...</td>
      <td>Zerotan</td>
      <td>2</td>
      <td>2015-07-23 19:38:00</td>
      <td>Correct me if I'm mistaken, but this card turn...</td>
      <td>Although mill decks would love to see you play...</td>
      <td>Correct me if I am mistaken, but this card tur...</td>
      <td>Although mill decks would love to see you play...</td>
      <td>[]</td>
      <td>Correct me if I am mistaken, but this card tur...</td>
      <td>[]</td>
      <td>Although mill decks would love to see you play...</td>
      <td>[]</td>
      <td>Correct me if I am mistaken, but this card tur...</td>
      <td>[]</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>you just have one of those faces i guess</td>
      <td>Rollingten</td>
      <td>1</td>
      <td>2013-04-29 19:33:39</td>
      <td>how you think you can discern that is beyond me</td>
      <td>you just have one of those faces i guess</td>
      <td>how you think you can discern that is beyond me</td>
      <td>you just have one of those faces i guess</td>
      <td>[]</td>
      <td>how you think you can discern that is beyond me</td>
      <td>[]</td>
      <td>you just have one of those faces i guess</td>
      <td>[]</td>
      <td>how you think you can discern that is beyond me</td>
      <td>[]</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>Thanks Samsung, we really needed this in the w...</td>
      <td>ProGamerGov</td>
      <td>12</td>
      <td>2014-09-16 20:50:15</td>
      <td>Who goes there? Samsung unveils robot sentry t...</td>
      <td>Thanks Samsung, we really needed this in the w...</td>
      <td>Who goes there? Samsung unveils robot sentry t...</td>
      <td>Thanks Samsung, we really needed this in the w...</td>
      <td>[]</td>
      <td>Who goes there? Samsung unveils robot sentry t...</td>
      <td>[]</td>
      <td>Thanks Samsung, we really needed this in the w...</td>
      <td>[]</td>
      <td>Who goes there? Samsung unveils robot sentry t...</td>
      <td>[]</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>I still think Lloyd McClendon somehow wins it ...</td>
      <td>SaddestClown</td>
      <td>7</td>
      <td>2015-08-31 00:20:45</td>
      <td>If the Rangers win the division, Banister HAS ...</td>
      <td>I still think Lloyd McClendon somehow wins it ...</td>
      <td>If the Rangers win the division, Banister HAS ...</td>
      <td>I still think Lloyd McClendon somehow wins it ...</td>
      <td>[]</td>
      <td>If the Rangers win the division, Banister HAS ...</td>
      <td>[HAS, AL]</td>
      <td>I still think Lloyd McClendon somehow wins it ...</td>
      <td>[]</td>
      <td>If the Rangers win the division, Banister HAS ...</td>
      <td>[]</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>That was actually completely unintentional.</td>
      <td>virulentArachnid</td>
      <td>1</td>
      <td>2014-07-21 10:16:39</td>
      <td>I see what you did there.</td>
      <td>That was actually completely unintentional.</td>
      <td>I see what you did there.</td>
      <td>That was actually completely unintentional.</td>
      <td>[]</td>
      <td>I see what you did there.</td>
      <td>[]</td>
      <td>That was actually completely unintentional.</td>
      <td>[]</td>
      <td>I see what you did there.</td>
      <td>[]</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-1529e09f-57fa-4161-af54-2e2642da4e12')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-1529e09f-57fa-4161-af54-2e2642da4e12 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-1529e09f-57fa-4161-af54-2e2642da4e12');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-274284d8-f353-4056-add2-dd8f1fee9989">
  <button class="colab-df-quickchart" onclick="quickchart('df-274284d8-f353-4056-add2-dd8f1fee9989')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-274284d8-f353-4056-add2-dd8f1fee9989 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="22"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="pk51TU8K8a_G" data-outputId="9cab637d-237a-48ce-8e90-11b69c928d73">
<div class="sourceCode" id="cb27"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> nltk.tokenize <span class="im">import</span> word_tokenize</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>nltk.download(<span class="st">&#39;punkt&#39;</span>)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> string</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove punctuation marks</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;punct_comment&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;slang_comment&#39;</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="st">&#39;&#39;</span>.join([char <span class="cf">for</span> char <span class="kw">in</span> x <span class="cf">if</span> char <span class="kw">not</span> <span class="kw">in</span> string.punctuation <span class="kw">or</span> char <span class="kw">in</span> [<span class="st">&#39;?&#39;</span>, <span class="st">&#39;!&#39;</span>,<span class="st">&#39;...&#39;</span>]]))</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;punct_parent_comment&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;slang_parent_comment&#39;</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="st">&#39;&#39;</span>.join([char <span class="cf">for</span> char <span class="kw">in</span> x <span class="cf">if</span> char <span class="kw">not</span> <span class="kw">in</span> string.punctuation <span class="kw">or</span> char <span class="kw">in</span> [<span class="st">&#39;?&#39;</span>, <span class="st">&#39;!&#39;</span>,<span class="st">&#39;...&#39;</span>]]))</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Tokenize the text</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;tokenized_comment&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;punct_comment&#39;</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: word_tokenize(x))</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;tokenized_parent_comment&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;punct_parent_comment&#39;</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: word_tokenize(x))</span></code></pre></div>
<div class="output stream stderr">
<pre><code>[nltk_data] Downloading package punkt to /root/nltk_data...
[nltk_data]   Unzipping tokenizers/punkt.zip.
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="23"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:1000}"
id="yGbDpMct8a_H" data-outputId="f7eedcdd-5295-4c6f-9a2d-674c46ae3728">
<div class="sourceCode" id="cb29"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>df.head(<span class="dv">10</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="23">

  <div id="df-ac41386a-75d1-46b5-8d21-8ad65f1c79f1" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>label</th>
      <th>comment</th>
      <th>author</th>
      <th>score</th>
      <th>created_utc</th>
      <th>parent_comment</th>
      <th>cleanV1_comment</th>
      <th>cleanV1_parent_comment</th>
      <th>abbr_comment</th>
      <th>detected_abbr</th>
      <th>abbr_parent_comment</th>
      <th>detected_parent_abbr</th>
      <th>slang_comment</th>
      <th>detected_slangs</th>
      <th>slang_parent_comment</th>
      <th>detected_parent_slangs</th>
      <th>punct_comment</th>
      <th>punct_parent_comment</th>
      <th>tokenized_comment</th>
      <th>tokenized_parent_comment</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>Although mill decks would love to see you play...</td>
      <td>Zerotan</td>
      <td>2</td>
      <td>2015-07-23 19:38:00</td>
      <td>Correct me if I'm mistaken, but this card turn...</td>
      <td>Although mill decks would love to see you play...</td>
      <td>Correct me if I am mistaken, but this card tur...</td>
      <td>Although mill decks would love to see you play...</td>
      <td>[]</td>
      <td>Correct me if I am mistaken, but this card tur...</td>
      <td>[]</td>
      <td>Although mill decks would love to see you play...</td>
      <td>[]</td>
      <td>Correct me if I am mistaken, but this card tur...</td>
      <td>[]</td>
      <td>Although mill decks would love to see you play...</td>
      <td>Correct me if I am mistaken but this card turn...</td>
      <td>[Although, mill, decks, would, love, to, see, ...</td>
      <td>[Correct, me, if, I, am, mistaken, but, this, ...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>you just have one of those faces i guess</td>
      <td>Rollingten</td>
      <td>1</td>
      <td>2013-04-29 19:33:39</td>
      <td>how you think you can discern that is beyond me</td>
      <td>you just have one of those faces i guess</td>
      <td>how you think you can discern that is beyond me</td>
      <td>you just have one of those faces i guess</td>
      <td>[]</td>
      <td>how you think you can discern that is beyond me</td>
      <td>[]</td>
      <td>you just have one of those faces i guess</td>
      <td>[]</td>
      <td>how you think you can discern that is beyond me</td>
      <td>[]</td>
      <td>you just have one of those faces i guess</td>
      <td>how you think you can discern that is beyond me</td>
      <td>[you, just, have, one, of, those, faces, i, gu...</td>
      <td>[how, you, think, you, can, discern, that, is,...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>Thanks Samsung, we really needed this in the w...</td>
      <td>ProGamerGov</td>
      <td>12</td>
      <td>2014-09-16 20:50:15</td>
      <td>Who goes there? Samsung unveils robot sentry t...</td>
      <td>Thanks Samsung, we really needed this in the w...</td>
      <td>Who goes there? Samsung unveils robot sentry t...</td>
      <td>Thanks Samsung, we really needed this in the w...</td>
      <td>[]</td>
      <td>Who goes there? Samsung unveils robot sentry t...</td>
      <td>[]</td>
      <td>Thanks Samsung, we really needed this in the w...</td>
      <td>[]</td>
      <td>Who goes there? Samsung unveils robot sentry t...</td>
      <td>[]</td>
      <td>Thanks Samsung we really needed this in the wo...</td>
      <td>Who goes there? Samsung unveils robot sentry t...</td>
      <td>[Thanks, Samsung, we, really, needed, this, in...</td>
      <td>[Who, goes, there, ?, Samsung, unveils, robot,...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>I still think Lloyd McClendon somehow wins it ...</td>
      <td>SaddestClown</td>
      <td>7</td>
      <td>2015-08-31 00:20:45</td>
      <td>If the Rangers win the division, Banister HAS ...</td>
      <td>I still think Lloyd McClendon somehow wins it ...</td>
      <td>If the Rangers win the division, Banister HAS ...</td>
      <td>I still think Lloyd McClendon somehow wins it ...</td>
      <td>[]</td>
      <td>If the Rangers win the division, Banister HAS ...</td>
      <td>[HAS, AL]</td>
      <td>I still think Lloyd McClendon somehow wins it ...</td>
      <td>[]</td>
      <td>If the Rangers win the division, Banister HAS ...</td>
      <td>[]</td>
      <td>I still think Lloyd McClendon somehow wins it ...</td>
      <td>If the Rangers win the division Banister HAS t...</td>
      <td>[I, still, think, Lloyd, McClendon, somehow, w...</td>
      <td>[If, the, Rangers, win, the, division, Baniste...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>That was actually completely unintentional.</td>
      <td>virulentArachnid</td>
      <td>1</td>
      <td>2014-07-21 10:16:39</td>
      <td>I see what you did there.</td>
      <td>That was actually completely unintentional.</td>
      <td>I see what you did there.</td>
      <td>That was actually completely unintentional.</td>
      <td>[]</td>
      <td>I see what you did there.</td>
      <td>[]</td>
      <td>That was actually completely unintentional.</td>
      <td>[]</td>
      <td>I see what you did there.</td>
      <td>[]</td>
      <td>That was actually completely unintentional</td>
      <td>I see what you did there</td>
      <td>[That, was, actually, completely, unintentional]</td>
      <td>[I, see, what, you, did, there]</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0</td>
      <td>Cardinals fan?</td>
      <td>XC_Stallion92</td>
      <td>2</td>
      <td>2014-10-30 04:29:02</td>
      <td>As my friend says, you haven't experienced pai...</td>
      <td>Cardinals fan?</td>
      <td>As my friend says, you have not experienced pa...</td>
      <td>Cardinals fan?</td>
      <td>[]</td>
      <td>As my friend says, you have not experienced pa...</td>
      <td>[]</td>
      <td>Cardinals fan?</td>
      <td>[]</td>
      <td>As my friend says, you have not experienced pa...</td>
      <td>[]</td>
      <td>Cardinals fan?</td>
      <td>As my friend says you have not experienced pai...</td>
      <td>[Cardinals, fan, ?]</td>
      <td>[As, my, friend, says, you, have, not, experie...</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0</td>
      <td>The thing though is that the SPJ is only conce...</td>
      <td>Helium_Pugilist</td>
      <td>2</td>
      <td>2015-05-08 10:43:09</td>
      <td>First of all, if you go through the panelists ...</td>
      <td>The thing though is that the SPJ is only conce...</td>
      <td>First of all, if you go through the panelists ...</td>
      <td>The thing though is that the SPJ is only conce...</td>
      <td>[SPJ, CS]</td>
      <td>First of all, if you go through the panelists ...</td>
      <td>[SPJ]</td>
      <td>The thing though is that the SPJ is only conce...</td>
      <td>[]</td>
      <td>First of all, if you go through the panelists ...</td>
      <td>[]</td>
      <td>The thing though is that the SPJ is only conce...</td>
      <td>First of all if you go through the panelists o...</td>
      <td>[The, thing, though, is, that, the, SPJ, is, o...</td>
      <td>[First, of, all, if, you, go, through, the, pa...</td>
    </tr>
    <tr>
      <th>7</th>
      <td>1</td>
      <td>The ones that have created a strong economy an...</td>
      <td>GodDamnMongolian</td>
      <td>8</td>
      <td>2016-12-06 15:25:10</td>
      <td>Which Obama policies are keeping the US down?</td>
      <td>The ones that have created a strong economy an...</td>
      <td>Which Obama policies are keeping the US down?</td>
      <td>The ones that have created a strong economy an...</td>
      <td>[]</td>
      <td>Which Obama policies are keeping the United St...</td>
      <td>[US]</td>
      <td>The ones that have created a strong economy an...</td>
      <td>[]</td>
      <td>Which Obama policies are keeping the United St...</td>
      <td>[]</td>
      <td>The ones that have created a strong economy an...</td>
      <td>Which Obama policies are keeping the United St...</td>
      <td>[The, ones, that, have, created, a, strong, ec...</td>
      <td>[Which, Obama, policies, are, keeping, the, Un...</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0</td>
      <td>"When I order a meal, of course I care more ab...</td>
      <td>Ramyrok</td>
      <td>2</td>
      <td>2016-01-25 22:03:00</td>
      <td>Gameplay is what matters. A turd is still a tu...</td>
      <td>"When I order a meal, of course I care more ab...</td>
      <td>Gameplay is what matters. A turd is still a tu...</td>
      <td>"When I order a meal, of course I care more ab...</td>
      <td>[]</td>
      <td>Gameplay is what matters. A turd is still a tu...</td>
      <td>[]</td>
      <td>"When I order a meal, of course I care more ab...</td>
      <td>[]</td>
      <td>Gameplay is what matters. A turd is still a tu...</td>
      <td>[]</td>
      <td>When I order a meal of course I care more abou...</td>
      <td>Gameplay is what matters A turd is still a tur...</td>
      <td>[When, I, order, a, meal, of, course, I, care,...</td>
      <td>[Gameplay, is, what, matters, A, turd, is, sti...</td>
    </tr>
    <tr>
      <th>9</th>
      <td>1</td>
      <td>b-b-but its not a religion its a relationship ...</td>
      <td>rusty_chipmunk</td>
      <td>2</td>
      <td>2012-07-25 18:56:21</td>
      <td>I love how they all attack James for "bringing...</td>
      <td>b-b-but its not a religion its a relationship ...</td>
      <td>I love how they all attack James for "bringing...</td>
      <td>b-b-but its not a religion its a relationship ...</td>
      <td>[]</td>
      <td>I love how they all attack James for "bringing...</td>
      <td>[]</td>
      <td>b-b-but its not a religion its a relationship ...</td>
      <td>[]</td>
      <td>I love how they all attack James for "bringing...</td>
      <td>[]</td>
      <td>bbbut its not a religion its a relationship wi...</td>
      <td>I love how they all attack James for bringing ...</td>
      <td>[bbbut, its, not, a, religion, its, a, relatio...</td>
      <td>[I, love, how, they, all, attack, James, for, ...</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-ac41386a-75d1-46b5-8d21-8ad65f1c79f1')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-ac41386a-75d1-46b5-8d21-8ad65f1c79f1 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-ac41386a-75d1-46b5-8d21-8ad65f1c79f1');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-3ed9cff5-9339-4e9f-bad2-694040e1fa12">
  <button class="colab-df-quickchart" onclick="quickchart('df-3ed9cff5-9339-4e9f-bad2-694040e1fa12')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-3ed9cff5-9339-4e9f-bad2-694040e1fa12 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="24"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="fzGbCuSS8a_H" data-outputId="6aeb81f2-d843-41bd-ffc8-4a483a9385e3">
<div class="sourceCode" id="cb30"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> emoji</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to check if a string contains emojis</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> has_emoji(text):</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">#text = str(text)</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>    emoji_pattern <span class="op">=</span> re.<span class="bu">compile</span>(<span class="st">&quot;[&quot;</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>                               <span class="st">u&quot;</span><span class="ch">\U0001F600</span><span class="st">-</span><span class="ch">\U0001F64F</span><span class="st">&quot;</span>  <span class="co"># emoticons</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>                               <span class="st">u&quot;</span><span class="ch">\U0001F300</span><span class="st">-</span><span class="ch">\U0001F5FF</span><span class="st">&quot;</span>  <span class="co"># symbols &amp; pictographs</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>                               <span class="st">u&quot;</span><span class="ch">\U0001F680</span><span class="st">-</span><span class="ch">\U0001F6FF</span><span class="st">&quot;</span>  <span class="co"># transport &amp; map symbols</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>                               <span class="st">u&quot;</span><span class="ch">\U0001F700</span><span class="st">-</span><span class="ch">\U0001F77F</span><span class="st">&quot;</span>  <span class="co"># alchemical symbols</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>                               <span class="st">u&quot;</span><span class="ch">\U0001F780</span><span class="st">-</span><span class="ch">\U0001F7FF</span><span class="st">&quot;</span>  <span class="co"># Geometric Shapes Extended</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>                               <span class="st">u&quot;</span><span class="ch">\U0001F800</span><span class="st">-</span><span class="ch">\U0001F8FF</span><span class="st">&quot;</span>  <span class="co"># Supplemental Arrows-C</span></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>                               <span class="st">u&quot;</span><span class="ch">\U0001F900</span><span class="st">-</span><span class="ch">\U0001F9FF</span><span class="st">&quot;</span>  <span class="co"># Supplemental Symbols and Pictographs</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>                               <span class="st">u&quot;</span><span class="ch">\U0001FA00</span><span class="st">-</span><span class="ch">\U0001FA6F</span><span class="st">&quot;</span>  <span class="co"># Chess Symbols</span></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>                               <span class="st">u&quot;</span><span class="ch">\U0001FA70</span><span class="st">-</span><span class="ch">\U0001FAFF</span><span class="st">&quot;</span>  <span class="co"># Symbols and Pictographs Extended-A</span></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>                               <span class="st">u&quot;</span><span class="ch">\U00002702</span><span class="st">-</span><span class="ch">\U000027B0</span><span class="st">&quot;</span>  <span class="co"># Dingbats</span></span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>                               <span class="st">u&quot;</span><span class="ch">\U000024C2</span><span class="st">-</span><span class="ch">\U0001F251</span><span class="st">&quot;</span></span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>                               <span class="st">&quot;]+&quot;</span>, flags<span class="op">=</span>re.UNICODE)</span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">bool</span>(emoji_pattern.search(text))</span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to replace emojis with their meanings</span></span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> replace_emojis(text):</span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> emoji.demojize(text)</span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply emoji replacement and check for emojis</span></span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&quot;has_emoji&quot;</span>] <span class="op">=</span> df[<span class="st">&quot;tokenized_comment&quot;</span>].astype(<span class="bu">str</span>).<span class="bu">apply</span>(has_emoji)</span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&quot;has_emoji_parent&quot;</span>] <span class="op">=</span> df[<span class="st">&quot;tokenized_parent_comment&quot;</span>].astype(<span class="bu">str</span>).<span class="bu">apply</span>(has_emoji)</span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply emoji replacement and create a pandas Series</span></span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a>emoji_replaced_series <span class="op">=</span> df[<span class="st">&quot;tokenized_comment&quot;</span>].astype(<span class="bu">str</span>).<span class="bu">apply</span>(replace_emojis)</span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a>emoji_replaced_series_parent <span class="op">=</span> df[<span class="st">&quot;tokenized_parent_comment&quot;</span>].astype(<span class="bu">str</span>).<span class="bu">apply</span>(replace_emojis)</span>
<span id="cb30-31"><a href="#cb30-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-32"><a href="#cb30-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Assign the pandas Series to the DataFrame as a new column</span></span>
<span id="cb30-33"><a href="#cb30-33" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&quot;emoji_replaced_comment&quot;</span>] <span class="op">=</span> emoji_replaced_series</span>
<span id="cb30-34"><a href="#cb30-34" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&quot;emoji_replaced_parent_comment&quot;</span>] <span class="op">=</span> emoji_replaced_series_parent</span>
<span id="cb30-35"><a href="#cb30-35" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">type</span>(df[<span class="st">&#39;emoji_replaced_comment&#39;</span>]))</span>
<span id="cb30-36"><a href="#cb30-36" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">type</span>(df[<span class="st">&#39;emoji_replaced_parent_comment&#39;</span>]))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>&lt;class &#39;pandas.core.series.Series&#39;&gt;
&lt;class &#39;pandas.core.series.Series&#39;&gt;
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="25"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="DFeC9dUQ8a_I" data-outputId="5dc0135d-df13-435d-dc29-d38d7a6fe4fe">
<div class="sourceCode" id="cb32"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df[<span class="st">&#39;has_emoji&#39;</span>].value_counts()[<span class="va">False</span>])</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df[<span class="st">&#39;has_emoji_parent&#39;</span>].value_counts()[<span class="va">False</span>])</span></code></pre></div>
<div class="output stream stdout">
<pre><code>20000
20000
</code></pre>
</div>
</div>
<div class="cell markdown" id="LUf0wT3y8a_I">
<p><strong>This upper value is same as the total number of comments,
which shows that we don't have any emojis in the dataset</strong></p>
</div>
<div class="cell code" data-execution_count="26"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:550}"
id="Pk8bFpjd8a_I" data-outputId="8d110ed0-b615-46db-922b-33d9979f56d9">
<div class="sourceCode" id="cb34"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>df.head(<span class="dv">5</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="26">

  <div id="df-913d473f-4d65-4334-95a1-31b2663bd745" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>label</th>
      <th>comment</th>
      <th>author</th>
      <th>score</th>
      <th>created_utc</th>
      <th>parent_comment</th>
      <th>cleanV1_comment</th>
      <th>cleanV1_parent_comment</th>
      <th>abbr_comment</th>
      <th>detected_abbr</th>
      <th>...</th>
      <th>slang_parent_comment</th>
      <th>detected_parent_slangs</th>
      <th>punct_comment</th>
      <th>punct_parent_comment</th>
      <th>tokenized_comment</th>
      <th>tokenized_parent_comment</th>
      <th>has_emoji</th>
      <th>has_emoji_parent</th>
      <th>emoji_replaced_comment</th>
      <th>emoji_replaced_parent_comment</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>Although mill decks would love to see you play...</td>
      <td>Zerotan</td>
      <td>2</td>
      <td>2015-07-23 19:38:00</td>
      <td>Correct me if I'm mistaken, but this card turn...</td>
      <td>Although mill decks would love to see you play...</td>
      <td>Correct me if I am mistaken, but this card tur...</td>
      <td>Although mill decks would love to see you play...</td>
      <td>[]</td>
      <td>...</td>
      <td>Correct me if I am mistaken, but this card tur...</td>
      <td>[]</td>
      <td>Although mill decks would love to see you play...</td>
      <td>Correct me if I am mistaken but this card turn...</td>
      <td>[Although, mill, decks, would, love, to, see, ...</td>
      <td>[Correct, me, if, I, am, mistaken, but, this, ...</td>
      <td>False</td>
      <td>False</td>
      <td>['Although', 'mill', 'decks', 'would', 'love',...</td>
      <td>['Correct', 'me', 'if', 'I', 'am', 'mistaken',...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>you just have one of those faces i guess</td>
      <td>Rollingten</td>
      <td>1</td>
      <td>2013-04-29 19:33:39</td>
      <td>how you think you can discern that is beyond me</td>
      <td>you just have one of those faces i guess</td>
      <td>how you think you can discern that is beyond me</td>
      <td>you just have one of those faces i guess</td>
      <td>[]</td>
      <td>...</td>
      <td>how you think you can discern that is beyond me</td>
      <td>[]</td>
      <td>you just have one of those faces i guess</td>
      <td>how you think you can discern that is beyond me</td>
      <td>[you, just, have, one, of, those, faces, i, gu...</td>
      <td>[how, you, think, you, can, discern, that, is,...</td>
      <td>False</td>
      <td>False</td>
      <td>['you', 'just', 'have', 'one', 'of', 'those', ...</td>
      <td>['how', 'you', 'think', 'you', 'can', 'discern...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>Thanks Samsung, we really needed this in the w...</td>
      <td>ProGamerGov</td>
      <td>12</td>
      <td>2014-09-16 20:50:15</td>
      <td>Who goes there? Samsung unveils robot sentry t...</td>
      <td>Thanks Samsung, we really needed this in the w...</td>
      <td>Who goes there? Samsung unveils robot sentry t...</td>
      <td>Thanks Samsung, we really needed this in the w...</td>
      <td>[]</td>
      <td>...</td>
      <td>Who goes there? Samsung unveils robot sentry t...</td>
      <td>[]</td>
      <td>Thanks Samsung we really needed this in the wo...</td>
      <td>Who goes there? Samsung unveils robot sentry t...</td>
      <td>[Thanks, Samsung, we, really, needed, this, in...</td>
      <td>[Who, goes, there, ?, Samsung, unveils, robot,...</td>
      <td>False</td>
      <td>False</td>
      <td>['Thanks', 'Samsung', 'we', 'really', 'needed'...</td>
      <td>['Who', 'goes', 'there', '?', 'Samsung', 'unve...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>I still think Lloyd McClendon somehow wins it ...</td>
      <td>SaddestClown</td>
      <td>7</td>
      <td>2015-08-31 00:20:45</td>
      <td>If the Rangers win the division, Banister HAS ...</td>
      <td>I still think Lloyd McClendon somehow wins it ...</td>
      <td>If the Rangers win the division, Banister HAS ...</td>
      <td>I still think Lloyd McClendon somehow wins it ...</td>
      <td>[]</td>
      <td>...</td>
      <td>If the Rangers win the division, Banister HAS ...</td>
      <td>[]</td>
      <td>I still think Lloyd McClendon somehow wins it ...</td>
      <td>If the Rangers win the division Banister HAS t...</td>
      <td>[I, still, think, Lloyd, McClendon, somehow, w...</td>
      <td>[If, the, Rangers, win, the, division, Baniste...</td>
      <td>False</td>
      <td>False</td>
      <td>['I', 'still', 'think', 'Lloyd', 'McClendon', ...</td>
      <td>['If', 'the', 'Rangers', 'win', 'the', 'divisi...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>That was actually completely unintentional.</td>
      <td>virulentArachnid</td>
      <td>1</td>
      <td>2014-07-21 10:16:39</td>
      <td>I see what you did there.</td>
      <td>That was actually completely unintentional.</td>
      <td>I see what you did there.</td>
      <td>That was actually completely unintentional.</td>
      <td>[]</td>
      <td>...</td>
      <td>I see what you did there.</td>
      <td>[]</td>
      <td>That was actually completely unintentional</td>
      <td>I see what you did there</td>
      <td>[That, was, actually, completely, unintentional]</td>
      <td>[I, see, what, you, did, there]</td>
      <td>False</td>
      <td>False</td>
      <td>['That', 'was', 'actually', 'completely', 'uni...</td>
      <td>['I', 'see', 'what', 'you', 'did', 'there']</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 24 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-913d473f-4d65-4334-95a1-31b2663bd745')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-913d473f-4d65-4334-95a1-31b2663bd745 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-913d473f-4d65-4334-95a1-31b2663bd745');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-d4f0768d-b467-490c-866b-c73a725ab48d">
  <button class="colab-df-quickchart" onclick="quickchart('df-d4f0768d-b467-490c-866b-c73a725ab48d')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-d4f0768d-b467-490c-866b-c73a725ab48d button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

    </div>
  </div>

</div>
</div>
<div class="cell markdown" id="gWxUEA0WZxb5">
<p><strong>Lowercasing the tokenized comments and parent
comments</strong></p>
</div>
<div class="cell code" data-execution_count="27" id="1dxb3YHTZ8nl">
<div class="sourceCode" id="cb35"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply the lowercase_except_caps function to &#39;emoji_replaced_comment&#39; column</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;lowered_comment&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;emoji_replaced_comment&#39;</span>].<span class="bu">apply</span>(lowercase_except_caps)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply the lowercase_except_caps function to &#39;emoji_replaced_parent_comment&#39; column</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;lowered_parent_comment&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;emoji_replaced_parent_comment&#39;</span>].<span class="bu">apply</span>(lowercase_except_caps)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="28"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:550}"
id="hf83RykWagmz" data-outputId="d3abda5f-9ef3-412b-9a7e-e1cf9976d36b">
<div class="sourceCode" id="cb36"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>df.head(<span class="dv">5</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="28">

  <div id="df-3872ceea-2e07-4532-b5d3-ce19ed3fb920" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>label</th>
      <th>comment</th>
      <th>author</th>
      <th>score</th>
      <th>created_utc</th>
      <th>parent_comment</th>
      <th>cleanV1_comment</th>
      <th>cleanV1_parent_comment</th>
      <th>abbr_comment</th>
      <th>detected_abbr</th>
      <th>...</th>
      <th>punct_comment</th>
      <th>punct_parent_comment</th>
      <th>tokenized_comment</th>
      <th>tokenized_parent_comment</th>
      <th>has_emoji</th>
      <th>has_emoji_parent</th>
      <th>emoji_replaced_comment</th>
      <th>emoji_replaced_parent_comment</th>
      <th>lowered_comment</th>
      <th>lowered_parent_comment</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>Although mill decks would love to see you play...</td>
      <td>Zerotan</td>
      <td>2</td>
      <td>2015-07-23 19:38:00</td>
      <td>Correct me if I'm mistaken, but this card turn...</td>
      <td>Although mill decks would love to see you play...</td>
      <td>Correct me if I am mistaken, but this card tur...</td>
      <td>Although mill decks would love to see you play...</td>
      <td>[]</td>
      <td>...</td>
      <td>Although mill decks would love to see you play...</td>
      <td>Correct me if I am mistaken but this card turn...</td>
      <td>[Although, mill, decks, would, love, to, see, ...</td>
      <td>[Correct, me, if, I, am, mistaken, but, this, ...</td>
      <td>False</td>
      <td>False</td>
      <td>['Although', 'mill', 'decks', 'would', 'love',...</td>
      <td>['Correct', 'me', 'if', 'I', 'am', 'mistaken',...</td>
      <td>['although', 'mill', 'decks', 'would', 'love',...</td>
      <td>['correct', 'me', 'if', 'I', 'am', 'mistaken',...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>you just have one of those faces i guess</td>
      <td>Rollingten</td>
      <td>1</td>
      <td>2013-04-29 19:33:39</td>
      <td>how you think you can discern that is beyond me</td>
      <td>you just have one of those faces i guess</td>
      <td>how you think you can discern that is beyond me</td>
      <td>you just have one of those faces i guess</td>
      <td>[]</td>
      <td>...</td>
      <td>you just have one of those faces i guess</td>
      <td>how you think you can discern that is beyond me</td>
      <td>[you, just, have, one, of, those, faces, i, gu...</td>
      <td>[how, you, think, you, can, discern, that, is,...</td>
      <td>False</td>
      <td>False</td>
      <td>['you', 'just', 'have', 'one', 'of', 'those', ...</td>
      <td>['how', 'you', 'think', 'you', 'can', 'discern...</td>
      <td>['you', 'just', 'have', 'one', 'of', 'those', ...</td>
      <td>['how', 'you', 'think', 'you', 'can', 'discern...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>Thanks Samsung, we really needed this in the w...</td>
      <td>ProGamerGov</td>
      <td>12</td>
      <td>2014-09-16 20:50:15</td>
      <td>Who goes there? Samsung unveils robot sentry t...</td>
      <td>Thanks Samsung, we really needed this in the w...</td>
      <td>Who goes there? Samsung unveils robot sentry t...</td>
      <td>Thanks Samsung, we really needed this in the w...</td>
      <td>[]</td>
      <td>...</td>
      <td>Thanks Samsung we really needed this in the wo...</td>
      <td>Who goes there? Samsung unveils robot sentry t...</td>
      <td>[Thanks, Samsung, we, really, needed, this, in...</td>
      <td>[Who, goes, there, ?, Samsung, unveils, robot,...</td>
      <td>False</td>
      <td>False</td>
      <td>['Thanks', 'Samsung', 'we', 'really', 'needed'...</td>
      <td>['Who', 'goes', 'there', '?', 'Samsung', 'unve...</td>
      <td>['thanks', 'samsung', 'we', 'really', 'needed'...</td>
      <td>['who', 'goes', 'there', '?', 'samsung', 'unve...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>I still think Lloyd McClendon somehow wins it ...</td>
      <td>SaddestClown</td>
      <td>7</td>
      <td>2015-08-31 00:20:45</td>
      <td>If the Rangers win the division, Banister HAS ...</td>
      <td>I still think Lloyd McClendon somehow wins it ...</td>
      <td>If the Rangers win the division, Banister HAS ...</td>
      <td>I still think Lloyd McClendon somehow wins it ...</td>
      <td>[]</td>
      <td>...</td>
      <td>I still think Lloyd McClendon somehow wins it ...</td>
      <td>If the Rangers win the division Banister HAS t...</td>
      <td>[I, still, think, Lloyd, McClendon, somehow, w...</td>
      <td>[If, the, Rangers, win, the, division, Baniste...</td>
      <td>False</td>
      <td>False</td>
      <td>['I', 'still', 'think', 'Lloyd', 'McClendon', ...</td>
      <td>['If', 'the', 'Rangers', 'win', 'the', 'divisi...</td>
      <td>['I', 'still', 'think', 'lloyd', 'mcclendon', ...</td>
      <td>['if', 'the', 'rangers', 'win', 'the', 'divisi...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>That was actually completely unintentional.</td>
      <td>virulentArachnid</td>
      <td>1</td>
      <td>2014-07-21 10:16:39</td>
      <td>I see what you did there.</td>
      <td>That was actually completely unintentional.</td>
      <td>I see what you did there.</td>
      <td>That was actually completely unintentional.</td>
      <td>[]</td>
      <td>...</td>
      <td>That was actually completely unintentional</td>
      <td>I see what you did there</td>
      <td>[That, was, actually, completely, unintentional]</td>
      <td>[I, see, what, you, did, there]</td>
      <td>False</td>
      <td>False</td>
      <td>['That', 'was', 'actually', 'completely', 'uni...</td>
      <td>['I', 'see', 'what', 'you', 'did', 'there']</td>
      <td>['that', 'was', 'actually', 'completely', 'uni...</td>
      <td>['I', 'see', 'what', 'you', 'did', 'there']</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 26 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-3872ceea-2e07-4532-b5d3-ce19ed3fb920')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-3872ceea-2e07-4532-b5d3-ce19ed3fb920 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-3872ceea-2e07-4532-b5d3-ce19ed3fb920');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-fa3ac948-fdbc-4a88-aa22-028c822e8806">
  <button class="colab-df-quickchart" onclick="quickchart('df-fa3ac948-fdbc-4a88-aa22-028c822e8806')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-fa3ac948-fdbc-4a88-aa22-028c822e8806 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

    </div>
  </div>

</div>
</div>
<div class="cell markdown" id="zFTDptq78a_J">
<p><strong>Stop words removal</strong></p>
</div>
<div class="cell code" data-execution_count="29" id="Z5cdrxZD8a_J">
<div class="sourceCode" id="cb37"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> ast</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> nltk.corpus <span class="im">import</span> stopwords</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Import stopwords and define custom set</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>stops <span class="op">=</span> <span class="bu">set</span>(stopwords.words(<span class="st">&#39;english&#39;</span>)) <span class="op">-</span> {<span class="st">&#39;no&#39;</span>, <span class="st">&#39;not&#39;</span>, <span class="st">&#39;nor&#39;</span>, <span class="st">&#39;against&#39;</span>, <span class="st">&#39;above&#39;</span>, <span class="st">&#39;below&#39;</span>, <span class="st">&#39;off&#39;</span>, <span class="st">&#39;own&#39;</span>}</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply stopword removal to the emoji_replaced_comment column</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> remove_stopwords(comment):</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [word <span class="cf">for</span> word <span class="kw">in</span> ast.literal_eval(comment) <span class="cf">if</span> word.lower() <span class="kw">not</span> <span class="kw">in</span> stops]</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&quot;cleaned_comment&quot;</span>] <span class="op">=</span> df[<span class="st">&quot;lowered_comment&quot;</span>].<span class="bu">apply</span>(remove_stopwords)</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&quot;cleaned_parent_comment&quot;</span>] <span class="op">=</span> df[<span class="st">&quot;lowered_parent_comment&quot;</span>].<span class="bu">apply</span>(remove_stopwords)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="30"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:550}"
id="ior8VrXQ8a_J" data-outputId="08875401-d6cb-4f7c-86d2-fec28859054f">
<div class="sourceCode" id="cb38"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>df.head(<span class="dv">5</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="30">

  <div id="df-4f772bab-c980-40d5-a401-c7acb954f15b" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>label</th>
      <th>comment</th>
      <th>author</th>
      <th>score</th>
      <th>created_utc</th>
      <th>parent_comment</th>
      <th>cleanV1_comment</th>
      <th>cleanV1_parent_comment</th>
      <th>abbr_comment</th>
      <th>detected_abbr</th>
      <th>...</th>
      <th>tokenized_comment</th>
      <th>tokenized_parent_comment</th>
      <th>has_emoji</th>
      <th>has_emoji_parent</th>
      <th>emoji_replaced_comment</th>
      <th>emoji_replaced_parent_comment</th>
      <th>lowered_comment</th>
      <th>lowered_parent_comment</th>
      <th>cleaned_comment</th>
      <th>cleaned_parent_comment</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>Although mill decks would love to see you play...</td>
      <td>Zerotan</td>
      <td>2</td>
      <td>2015-07-23 19:38:00</td>
      <td>Correct me if I'm mistaken, but this card turn...</td>
      <td>Although mill decks would love to see you play...</td>
      <td>Correct me if I am mistaken, but this card tur...</td>
      <td>Although mill decks would love to see you play...</td>
      <td>[]</td>
      <td>...</td>
      <td>[Although, mill, decks, would, love, to, see, ...</td>
      <td>[Correct, me, if, I, am, mistaken, but, this, ...</td>
      <td>False</td>
      <td>False</td>
      <td>['Although', 'mill', 'decks', 'would', 'love',...</td>
      <td>['Correct', 'me', 'if', 'I', 'am', 'mistaken',...</td>
      <td>['although', 'mill', 'decks', 'would', 'love',...</td>
      <td>['correct', 'me', 'if', 'I', 'am', 'mistaken',...</td>
      <td>[although, mill, decks, would, love, see, play]</td>
      <td>[correct, mistaken, card, turns, deck, card, o...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>you just have one of those faces i guess</td>
      <td>Rollingten</td>
      <td>1</td>
      <td>2013-04-29 19:33:39</td>
      <td>how you think you can discern that is beyond me</td>
      <td>you just have one of those faces i guess</td>
      <td>how you think you can discern that is beyond me</td>
      <td>you just have one of those faces i guess</td>
      <td>[]</td>
      <td>...</td>
      <td>[you, just, have, one, of, those, faces, i, gu...</td>
      <td>[how, you, think, you, can, discern, that, is,...</td>
      <td>False</td>
      <td>False</td>
      <td>['you', 'just', 'have', 'one', 'of', 'those', ...</td>
      <td>['how', 'you', 'think', 'you', 'can', 'discern...</td>
      <td>['you', 'just', 'have', 'one', 'of', 'those', ...</td>
      <td>['how', 'you', 'think', 'you', 'can', 'discern...</td>
      <td>[one, faces, guess]</td>
      <td>[think, discern, beyond]</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>Thanks Samsung, we really needed this in the w...</td>
      <td>ProGamerGov</td>
      <td>12</td>
      <td>2014-09-16 20:50:15</td>
      <td>Who goes there? Samsung unveils robot sentry t...</td>
      <td>Thanks Samsung, we really needed this in the w...</td>
      <td>Who goes there? Samsung unveils robot sentry t...</td>
      <td>Thanks Samsung, we really needed this in the w...</td>
      <td>[]</td>
      <td>...</td>
      <td>[Thanks, Samsung, we, really, needed, this, in...</td>
      <td>[Who, goes, there, ?, Samsung, unveils, robot,...</td>
      <td>False</td>
      <td>False</td>
      <td>['Thanks', 'Samsung', 'we', 'really', 'needed'...</td>
      <td>['Who', 'goes', 'there', '?', 'Samsung', 'unve...</td>
      <td>['thanks', 'samsung', 'we', 'really', 'needed'...</td>
      <td>['who', 'goes', 'there', '?', 'samsung', 'unve...</td>
      <td>[thanks, samsung, really, needed, world, !]</td>
      <td>[goes, ?, samsung, unveils, robot, sentry, kil...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>I still think Lloyd McClendon somehow wins it ...</td>
      <td>SaddestClown</td>
      <td>7</td>
      <td>2015-08-31 00:20:45</td>
      <td>If the Rangers win the division, Banister HAS ...</td>
      <td>I still think Lloyd McClendon somehow wins it ...</td>
      <td>If the Rangers win the division, Banister HAS ...</td>
      <td>I still think Lloyd McClendon somehow wins it ...</td>
      <td>[]</td>
      <td>...</td>
      <td>[I, still, think, Lloyd, McClendon, somehow, w...</td>
      <td>[If, the, Rangers, win, the, division, Baniste...</td>
      <td>False</td>
      <td>False</td>
      <td>['I', 'still', 'think', 'Lloyd', 'McClendon', ...</td>
      <td>['If', 'the', 'Rangers', 'win', 'the', 'divisi...</td>
      <td>['I', 'still', 'think', 'lloyd', 'mcclendon', ...</td>
      <td>['if', 'the', 'rangers', 'win', 'the', 'divisi...</td>
      <td>[still, think, lloyd, mcclendon, somehow, wins...</td>
      <td>[rangers, win, division, banister, get, AL, ma...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>That was actually completely unintentional.</td>
      <td>virulentArachnid</td>
      <td>1</td>
      <td>2014-07-21 10:16:39</td>
      <td>I see what you did there.</td>
      <td>That was actually completely unintentional.</td>
      <td>I see what you did there.</td>
      <td>That was actually completely unintentional.</td>
      <td>[]</td>
      <td>...</td>
      <td>[That, was, actually, completely, unintentional]</td>
      <td>[I, see, what, you, did, there]</td>
      <td>False</td>
      <td>False</td>
      <td>['That', 'was', 'actually', 'completely', 'uni...</td>
      <td>['I', 'see', 'what', 'you', 'did', 'there']</td>
      <td>['that', 'was', 'actually', 'completely', 'uni...</td>
      <td>['I', 'see', 'what', 'you', 'did', 'there']</td>
      <td>[actually, completely, unintentional]</td>
      <td>[see]</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 28 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-4f772bab-c980-40d5-a401-c7acb954f15b')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-4f772bab-c980-40d5-a401-c7acb954f15b button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-4f772bab-c980-40d5-a401-c7acb954f15b');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-eed6f2c4-29eb-4992-92ea-42adf436ee95">
  <button class="colab-df-quickchart" onclick="quickchart('df-eed6f2c4-29eb-4992-92ea-42adf436ee95')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-eed6f2c4-29eb-4992-92ea-42adf436ee95 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

    </div>
  </div>

</div>
</div>
<div class="cell markdown" id="CyCujGpV8a_K">
<p><strong>Cloud Map for highest occuring words in both(sarcastic &amp;
non-sarcastic) the categories before cleaning</strong></p>
</div>
<div class="cell code" data-execution_count="31"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:837}"
id="GcicWMs28a_K" data-outputId="d46961f4-6a88-4f28-9b20-313b526dbab8">
<div class="sourceCode" id="cb39"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pip install wordcloud</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> wordcloud <span class="im">import</span> WordCloud</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter sarcastic and non-sarcastic comments in &#39;comment&#39; column</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>sarcastic_comments <span class="op">=</span> <span class="st">&#39; &#39;</span>.join(df[df[<span class="st">&#39;label&#39;</span>] <span class="op">==</span> <span class="dv">1</span>][<span class="st">&#39;comment&#39;</span>])</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>non_sarcastic_comments <span class="op">=</span> <span class="st">&#39; &#39;</span>.join(df[df[<span class="st">&#39;label&#39;</span>] <span class="op">==</span> <span class="dv">0</span>][<span class="st">&#39;comment&#39;</span>])</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate word clouds for sarcastic and non-sarcastic comments in &#39;comment&#39; column</span></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>wordcloud_sarcastic <span class="op">=</span> WordCloud(width<span class="op">=</span><span class="dv">800</span>, height<span class="op">=</span><span class="dv">400</span>, background_color<span class="op">=</span><span class="st">&#39;white&#39;</span>).generate(sarcastic_comments)</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>wordcloud_non_sarcastic <span class="op">=</span> WordCloud(width<span class="op">=</span><span class="dv">800</span>, height<span class="op">=</span><span class="dv">400</span>, background_color<span class="op">=</span><span class="st">&#39;white&#39;</span>).generate(non_sarcastic_comments)</span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the word clouds for &#39;comment&#39;</span></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">6</span>))</span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>)</span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>plt.imshow(wordcloud_sarcastic, interpolation<span class="op">=</span><span class="st">&#39;bilinear&#39;</span>)</span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Sarcastic Comments in comment&#39;</span>)</span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a>plt.axis(<span class="st">&#39;off&#39;</span>)</span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a>plt.imshow(wordcloud_non_sarcastic, interpolation<span class="op">=</span><span class="st">&#39;bilinear&#39;</span>)</span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Non-Sarcastic Comments in comment&#39;</span>)</span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a>plt.axis(<span class="st">&#39;off&#39;</span>)</span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-26"><a href="#cb39-26" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb39-27"><a href="#cb39-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-28"><a href="#cb39-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter sarcastic and non-sarcastic comments in &#39;parent_comment&#39; column</span></span>
<span id="cb39-29"><a href="#cb39-29" aria-hidden="true" tabindex="-1"></a>sarcastic_parent_comments <span class="op">=</span> <span class="st">&#39; &#39;</span>.join(df[df[<span class="st">&#39;label&#39;</span>] <span class="op">==</span> <span class="dv">1</span>][<span class="st">&#39;parent_comment&#39;</span>])</span>
<span id="cb39-30"><a href="#cb39-30" aria-hidden="true" tabindex="-1"></a>non_sarcastic_parent_comments <span class="op">=</span> <span class="st">&#39; &#39;</span>.join(df[df[<span class="st">&#39;label&#39;</span>] <span class="op">==</span> <span class="dv">0</span>][<span class="st">&#39;parent_comment&#39;</span>])</span>
<span id="cb39-31"><a href="#cb39-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-32"><a href="#cb39-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate word clouds for sarcastic and non-sarcastic comments in &#39;parent_comment&#39; column</span></span>
<span id="cb39-33"><a href="#cb39-33" aria-hidden="true" tabindex="-1"></a>wordcloud_sarcastic_parent <span class="op">=</span> WordCloud(width<span class="op">=</span><span class="dv">800</span>, height<span class="op">=</span><span class="dv">400</span>, background_color<span class="op">=</span><span class="st">&#39;white&#39;</span>).generate(sarcastic_parent_comments)</span>
<span id="cb39-34"><a href="#cb39-34" aria-hidden="true" tabindex="-1"></a>wordcloud_non_sarcastic_parent <span class="op">=</span> WordCloud(width<span class="op">=</span><span class="dv">800</span>, height<span class="op">=</span><span class="dv">400</span>, background_color<span class="op">=</span><span class="st">&#39;white&#39;</span>).generate(non_sarcastic_parent_comments)</span>
<span id="cb39-35"><a href="#cb39-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-36"><a href="#cb39-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the word clouds for &#39;parent_comment&#39;</span></span>
<span id="cb39-37"><a href="#cb39-37" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">6</span>))</span>
<span id="cb39-38"><a href="#cb39-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-39"><a href="#cb39-39" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>)</span>
<span id="cb39-40"><a href="#cb39-40" aria-hidden="true" tabindex="-1"></a>plt.imshow(wordcloud_sarcastic_parent, interpolation<span class="op">=</span><span class="st">&#39;bilinear&#39;</span>)</span>
<span id="cb39-41"><a href="#cb39-41" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Sarcastic Comments in parent_comment&#39;</span>)</span>
<span id="cb39-42"><a href="#cb39-42" aria-hidden="true" tabindex="-1"></a>plt.axis(<span class="st">&#39;off&#39;</span>)</span>
<span id="cb39-43"><a href="#cb39-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-44"><a href="#cb39-44" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb39-45"><a href="#cb39-45" aria-hidden="true" tabindex="-1"></a>plt.imshow(wordcloud_non_sarcastic_parent, interpolation<span class="op">=</span><span class="st">&#39;bilinear&#39;</span>)</span>
<span id="cb39-46"><a href="#cb39-46" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Non-Sarcastic Comments in parent_comment&#39;</span>)</span>
<span id="cb39-47"><a href="#cb39-47" aria-hidden="true" tabindex="-1"></a>plt.axis(<span class="st">&#39;off&#39;</span>)</span>
<span id="cb39-48"><a href="#cb39-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-49"><a href="#cb39-49" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Requirement already satisfied: wordcloud in /usr/local/lib/python3.10/dist-packages (1.9.3)
Requirement already satisfied: numpy&gt;=1.6.1 in /usr/local/lib/python3.10/dist-packages (from wordcloud) (1.25.2)
Requirement already satisfied: pillow in /usr/local/lib/python3.10/dist-packages (from wordcloud) (9.4.0)
Requirement already satisfied: matplotlib in /usr/local/lib/python3.10/dist-packages (from wordcloud) (3.7.1)
Requirement already satisfied: contourpy&gt;=1.0.1 in /usr/local/lib/python3.10/dist-packages (from matplotlib-&gt;wordcloud) (1.2.1)
Requirement already satisfied: cycler&gt;=0.10 in /usr/local/lib/python3.10/dist-packages (from matplotlib-&gt;wordcloud) (0.12.1)
Requirement already satisfied: fonttools&gt;=4.22.0 in /usr/local/lib/python3.10/dist-packages (from matplotlib-&gt;wordcloud) (4.51.0)
Requirement already satisfied: kiwisolver&gt;=1.0.1 in /usr/local/lib/python3.10/dist-packages (from matplotlib-&gt;wordcloud) (1.4.5)
Requirement already satisfied: packaging&gt;=20.0 in /usr/local/lib/python3.10/dist-packages (from matplotlib-&gt;wordcloud) (24.0)
Requirement already satisfied: pyparsing&gt;=2.3.1 in /usr/local/lib/python3.10/dist-packages (from matplotlib-&gt;wordcloud) (3.1.2)
Requirement already satisfied: python-dateutil&gt;=2.7 in /usr/local/lib/python3.10/dist-packages (from matplotlib-&gt;wordcloud) (2.8.2)
Requirement already satisfied: six&gt;=1.5 in /usr/local/lib/python3.10/dist-packages (from python-dateutil&gt;=2.7-&gt;matplotlib-&gt;wordcloud) (1.16.0)
</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_bbbc7c3ec5c04b7191d21d4c180a5040/a01fa4da24c3104322506c36dc2b17cb65015aed.png" /></p>
</div>
<div class="output display_data">
<p><img
src="vertopal_bbbc7c3ec5c04b7191d21d4c180a5040/6a301ff3c768305f6edac68fea556feda7c70895.png" /></p>
</div>
</div>
<div class="cell markdown" id="FThyAi_U8a_L">
<p><strong>Cloud Map for highest occuring words in both(sarcastic &amp;
non-sarcastic) the categories after cleaning</strong></p>
</div>
<div class="cell code" data-execution_count="32"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:629}"
id="JU82mHPu8a_L" data-outputId="2da98cc1-6e49-4d76-ce1a-d53d62487e59">
<div class="sourceCode" id="cb41"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> wordcloud <span class="im">import</span> WordCloud</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Join lists of words in cleaned_comment column to form strings</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>sarcastic_comments <span class="op">=</span> <span class="st">&#39; &#39;</span>.join(df[df[<span class="st">&#39;label&#39;</span>] <span class="op">==</span> <span class="dv">1</span>][<span class="st">&#39;cleaned_comment&#39;</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="st">&#39; &#39;</span>.join(x)))</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>non_sarcastic_comments <span class="op">=</span> <span class="st">&#39; &#39;</span>.join(df[df[<span class="st">&#39;label&#39;</span>] <span class="op">==</span> <span class="dv">0</span>][<span class="st">&#39;cleaned_comment&#39;</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="st">&#39; &#39;</span>.join(x)))</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate word clouds for sarcastic and non-sarcastic comments in cleaned_comment</span></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>wordcloud_sarcastic <span class="op">=</span> WordCloud(width<span class="op">=</span><span class="dv">800</span>, height<span class="op">=</span><span class="dv">400</span>, background_color<span class="op">=</span><span class="st">&#39;white&#39;</span>).generate(sarcastic_comments)</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>wordcloud_non_sarcastic <span class="op">=</span> WordCloud(width<span class="op">=</span><span class="dv">800</span>, height<span class="op">=</span><span class="dv">400</span>, background_color<span class="op">=</span><span class="st">&#39;white&#39;</span>).generate(non_sarcastic_comments)</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the word clouds for cleaned_comment</span></span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">6</span>))</span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>)</span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>plt.imshow(wordcloud_sarcastic, interpolation<span class="op">=</span><span class="st">&#39;bilinear&#39;</span>)</span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Sarcastic Comments in cleaned_comment&#39;</span>)</span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a>plt.axis(<span class="st">&#39;off&#39;</span>)</span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a>plt.imshow(wordcloud_non_sarcastic, interpolation<span class="op">=</span><span class="st">&#39;bilinear&#39;</span>)</span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Non-Sarcastic Comments in cleaned_comment&#39;</span>)</span>
<span id="cb41-23"><a href="#cb41-23" aria-hidden="true" tabindex="-1"></a>plt.axis(<span class="st">&#39;off&#39;</span>)</span>
<span id="cb41-24"><a href="#cb41-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-25"><a href="#cb41-25" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb41-26"><a href="#cb41-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-27"><a href="#cb41-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Join lists of words in cleaned_parent_comment column to form strings</span></span>
<span id="cb41-28"><a href="#cb41-28" aria-hidden="true" tabindex="-1"></a>sarcastic_parent_comments <span class="op">=</span> <span class="st">&#39; &#39;</span>.join(df[df[<span class="st">&#39;label&#39;</span>] <span class="op">==</span> <span class="dv">1</span>][<span class="st">&#39;cleaned_parent_comment&#39;</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="st">&#39; &#39;</span>.join(x)))</span>
<span id="cb41-29"><a href="#cb41-29" aria-hidden="true" tabindex="-1"></a>non_sarcastic_parent_comments <span class="op">=</span> <span class="st">&#39; &#39;</span>.join(df[df[<span class="st">&#39;label&#39;</span>] <span class="op">==</span> <span class="dv">0</span>][<span class="st">&#39;cleaned_parent_comment&#39;</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="st">&#39; &#39;</span>.join(x)))</span>
<span id="cb41-30"><a href="#cb41-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-31"><a href="#cb41-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate word clouds for sarcastic and non-sarcastic comments in cleaned_parent_comment</span></span>
<span id="cb41-32"><a href="#cb41-32" aria-hidden="true" tabindex="-1"></a>wordcloud_sarcastic_parent <span class="op">=</span> WordCloud(width<span class="op">=</span><span class="dv">800</span>, height<span class="op">=</span><span class="dv">400</span>, background_color<span class="op">=</span><span class="st">&#39;white&#39;</span>).generate(sarcastic_parent_comments)</span>
<span id="cb41-33"><a href="#cb41-33" aria-hidden="true" tabindex="-1"></a>wordcloud_non_sarcastic_parent <span class="op">=</span> WordCloud(width<span class="op">=</span><span class="dv">800</span>, height<span class="op">=</span><span class="dv">400</span>, background_color<span class="op">=</span><span class="st">&#39;white&#39;</span>).generate(non_sarcastic_parent_comments)</span>
<span id="cb41-34"><a href="#cb41-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-35"><a href="#cb41-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the word clouds for cleaned_parent_comment</span></span>
<span id="cb41-36"><a href="#cb41-36" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">6</span>))</span>
<span id="cb41-37"><a href="#cb41-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-38"><a href="#cb41-38" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>)</span>
<span id="cb41-39"><a href="#cb41-39" aria-hidden="true" tabindex="-1"></a>plt.imshow(wordcloud_sarcastic_parent, interpolation<span class="op">=</span><span class="st">&#39;bilinear&#39;</span>)</span>
<span id="cb41-40"><a href="#cb41-40" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Sarcastic Comments in cleaned_parent_comment&#39;</span>)</span>
<span id="cb41-41"><a href="#cb41-41" aria-hidden="true" tabindex="-1"></a>plt.axis(<span class="st">&#39;off&#39;</span>)</span>
<span id="cb41-42"><a href="#cb41-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-43"><a href="#cb41-43" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb41-44"><a href="#cb41-44" aria-hidden="true" tabindex="-1"></a>plt.imshow(wordcloud_non_sarcastic_parent, interpolation<span class="op">=</span><span class="st">&#39;bilinear&#39;</span>)</span>
<span id="cb41-45"><a href="#cb41-45" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Non-Sarcastic Comments in cleaned_parent_comment&#39;</span>)</span>
<span id="cb41-46"><a href="#cb41-46" aria-hidden="true" tabindex="-1"></a>plt.axis(<span class="st">&#39;off&#39;</span>)</span>
<span id="cb41-47"><a href="#cb41-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-48"><a href="#cb41-48" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_bbbc7c3ec5c04b7191d21d4c180a5040/92dd91aa672762b4237ae1c56d79b6cb13cc7000.png" /></p>
</div>
<div class="output display_data">
<p><img
src="vertopal_bbbc7c3ec5c04b7191d21d4c180a5040/bd542844ddeee3a5a1832497254be13f47b43648.png" /></p>
</div>
</div>
<div class="cell markdown" id="UclBrln68a_L">
<p><strong>GloVe Embedding</strong></p>
</div>
<div class="cell code" data-execution_count="33" id="z1pdARI98a_M">
<div class="sourceCode" id="cb42"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> spacy</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Load SpaCy with GloVe vectors</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>nlp <span class="op">=</span> spacy.load(<span class="st">&quot;en_core_web_md&quot;</span>)  <span class="co"># Load the medium-sized English model with GloVe vectors</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Define function to compute average GloVe embeddings for a text</span></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> compute_average_glove_embedding(text, nlp_model):</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>    doc <span class="op">=</span> nlp_model(<span class="st">&#39; &#39;</span>.join(text))</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get vectors for each token in the text</span></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>    word_vectors <span class="op">=</span> [token.vector <span class="cf">for</span> token <span class="kw">in</span> doc <span class="cf">if</span> <span class="kw">not</span> token.is_stop]</span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> word_vectors:</span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Compute average embedding</span></span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>        average_embedding <span class="op">=</span> np.mean(word_vectors, axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> average_embedding</span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Return zeros if no valid word vectors found</span></span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> np.zeros(nlp_model.vocab.vectors_length)</span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute average GloVe embeddings for each comment</span></span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;glove_embedding&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;cleaned_comment&#39;</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: compute_average_glove_embedding(x, nlp))</span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;glove_parent_embedding&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;cleaned_parent_comment&#39;</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: compute_average_glove_embedding(x, nlp))</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="34"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:1000}"
id="1i1vTkwX8a_M" data-outputId="21ec8718-7daa-437a-e5e6-985c935472d5">
<div class="sourceCode" id="cb43"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>df.head(<span class="dv">10</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="34">

  <div id="df-4d957924-5b16-4a60-a1e5-3b7cf0a382bf" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>label</th>
      <th>comment</th>
      <th>author</th>
      <th>score</th>
      <th>created_utc</th>
      <th>parent_comment</th>
      <th>cleanV1_comment</th>
      <th>cleanV1_parent_comment</th>
      <th>abbr_comment</th>
      <th>detected_abbr</th>
      <th>...</th>
      <th>has_emoji</th>
      <th>has_emoji_parent</th>
      <th>emoji_replaced_comment</th>
      <th>emoji_replaced_parent_comment</th>
      <th>lowered_comment</th>
      <th>lowered_parent_comment</th>
      <th>cleaned_comment</th>
      <th>cleaned_parent_comment</th>
      <th>glove_embedding</th>
      <th>glove_parent_embedding</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>Although mill decks would love to see you play...</td>
      <td>Zerotan</td>
      <td>2</td>
      <td>2015-07-23 19:38:00</td>
      <td>Correct me if I'm mistaken, but this card turn...</td>
      <td>Although mill decks would love to see you play...</td>
      <td>Correct me if I am mistaken, but this card tur...</td>
      <td>Although mill decks would love to see you play...</td>
      <td>[]</td>
      <td>...</td>
      <td>False</td>
      <td>False</td>
      <td>['Although', 'mill', 'decks', 'would', 'love',...</td>
      <td>['Correct', 'me', 'if', 'I', 'am', 'mistaken',...</td>
      <td>['although', 'mill', 'decks', 'would', 'love',...</td>
      <td>['correct', 'me', 'if', 'I', 'am', 'mistaken',...</td>
      <td>[although, mill, decks, would, love, see, play]</td>
      <td>[correct, mistaken, card, turns, deck, card, o...</td>
      <td>[-1.8146749, 0.32449996, -2.5036223, -0.191600...</td>
      <td>[-1.1494846, 0.99603283, -1.9485236, 0.6356435...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>you just have one of those faces i guess</td>
      <td>Rollingten</td>
      <td>1</td>
      <td>2013-04-29 19:33:39</td>
      <td>how you think you can discern that is beyond me</td>
      <td>you just have one of those faces i guess</td>
      <td>how you think you can discern that is beyond me</td>
      <td>you just have one of those faces i guess</td>
      <td>[]</td>
      <td>...</td>
      <td>False</td>
      <td>False</td>
      <td>['you', 'just', 'have', 'one', 'of', 'those', ...</td>
      <td>['how', 'you', 'think', 'you', 'can', 'discern...</td>
      <td>['you', 'just', 'have', 'one', 'of', 'those', ...</td>
      <td>['how', 'you', 'think', 'you', 'can', 'discern...</td>
      <td>[one, faces, guess]</td>
      <td>[think, discern, beyond]</td>
      <td>[0.089385, 1.60758, -2.7418895, -1.7537501, 2....</td>
      <td>[-0.75512004, 1.55531, -1.64475, -1.24477, -1....</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>Thanks Samsung, we really needed this in the w...</td>
      <td>ProGamerGov</td>
      <td>12</td>
      <td>2014-09-16 20:50:15</td>
      <td>Who goes there? Samsung unveils robot sentry t...</td>
      <td>Thanks Samsung, we really needed this in the w...</td>
      <td>Who goes there? Samsung unveils robot sentry t...</td>
      <td>Thanks Samsung, we really needed this in the w...</td>
      <td>[]</td>
      <td>...</td>
      <td>False</td>
      <td>False</td>
      <td>['Thanks', 'Samsung', 'we', 'really', 'needed'...</td>
      <td>['Who', 'goes', 'there', '?', 'Samsung', 'unve...</td>
      <td>['thanks', 'samsung', 'we', 'really', 'needed'...</td>
      <td>['who', 'goes', 'there', '?', 'samsung', 'unve...</td>
      <td>[thanks, samsung, really, needed, world, !]</td>
      <td>[goes, ?, samsung, unveils, robot, sentry, kil...</td>
      <td>[2.524086, 0.36567402, -1.718602, -1.565164, 3...</td>
      <td>[-0.6565856, 1.7325287, -3.032008, -0.15609667...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>I still think Lloyd McClendon somehow wins it ...</td>
      <td>SaddestClown</td>
      <td>7</td>
      <td>2015-08-31 00:20:45</td>
      <td>If the Rangers win the division, Banister HAS ...</td>
      <td>I still think Lloyd McClendon somehow wins it ...</td>
      <td>If the Rangers win the division, Banister HAS ...</td>
      <td>I still think Lloyd McClendon somehow wins it ...</td>
      <td>[]</td>
      <td>...</td>
      <td>False</td>
      <td>False</td>
      <td>['I', 'still', 'think', 'Lloyd', 'McClendon', ...</td>
      <td>['If', 'the', 'Rangers', 'win', 'the', 'divisi...</td>
      <td>['I', 'still', 'think', 'lloyd', 'mcclendon', ...</td>
      <td>['if', 'the', 'rangers', 'win', 'the', 'divisi...</td>
      <td>[still, think, lloyd, mcclendon, somehow, wins...</td>
      <td>[rangers, win, division, banister, get, AL, ma...</td>
      <td>[-0.794985, -0.13094997, -0.32479998, -0.52786...</td>
      <td>[-1.8240331, -0.009008884, -0.2520467, -0.4538...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>That was actually completely unintentional.</td>
      <td>virulentArachnid</td>
      <td>1</td>
      <td>2014-07-21 10:16:39</td>
      <td>I see what you did there.</td>
      <td>That was actually completely unintentional.</td>
      <td>I see what you did there.</td>
      <td>That was actually completely unintentional.</td>
      <td>[]</td>
      <td>...</td>
      <td>False</td>
      <td>False</td>
      <td>['That', 'was', 'actually', 'completely', 'uni...</td>
      <td>['I', 'see', 'what', 'you', 'did', 'there']</td>
      <td>['that', 'was', 'actually', 'completely', 'uni...</td>
      <td>['I', 'see', 'what', 'you', 'did', 'there']</td>
      <td>[actually, completely, unintentional]</td>
      <td>[see]</td>
      <td>[-1.0084432, 0.062649995, -1.5305933, -0.48679...</td>
      <td>[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, ...</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0</td>
      <td>Cardinals fan?</td>
      <td>XC_Stallion92</td>
      <td>2</td>
      <td>2014-10-30 04:29:02</td>
      <td>As my friend says, you haven't experienced pai...</td>
      <td>Cardinals fan?</td>
      <td>As my friend says, you have not experienced pa...</td>
      <td>Cardinals fan?</td>
      <td>[]</td>
      <td>...</td>
      <td>False</td>
      <td>False</td>
      <td>['Cardinals', 'fan', '?']</td>
      <td>['As', 'my', 'friend', 'says', 'you', 'have', ...</td>
      <td>['cardinals', 'fan', '?']</td>
      <td>['as', 'my', 'friend', 'says', 'you', 'have', ...</td>
      <td>[cardinals, fan, ?]</td>
      <td>[friend, says, not, experienced, pain, heart, ...</td>
      <td>[-2.0594666, 1.90907, -4.497, -0.34484664, 0.7...</td>
      <td>[1.6600355, -0.22973616, -1.1333213, -0.218350...</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0</td>
      <td>The thing though is that the SPJ is only conce...</td>
      <td>Helium_Pugilist</td>
      <td>2</td>
      <td>2015-05-08 10:43:09</td>
      <td>First of all, if you go through the panelists ...</td>
      <td>The thing though is that the SPJ is only conce...</td>
      <td>First of all, if you go through the panelists ...</td>
      <td>The thing though is that the SPJ is only conce...</td>
      <td>[SPJ, CS]</td>
      <td>...</td>
      <td>False</td>
      <td>False</td>
      <td>['The', 'thing', 'though', 'is', 'that', 'the'...</td>
      <td>['First', 'of', 'all', 'if', 'you', 'go', 'thr...</td>
      <td>['the', 'thing', 'though', 'is', 'that', 'the'...</td>
      <td>['first', 'of', 'all', 'if', 'you', 'go', 'thr...</td>
      <td>[thing, though, SPJ, concerned, journalism, jo...</td>
      <td>[first, go, panelists, SPJ, conferences, not, ...</td>
      <td>[-1.9031148, 0.6047641, -1.2805583, 0.2794254,...</td>
      <td>[-1.041673, 0.2784871, -1.4882538, 0.22662407,...</td>
    </tr>
    <tr>
      <th>7</th>
      <td>1</td>
      <td>The ones that have created a strong economy an...</td>
      <td>GodDamnMongolian</td>
      <td>8</td>
      <td>2016-12-06 15:25:10</td>
      <td>Which Obama policies are keeping the US down?</td>
      <td>The ones that have created a strong economy an...</td>
      <td>Which Obama policies are keeping the US down?</td>
      <td>The ones that have created a strong economy an...</td>
      <td>[]</td>
      <td>...</td>
      <td>False</td>
      <td>False</td>
      <td>['The', 'ones', 'that', 'have', 'created', 'a'...</td>
      <td>['Which', 'Obama', 'policies', 'are', 'keeping...</td>
      <td>['the', 'ones', 'that', 'have', 'created', 'a'...</td>
      <td>['which', 'obama', 'policies', 'are', 'keeping...</td>
      <td>[ones, created, strong, economy, job, growth]</td>
      <td>[obama, policies, keeping, united, states, ?]</td>
      <td>[-1.6475164, 0.40547, -3.6585503, 0.8612399, 1...</td>
      <td>[-1.6469184, 2.5307033, -4.159575, 2.030835, 3...</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0</td>
      <td>"When I order a meal, of course I care more ab...</td>
      <td>Ramyrok</td>
      <td>2</td>
      <td>2016-01-25 22:03:00</td>
      <td>Gameplay is what matters. A turd is still a tu...</td>
      <td>"When I order a meal, of course I care more ab...</td>
      <td>Gameplay is what matters. A turd is still a tu...</td>
      <td>"When I order a meal, of course I care more ab...</td>
      <td>[]</td>
      <td>...</td>
      <td>False</td>
      <td>False</td>
      <td>['When', 'I', 'order', 'a', 'meal', 'of', 'cou...</td>
      <td>['Gameplay', 'is', 'what', 'matters', 'A', 'tu...</td>
      <td>['when', 'I', 'order', 'a', 'meal', 'of', 'cou...</td>
      <td>['gameplay', 'is', 'what', 'matters', 'A', 'tu...</td>
      <td>[order, meal, course, care, burger, drink, not...</td>
      <td>[gameplay, matters, turd, still, turd, even, k]</td>
      <td>[0.49062932, -0.014219081, -3.08628, -0.010710...</td>
      <td>[-1.1178579, 3.6516442, -0.124821976, 0.94178,...</td>
    </tr>
    <tr>
      <th>9</th>
      <td>1</td>
      <td>b-b-but its not a religion its a relationship ...</td>
      <td>rusty_chipmunk</td>
      <td>2</td>
      <td>2012-07-25 18:56:21</td>
      <td>I love how they all attack James for "bringing...</td>
      <td>b-b-but its not a religion its a relationship ...</td>
      <td>I love how they all attack James for "bringing...</td>
      <td>b-b-but its not a religion its a relationship ...</td>
      <td>[]</td>
      <td>...</td>
      <td>False</td>
      <td>False</td>
      <td>['bbbut', 'its', 'not', 'a', 'religion', 'its'...</td>
      <td>['I', 'love', 'how', 'they', 'all', 'attack', ...</td>
      <td>['bbbut', 'its', 'not', 'a', 'religion', 'its'...</td>
      <td>['I', 'love', 'how', 'they', 'all', 'attack', ...</td>
      <td>[bbbut, not, religion, relationship, jesus]</td>
      <td>[love, attack, james, bringing, religion, orig...</td>
      <td>[0.07996249, 0.54515755, -0.95657, -0.61660004...</td>
      <td>[-1.4038038, 0.6155148, -2.6457813, -1.0246228...</td>
    </tr>
  </tbody>
</table>
<p>10 rows × 30 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-4d957924-5b16-4a60-a1e5-3b7cf0a382bf')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-4d957924-5b16-4a60-a1e5-3b7cf0a382bf button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-4d957924-5b16-4a60-a1e5-3b7cf0a382bf');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-4bfa5606-4969-41a6-ab5a-0f5ceab5fdea">
  <button class="colab-df-quickchart" onclick="quickchart('df-4bfa5606-4969-41a6-ab5a-0f5ceab5fdea')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-4bfa5606-4969-41a6-ab5a-0f5ceab5fdea button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

    </div>
  </div>

</div>
</div>
<div class="cell markdown" id="CO1zCRCG8a_N">
<p><strong>lemmetization</strong></p>
</div>
<div class="cell code" data-execution_count="35" id="eASqAZX28a_N">
<div class="sourceCode" id="cb44"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the spaCy English language model</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>nlp <span class="op">=</span> spacy.load(<span class="st">&quot;en_core_web_sm&quot;</span>)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> lemma(comment):</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Join the list of words into a single string</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>    text <span class="op">=</span> <span class="st">&#39; &#39;</span>.join(comment)</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Tokenize the text</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>    words <span class="op">=</span> word_tokenize(text)</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Lemmatize and remove stopwords</span></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>    cleaned_words <span class="op">=</span> [token.lemma_ <span class="cf">for</span> token <span class="kw">in</span> nlp(<span class="st">&#39; &#39;</span>.join(words)) <span class="cf">if</span> token.text <span class="kw">not</span> <span class="kw">in</span> stops]</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Join the cleaned words back into a single string</span></span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>    cleaned_text <span class="op">=</span> <span class="st">&#39; &#39;</span>.join(cleaned_words)</span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> cleaned_text</span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply lemmatization</span></span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&quot;lemma_comment&quot;</span>] <span class="op">=</span> df[<span class="st">&quot;cleaned_comment&quot;</span>].<span class="bu">apply</span>(lemma)</span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&quot;lemma_parent_comment&quot;</span>] <span class="op">=</span> df[<span class="st">&quot;cleaned_parent_comment&quot;</span>].<span class="bu">apply</span>(lemma)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="36"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:1000}"
id="W0CgT9Wr8a_O" data-outputId="b8f96dae-fa28-4945-e1b0-bf13e187a628">
<div class="sourceCode" id="cb45"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>df.head(<span class="dv">10</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="36">

  <div id="df-ff649141-3993-486d-a048-309131d5c842" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>label</th>
      <th>comment</th>
      <th>author</th>
      <th>score</th>
      <th>created_utc</th>
      <th>parent_comment</th>
      <th>cleanV1_comment</th>
      <th>cleanV1_parent_comment</th>
      <th>abbr_comment</th>
      <th>detected_abbr</th>
      <th>...</th>
      <th>emoji_replaced_comment</th>
      <th>emoji_replaced_parent_comment</th>
      <th>lowered_comment</th>
      <th>lowered_parent_comment</th>
      <th>cleaned_comment</th>
      <th>cleaned_parent_comment</th>
      <th>glove_embedding</th>
      <th>glove_parent_embedding</th>
      <th>lemma_comment</th>
      <th>lemma_parent_comment</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>Although mill decks would love to see you play...</td>
      <td>Zerotan</td>
      <td>2</td>
      <td>2015-07-23 19:38:00</td>
      <td>Correct me if I'm mistaken, but this card turn...</td>
      <td>Although mill decks would love to see you play...</td>
      <td>Correct me if I am mistaken, but this card tur...</td>
      <td>Although mill decks would love to see you play...</td>
      <td>[]</td>
      <td>...</td>
      <td>['Although', 'mill', 'decks', 'would', 'love',...</td>
      <td>['Correct', 'me', 'if', 'I', 'am', 'mistaken',...</td>
      <td>['although', 'mill', 'decks', 'would', 'love',...</td>
      <td>['correct', 'me', 'if', 'I', 'am', 'mistaken',...</td>
      <td>[although, mill, decks, would, love, see, play]</td>
      <td>[correct, mistaken, card, turns, deck, card, o...</td>
      <td>[-1.8146749, 0.32449996, -2.5036223, -0.191600...</td>
      <td>[-1.1494846, 0.99603283, -1.9485236, 0.6356435...</td>
      <td>although mill deck would love see play</td>
      <td>correct mistaken card turn deck card one card ...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>you just have one of those faces i guess</td>
      <td>Rollingten</td>
      <td>1</td>
      <td>2013-04-29 19:33:39</td>
      <td>how you think you can discern that is beyond me</td>
      <td>you just have one of those faces i guess</td>
      <td>how you think you can discern that is beyond me</td>
      <td>you just have one of those faces i guess</td>
      <td>[]</td>
      <td>...</td>
      <td>['you', 'just', 'have', 'one', 'of', 'those', ...</td>
      <td>['how', 'you', 'think', 'you', 'can', 'discern...</td>
      <td>['you', 'just', 'have', 'one', 'of', 'those', ...</td>
      <td>['how', 'you', 'think', 'you', 'can', 'discern...</td>
      <td>[one, faces, guess]</td>
      <td>[think, discern, beyond]</td>
      <td>[0.089385, 1.60758, -2.7418895, -1.7537501, 2....</td>
      <td>[-0.75512004, 1.55531, -1.64475, -1.24477, -1....</td>
      <td>one face guess</td>
      <td>think discern beyond</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>Thanks Samsung, we really needed this in the w...</td>
      <td>ProGamerGov</td>
      <td>12</td>
      <td>2014-09-16 20:50:15</td>
      <td>Who goes there? Samsung unveils robot sentry t...</td>
      <td>Thanks Samsung, we really needed this in the w...</td>
      <td>Who goes there? Samsung unveils robot sentry t...</td>
      <td>Thanks Samsung, we really needed this in the w...</td>
      <td>[]</td>
      <td>...</td>
      <td>['Thanks', 'Samsung', 'we', 'really', 'needed'...</td>
      <td>['Who', 'goes', 'there', '?', 'Samsung', 'unve...</td>
      <td>['thanks', 'samsung', 'we', 'really', 'needed'...</td>
      <td>['who', 'goes', 'there', '?', 'samsung', 'unve...</td>
      <td>[thanks, samsung, really, needed, world, !]</td>
      <td>[goes, ?, samsung, unveils, robot, sentry, kil...</td>
      <td>[2.524086, 0.36567402, -1.718602, -1.565164, 3...</td>
      <td>[-0.6565856, 1.7325287, -3.032008, -0.15609667...</td>
      <td>thank samsung really need world !</td>
      <td>go ? samsung unveils robot sentry kill two mil...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>I still think Lloyd McClendon somehow wins it ...</td>
      <td>SaddestClown</td>
      <td>7</td>
      <td>2015-08-31 00:20:45</td>
      <td>If the Rangers win the division, Banister HAS ...</td>
      <td>I still think Lloyd McClendon somehow wins it ...</td>
      <td>If the Rangers win the division, Banister HAS ...</td>
      <td>I still think Lloyd McClendon somehow wins it ...</td>
      <td>[]</td>
      <td>...</td>
      <td>['I', 'still', 'think', 'Lloyd', 'McClendon', ...</td>
      <td>['If', 'the', 'Rangers', 'win', 'the', 'divisi...</td>
      <td>['I', 'still', 'think', 'lloyd', 'mcclendon', ...</td>
      <td>['if', 'the', 'rangers', 'win', 'the', 'divisi...</td>
      <td>[still, think, lloyd, mcclendon, somehow, wins...</td>
      <td>[rangers, win, division, banister, get, AL, ma...</td>
      <td>[-0.794985, -0.13094997, -0.32479998, -0.52786...</td>
      <td>[-1.8240331, -0.009008884, -0.2520467, -0.4538...</td>
      <td>still think lloyd mcclendon somehow win good s...</td>
      <td>ranger win division banister get AL manager ye...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>That was actually completely unintentional.</td>
      <td>virulentArachnid</td>
      <td>1</td>
      <td>2014-07-21 10:16:39</td>
      <td>I see what you did there.</td>
      <td>That was actually completely unintentional.</td>
      <td>I see what you did there.</td>
      <td>That was actually completely unintentional.</td>
      <td>[]</td>
      <td>...</td>
      <td>['That', 'was', 'actually', 'completely', 'uni...</td>
      <td>['I', 'see', 'what', 'you', 'did', 'there']</td>
      <td>['that', 'was', 'actually', 'completely', 'uni...</td>
      <td>['I', 'see', 'what', 'you', 'did', 'there']</td>
      <td>[actually, completely, unintentional]</td>
      <td>[see]</td>
      <td>[-1.0084432, 0.062649995, -1.5305933, -0.48679...</td>
      <td>[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, ...</td>
      <td>actually completely unintentional</td>
      <td>see</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0</td>
      <td>Cardinals fan?</td>
      <td>XC_Stallion92</td>
      <td>2</td>
      <td>2014-10-30 04:29:02</td>
      <td>As my friend says, you haven't experienced pai...</td>
      <td>Cardinals fan?</td>
      <td>As my friend says, you have not experienced pa...</td>
      <td>Cardinals fan?</td>
      <td>[]</td>
      <td>...</td>
      <td>['Cardinals', 'fan', '?']</td>
      <td>['As', 'my', 'friend', 'says', 'you', 'have', ...</td>
      <td>['cardinals', 'fan', '?']</td>
      <td>['as', 'my', 'friend', 'says', 'you', 'have', ...</td>
      <td>[cardinals, fan, ?]</td>
      <td>[friend, says, not, experienced, pain, heart, ...</td>
      <td>[-2.0594666, 1.90907, -4.497, -0.34484664, 0.7...</td>
      <td>[1.6600355, -0.22973616, -1.1333213, -0.218350...</td>
      <td>cardinal fan ?</td>
      <td>friend say not experience pain heart rip giant...</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0</td>
      <td>The thing though is that the SPJ is only conce...</td>
      <td>Helium_Pugilist</td>
      <td>2</td>
      <td>2015-05-08 10:43:09</td>
      <td>First of all, if you go through the panelists ...</td>
      <td>The thing though is that the SPJ is only conce...</td>
      <td>First of all, if you go through the panelists ...</td>
      <td>The thing though is that the SPJ is only conce...</td>
      <td>[SPJ, CS]</td>
      <td>...</td>
      <td>['The', 'thing', 'though', 'is', 'that', 'the'...</td>
      <td>['First', 'of', 'all', 'if', 'you', 'go', 'thr...</td>
      <td>['the', 'thing', 'though', 'is', 'that', 'the'...</td>
      <td>['first', 'of', 'all', 'if', 'you', 'go', 'thr...</td>
      <td>[thing, though, SPJ, concerned, journalism, jo...</td>
      <td>[first, go, panelists, SPJ, conferences, not, ...</td>
      <td>[-1.9031148, 0.6047641, -1.2805583, 0.2794254,...</td>
      <td>[-1.041673, 0.2784871, -1.4882538, 0.22662407,...</td>
      <td>thing though SPJ concerned journalism journali...</td>
      <td>first go panelist SPJ conference not everyone ...</td>
    </tr>
    <tr>
      <th>7</th>
      <td>1</td>
      <td>The ones that have created a strong economy an...</td>
      <td>GodDamnMongolian</td>
      <td>8</td>
      <td>2016-12-06 15:25:10</td>
      <td>Which Obama policies are keeping the US down?</td>
      <td>The ones that have created a strong economy an...</td>
      <td>Which Obama policies are keeping the US down?</td>
      <td>The ones that have created a strong economy an...</td>
      <td>[]</td>
      <td>...</td>
      <td>['The', 'ones', 'that', 'have', 'created', 'a'...</td>
      <td>['Which', 'Obama', 'policies', 'are', 'keeping...</td>
      <td>['the', 'ones', 'that', 'have', 'created', 'a'...</td>
      <td>['which', 'obama', 'policies', 'are', 'keeping...</td>
      <td>[ones, created, strong, economy, job, growth]</td>
      <td>[obama, policies, keeping, united, states, ?]</td>
      <td>[-1.6475164, 0.40547, -3.6585503, 0.8612399, 1...</td>
      <td>[-1.6469184, 2.5307033, -4.159575, 2.030835, 3...</td>
      <td>one create strong economy job growth</td>
      <td>obama policy keep united state ?</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0</td>
      <td>"When I order a meal, of course I care more ab...</td>
      <td>Ramyrok</td>
      <td>2</td>
      <td>2016-01-25 22:03:00</td>
      <td>Gameplay is what matters. A turd is still a tu...</td>
      <td>"When I order a meal, of course I care more ab...</td>
      <td>Gameplay is what matters. A turd is still a tu...</td>
      <td>"When I order a meal, of course I care more ab...</td>
      <td>[]</td>
      <td>...</td>
      <td>['When', 'I', 'order', 'a', 'meal', 'of', 'cou...</td>
      <td>['Gameplay', 'is', 'what', 'matters', 'A', 'tu...</td>
      <td>['when', 'I', 'order', 'a', 'meal', 'of', 'cou...</td>
      <td>['gameplay', 'is', 'what', 'matters', 'A', 'tu...</td>
      <td>[order, meal, course, care, burger, drink, not...</td>
      <td>[gameplay, matters, turd, still, turd, even, k]</td>
      <td>[0.49062932, -0.014219081, -3.08628, -0.010710...</td>
      <td>[-1.1178579, 3.6516442, -0.124821976, 0.94178,...</td>
      <td>order meal course care burger drink not mean w...</td>
      <td>gameplay matter turd still turd even k</td>
    </tr>
    <tr>
      <th>9</th>
      <td>1</td>
      <td>b-b-but its not a religion its a relationship ...</td>
      <td>rusty_chipmunk</td>
      <td>2</td>
      <td>2012-07-25 18:56:21</td>
      <td>I love how they all attack James for "bringing...</td>
      <td>b-b-but its not a religion its a relationship ...</td>
      <td>I love how they all attack James for "bringing...</td>
      <td>b-b-but its not a religion its a relationship ...</td>
      <td>[]</td>
      <td>...</td>
      <td>['bbbut', 'its', 'not', 'a', 'religion', 'its'...</td>
      <td>['I', 'love', 'how', 'they', 'all', 'attack', ...</td>
      <td>['bbbut', 'its', 'not', 'a', 'religion', 'its'...</td>
      <td>['I', 'love', 'how', 'they', 'all', 'attack', ...</td>
      <td>[bbbut, not, religion, relationship, jesus]</td>
      <td>[love, attack, james, bringing, religion, orig...</td>
      <td>[0.07996249, 0.54515755, -0.95657, -0.61660004...</td>
      <td>[-1.4038038, 0.6155148, -2.6457813, -1.0246228...</td>
      <td>bbbut not religion relationship jesus</td>
      <td>love attack james bring religion original post...</td>
    </tr>
  </tbody>
</table>
<p>10 rows × 32 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-ff649141-3993-486d-a048-309131d5c842')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-ff649141-3993-486d-a048-309131d5c842 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-ff649141-3993-486d-a048-309131d5c842');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-16c74ba1-d96a-4696-ac9e-86fcad1bbc14">
  <button class="colab-df-quickchart" onclick="quickchart('df-16c74ba1-d96a-4696-ac9e-86fcad1bbc14')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-16c74ba1-d96a-4696-ac9e-86fcad1bbc14 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

    </div>
  </div>

</div>
</div>
<div class="cell markdown" id="O5Zcn8yV8a_O">
<p><strong>TF-IDF Vectorization</strong></p>
</div>
<div class="cell code" data-execution_count="42"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="VvzEhVz38a_O" data-outputId="a8f542d5-c55e-4082-f497-9779029f0f82">
<div class="sourceCode" id="cb46"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.feature_extraction.text <span class="im">import</span> TfidfVectorizer</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create TF-IDF vectorizer for &#39;lemma_comment&#39;</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>vectorizer_comment <span class="op">=</span> TfidfVectorizer()</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>TfIdfMatrix_comment <span class="op">=</span> vectorizer_comment.fit_transform(df[<span class="st">&quot;lemma_comment&quot;</span>])</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(TfIdfMatrix_comment)</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;----------------------------------------------------------&quot;</span>)</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Create TF-IDF vectorizer for &#39;lemma_parent_comment&#39;</span></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>vectorizer_parent_comment <span class="op">=</span> TfidfVectorizer()</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>TfIdfMatrix_parent_comment <span class="op">=</span> vectorizer_parent_comment.fit_transform(df[<span class="st">&quot;lemma_parent_comment&quot;</span>])</span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(TfIdfMatrix_parent_comment)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>  (0, 11424)	0.29569429011230725
  (0, 13357)	0.2628749512603334
  (0, 8853)	0.3186175798275102
  (0, 16772)	0.22647290627756295
  (0, 3719)	0.4470740090032808
  (0, 9530)	0.525449254209401
  (0, 447)	0.46333834189113804
  (1, 6454)	0.6038473386308716
  (1, 5168)	0.6621112940355313
  (1, 10619)	0.4438209390497568
  (2, 16751)	0.42101992157434837
  (2, 10074)	0.3426215007975448
  (2, 12321)	0.34386549091285235
  (2, 13105)	0.6621406521137182
  (2, 15035)	0.3855891775017169
  (3, 14238)	0.3642389607782723
  (3, 6254)	0.21491960808254493
  (3, 16634)	0.30392954078065093
  (3, 14062)	0.3821972387453312
  (3, 9263)	0.4934849644303099
  (3, 8743)	0.4738881686969988
  (3, 15097)	0.21247847060251343
  (3, 14421)	0.2635282516728596
  (4, 15837)	0.7501623274493927
  (4, 2959)	0.5091687997872849
  :	:
  (19993, 1426)	0.3012716739507617
  (19993, 13647)	0.2945435218670451
  (19993, 4425)	0.25448323129579453
  (19993, 1234)	0.2709925945536338
  (19993, 10361)	0.1070510621666488
  (19993, 13357)	0.18413257741675101
  (19994, 3640)	1.0
  (19995, 16103)	0.9902607925972851
  (19995, 16415)	0.1392248636005678
  (19996, 8845)	0.6332151897710931
  (19996, 8447)	0.574990995805324
  (19996, 16781)	0.5180963985456377
  (19997, 13935)	0.7791367520062499
  (19997, 16781)	0.6268539875227338
  (19998, 2149)	0.35492580002845686
  (19998, 14482)	0.3078368890218502
  (19998, 4036)	0.3392904878492974
  (19998, 7250)	0.3223711273628015
  (19998, 6477)	0.5316965405266454
  (19998, 14681)	0.20856526198367975
  (19998, 10548)	0.23625676578782878
  (19998, 6076)	0.3234222008078082
  (19998, 16905)	0.1762576716184043
  (19998, 12321)	0.20624335493483195
  (19999, 2307)	1.0
----------------------------------------------------------
  (0, 7436)	0.08861591182464497
  (0, 641)	0.1070918153855553
  (0, 17238)	0.08201151789608035
  (0, 20114)	0.075327756063272
  (0, 3641)	0.134633956984656
  (0, 25508)	0.06318703127564405
  (0, 13007)	0.062451226564635795
  (0, 14281)	0.17760288748535105
  (0, 22651)	0.17343876787158644
  (0, 412)	0.17760288748535105
  (0, 306)	0.13202583570095938
  (0, 10587)	0.11753490040858124
  (0, 7851)	0.11680299603605719
  (0, 25083)	0.075327756063272
  (0, 6543)	0.1283549915753947
  (0, 55)	0.10818984792463687
  (0, 20962)	0.11034545348022533
  (0, 6485)	0.15560780692298762
  (0, 15457)	0.07087048265836769
  (0, 87)	0.11791190655236879
  (0, 16055)	0.2053832889787305
  (0, 5589)	0.5464004296657755
  (0, 23619)	0.10273673273562936
  (0, 3393)	0.5631943821114628
  (0, 14484)	0.17343876787158644
  :	:
  (19996, 25217)	0.3071678668293727
  (19996, 7538)	0.41249540378335214
  (19996, 21158)	0.24058284577378344
  (19996, 2122)	0.2808365267600291
  (19996, 18327)	0.3148600155552659
  (19996, 25725)	0.22397059055774493
  (19996, 13007)	0.17344322787345295
  (19997, 16721)	0.4170591318042713
  (19997, 19413)	0.4038915113583075
  (19997, 24522)	0.43561785046945634
  (19997, 2374)	0.34655075620690395
  (19997, 19318)	0.33022523322820724
  (19997, 124)	0.35360645358197357
  (19997, 19882)	0.3449445762448204
  (19998, 9356)	0.3719087092045815
  (19998, 26)	0.3719087092045815
  (19998, 9803)	0.3808379259508358
  (19998, 2836)	0.3719087092045815
  (19998, 2959)	0.28869866738410754
  (19998, 11815)	0.34417202859775686
  (19998, 20656)	0.242784702421958
  (19998, 1803)	0.24310355328477426
  (19998, 3249)	0.2940420023814726
  (19998, 15306)	0.18359862711373776
  (19999, 3510)	1.0
</code></pre>
</div>
</div>
<div class="cell markdown" id="9HY3d9yL8a_m">
<p><strong>Concatinating GloVe Embedding Matrices and Tf-Idf Vectors
horizontaly to create single feature Matrices</strong></p>
</div>
<div class="cell code" data-execution_count="43"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="PRCW23GS8a_n" data-outputId="3a9f4119-91f6-43fc-d274-6010d442caa3">
<div class="sourceCode" id="cb48"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.sparse <span class="im">import</span> hstack, csr_matrix</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the GloVe embeddings to CSR matrices for lemma_comment</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>glove_embeddings_comment <span class="op">=</span> csr_matrix(np.vstack(df[<span class="st">&quot;glove_embedding&quot;</span>].values))</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>glove_embeddings_parent_comment <span class="op">=</span> csr_matrix(np.vstack(df[<span class="st">&quot;glove_parent_embedding&quot;</span>].values))</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine the TF-IDF matrix and the GloVe embeddings for lemma_comment horizontally</span></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>combined_matrix_comment <span class="op">=</span> hstack([TfIdfMatrix_comment, glove_embeddings_comment])</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine the TF-IDF matrix and the GloVe embeddings for lemma_parent_comment horizontally</span></span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>combined_matrix_parent_comment <span class="op">=</span> hstack([TfIdfMatrix_parent_comment, glove_embeddings_parent_comment])</span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the shapes of the matrices</span></span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Combined matrix for lemma_comment shape:&quot;</span>)</span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;TfIdfMatrix shape:&quot;</span>, TfIdfMatrix_comment.shape)</span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;GloVe embeddings after csr shape:&quot;</span>, glove_embeddings_comment.shape)</span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Combined matrix shape:&quot;</span>, combined_matrix_comment.shape)</span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Combined matrix for lemma_parent_comment shape:&quot;</span>)</span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;TfIdfMatrix shape:&quot;</span>, TfIdfMatrix_parent_comment.shape)</span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;GloVe embeddings after csr shape:&quot;</span>, glove_embeddings_parent_comment.shape)</span>
<span id="cb48-22"><a href="#cb48-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Combined matrix parent shape:&quot;</span>, combined_matrix_parent_comment.shape)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Combined matrix for lemma_comment shape:
TfIdfMatrix shape: (20000, 17081)
GloVe embeddings after csr shape: (20000, 300)
Combined matrix shape: (20000, 17381)

Combined matrix for lemma_parent_comment shape:
TfIdfMatrix shape: (20000, 25955)
GloVe embeddings after csr shape: (20000, 300)
Combined matrix parent shape: (20000, 26255)
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="44"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="FxYqVFst8a_n" data-outputId="59a4bddd-e083-4d1f-f1ae-05995af5ca05">
<div class="sourceCode" id="cb50"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(combined_matrix_comment)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;---------------------------------------------------&quot;</span>)</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(combined_matrix_parent_comment)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>  (0, 11424)	0.29569429011230725
  (0, 13357)	0.2628749512603334
  (0, 8853)	0.3186175798275102
  (0, 16772)	0.22647290627756295
  (0, 3719)	0.4470740090032808
  (0, 9530)	0.525449254209401
  (0, 447)	0.46333834189113804
  (0, 17081)	-1.8146748542785645
  (0, 17082)	0.3244999647140503
  (0, 17083)	-2.50362229347229
  (0, 17084)	-0.19160008430480957
  (0, 17085)	0.6192887425422668
  (0, 17086)	2.3693251609802246
  (0, 17087)	3.4971375465393066
  (0, 17088)	3.3420748710632324
  (0, 17089)	-4.125450134277344
  (0, 17090)	0.21255004405975342
  (0, 17091)	4.946374893188477
  (0, 17092)	0.690125048160553
  (0, 17093)	-6.565799713134766
  (0, 17094)	0.7198699712753296
  (0, 17095)	3.3723249435424805
  (0, 17096)	-2.484457492828369
  (0, 17097)	0.8031384944915771
  (0, 17098)	1.3056700229644775
  :	:
  (19999, 17356)	-2.453700065612793
  (19999, 17357)	-2.183199882507324
  (19999, 17358)	1.5292999744415283
  (19999, 17359)	-1.9414000511169434
  (19999, 17360)	-0.08867499977350235
  (19999, 17361)	-1.1825000047683716
  (19999, 17362)	-3.9995999336242676
  (19999, 17363)	2.8076999187469482
  (19999, 17364)	-1.7999999523162842
  (19999, 17365)	4.254499912261963
  (19999, 17366)	-1.3812999725341797
  (19999, 17367)	-2.292099952697754
  (19999, 17368)	3.7888998985290527
  (19999, 17369)	-1.5836999416351318
  (19999, 17370)	-0.7207800149917603
  (19999, 17371)	4.7743000984191895
  (19999, 17372)	-3.0922999382019043
  (19999, 17373)	8.47089958190918
  (19999, 17374)	0.30131998658180237
  (19999, 17375)	-5.617300033569336
  (19999, 17376)	-0.5461000204086304
  (19999, 17377)	-4.845900058746338
  (19999, 17378)	6.030300140380859
  (19999, 17379)	-6.966400146484375
  (19999, 17380)	3.1445000171661377
---------------------------------------------------
  (0, 7436)	0.08861591182464497
  (0, 641)	0.1070918153855553
  (0, 17238)	0.08201151789608035
  (0, 20114)	0.075327756063272
  (0, 3641)	0.134633956984656
  (0, 25508)	0.06318703127564405
  (0, 13007)	0.062451226564635795
  (0, 14281)	0.17760288748535105
  (0, 22651)	0.17343876787158644
  (0, 412)	0.17760288748535105
  (0, 306)	0.13202583570095938
  (0, 10587)	0.11753490040858124
  (0, 7851)	0.11680299603605719
  (0, 25083)	0.075327756063272
  (0, 6543)	0.1283549915753947
  (0, 55)	0.10818984792463687
  (0, 20962)	0.11034545348022533
  (0, 6485)	0.15560780692298762
  (0, 15457)	0.07087048265836769
  (0, 87)	0.11791190655236879
  (0, 16055)	0.2053832889787305
  (0, 5589)	0.5464004296657755
  (0, 23619)	0.10273673273562936
  (0, 3393)	0.5631943821114628
  (0, 14484)	0.17343876787158644
  :	:
  (19999, 26230)	-2.453700065612793
  (19999, 26231)	-2.183199882507324
  (19999, 26232)	1.5292999744415283
  (19999, 26233)	-1.9414000511169434
  (19999, 26234)	-0.08867499977350235
  (19999, 26235)	-1.1825000047683716
  (19999, 26236)	-3.9995999336242676
  (19999, 26237)	2.8076999187469482
  (19999, 26238)	-1.7999999523162842
  (19999, 26239)	4.254499912261963
  (19999, 26240)	-1.3812999725341797
  (19999, 26241)	-2.292099952697754
  (19999, 26242)	3.7888998985290527
  (19999, 26243)	-1.5836999416351318
  (19999, 26244)	-0.7207800149917603
  (19999, 26245)	4.7743000984191895
  (19999, 26246)	-3.0922999382019043
  (19999, 26247)	8.47089958190918
  (19999, 26248)	0.30131998658180237
  (19999, 26249)	-5.617300033569336
  (19999, 26250)	-0.5461000204086304
  (19999, 26251)	-4.845900058746338
  (19999, 26252)	6.030300140380859
  (19999, 26253)	-6.966400146484375
  (19999, 26254)	3.1445000171661377
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="45" id="mLgLTqEUkFdb">
<div class="sourceCode" id="cb52"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine the TF-IDF matrix and the GloVe embeddings for lemma_comment and lemma_parent_comment horizontally</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>combined_matrix_combined <span class="op">=</span> hstack([combined_matrix_comment, combined_matrix_parent_comment])</span></code></pre></div>
</div>
<section id="lstm-model" class="cell markdown" id="7fr5UJRgrqeO">
<h1>LSTM Model</h1>
</section>
<div class="cell code" data-execution_count="46"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="JH8lGNNVr6lF" data-outputId="c1b29489-7865-44d2-c8a4-930adf396f5e">
<div class="sourceCode" id="cb53"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.models <span class="im">import</span> Sequential</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.layers <span class="im">import</span> LSTM, Dense</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split, GridSearchCV, KFold</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.callbacks <span class="im">import</span> EarlyStopping</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.base <span class="im">import</span> BaseEstimator, ClassifierMixin</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a><span class="co"># &#39;labels&#39; is a binary column indicating sarcasm (1) or not sarcasm (0)</span></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> combined_matrix_combined</span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> df[<span class="st">&quot;label&quot;</span>]</span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Split the data into training and testing sets</span></span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X, y, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert sparse matrix to dense array</span></span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a>X_train_dense <span class="op">=</span> X_train.toarray()</span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a>X_test_dense <span class="op">=</span> X_test.toarray()</span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-19"><a href="#cb53-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Reshape input data to be 3-dimensional for LSTM</span></span>
<span id="cb53-20"><a href="#cb53-20" aria-hidden="true" tabindex="-1"></a>X_train_reshaped <span class="op">=</span> X_train_dense.reshape(X_train_dense.shape[<span class="dv">0</span>], <span class="dv">1</span>, X_train_dense.shape[<span class="dv">1</span>])</span>
<span id="cb53-21"><a href="#cb53-21" aria-hidden="true" tabindex="-1"></a>X_test_reshaped <span class="op">=</span> X_test_dense.reshape(X_test_dense.shape[<span class="dv">0</span>], <span class="dv">1</span>, X_test_dense.shape[<span class="dv">1</span>])</span>
<span id="cb53-22"><a href="#cb53-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-23"><a href="#cb53-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the custom LSTM classifier</span></span>
<span id="cb53-24"><a href="#cb53-24" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> CustomLSTMClassifier(BaseEstimator, ClassifierMixin):</span>
<span id="cb53-25"><a href="#cb53-25" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, epochs<span class="op">=</span><span class="dv">20</span>):</span>
<span id="cb53-26"><a href="#cb53-26" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.epochs <span class="op">=</span> epochs</span>
<span id="cb53-27"><a href="#cb53-27" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.model <span class="op">=</span> <span class="va">self</span>.create_model()</span>
<span id="cb53-28"><a href="#cb53-28" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.input_layer <span class="op">=</span> <span class="va">self</span>.model.<span class="bu">input</span></span>
<span id="cb53-29"><a href="#cb53-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-30"><a href="#cb53-30" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> create_model(<span class="va">self</span>):</span>
<span id="cb53-31"><a href="#cb53-31" aria-hidden="true" tabindex="-1"></a>        model <span class="op">=</span> Sequential([</span>
<span id="cb53-32"><a href="#cb53-32" aria-hidden="true" tabindex="-1"></a>            LSTM(<span class="dv">64</span>, input_shape<span class="op">=</span>(<span class="dv">1</span>, X_train_dense.shape[<span class="dv">1</span>])),</span>
<span id="cb53-33"><a href="#cb53-33" aria-hidden="true" tabindex="-1"></a>            Dense(<span class="dv">1</span>, activation<span class="op">=</span><span class="st">&#39;sigmoid&#39;</span>)</span>
<span id="cb53-34"><a href="#cb53-34" aria-hidden="true" tabindex="-1"></a>        ])</span>
<span id="cb53-35"><a href="#cb53-35" aria-hidden="true" tabindex="-1"></a>        model.<span class="bu">compile</span>(optimizer<span class="op">=</span><span class="st">&#39;adam&#39;</span>, loss<span class="op">=</span><span class="st">&#39;binary_crossentropy&#39;</span>, metrics<span class="op">=</span>[<span class="st">&#39;accuracy&#39;</span>])</span>
<span id="cb53-36"><a href="#cb53-36" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> model</span>
<span id="cb53-37"><a href="#cb53-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-38"><a href="#cb53-38" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> fit(<span class="va">self</span>, X, y):</span>
<span id="cb53-39"><a href="#cb53-39" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.model.fit(X, y, epochs<span class="op">=</span><span class="va">self</span>.epochs, callbacks<span class="op">=</span>[EarlyStopping(patience<span class="op">=</span><span class="dv">3</span>)])</span>
<span id="cb53-40"><a href="#cb53-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-41"><a href="#cb53-41" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> predict(<span class="va">self</span>, X):</span>
<span id="cb53-42"><a href="#cb53-42" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> (<span class="va">self</span>.model.predict(X) <span class="op">&gt;</span> <span class="fl">0.5</span>).astype(<span class="st">&quot;int32&quot;</span>)</span>
<span id="cb53-43"><a href="#cb53-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-44"><a href="#cb53-44" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> extract_features(<span class="va">self</span>, X):</span>
<span id="cb53-45"><a href="#cb53-45" aria-hidden="true" tabindex="-1"></a>        feature_extractor <span class="op">=</span> Model(inputs<span class="op">=</span><span class="va">self</span>.model.<span class="bu">input</span>, outputs<span class="op">=</span><span class="va">self</span>.model.layers[<span class="dv">0</span>].output)</span>
<span id="cb53-46"><a href="#cb53-46" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> feature_extractor.predict(X)</span>
<span id="cb53-47"><a href="#cb53-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-48"><a href="#cb53-48" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> get_params(<span class="va">self</span>, deep<span class="op">=</span><span class="va">True</span>):</span>
<span id="cb53-49"><a href="#cb53-49" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {<span class="st">&#39;epochs&#39;</span>: <span class="va">self</span>.epochs}</span>
<span id="cb53-50"><a href="#cb53-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-51"><a href="#cb53-51" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> set_params(<span class="va">self</span>, <span class="op">**</span>params):</span>
<span id="cb53-52"><a href="#cb53-52" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.epochs <span class="op">=</span> params[<span class="st">&#39;epochs&#39;</span>]</span>
<span id="cb53-53"><a href="#cb53-53" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.model <span class="op">=</span> <span class="va">self</span>.create_model()</span>
<span id="cb53-54"><a href="#cb53-54" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span></span>
<span id="cb53-55"><a href="#cb53-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-56"><a href="#cb53-56" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the hyperparameters to search over</span></span>
<span id="cb53-57"><a href="#cb53-57" aria-hidden="true" tabindex="-1"></a>param_grid <span class="op">=</span> {</span>
<span id="cb53-58"><a href="#cb53-58" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;epochs&#39;</span>: [<span class="dv">20</span>, <span class="dv">50</span>]</span>
<span id="cb53-59"><a href="#cb53-59" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb53-60"><a href="#cb53-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-61"><a href="#cb53-61" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply GridSearchCV with 5-fold cross-validation</span></span>
<span id="cb53-62"><a href="#cb53-62" aria-hidden="true" tabindex="-1"></a>kf <span class="op">=</span> KFold(n_splits<span class="op">=</span><span class="dv">5</span>, shuffle<span class="op">=</span><span class="va">True</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb53-63"><a href="#cb53-63" aria-hidden="true" tabindex="-1"></a>grid_search <span class="op">=</span> GridSearchCV(estimator<span class="op">=</span>CustomLSTMClassifier(), param_grid<span class="op">=</span>param_grid, cv<span class="op">=</span>kf, verbose<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb53-64"><a href="#cb53-64" aria-hidden="true" tabindex="-1"></a>grid_search_result <span class="op">=</span> grid_search.fit(X_train_reshaped, y_train)</span>
<span id="cb53-65"><a href="#cb53-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-66"><a href="#cb53-66" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the best parameters found by GridSearchCV</span></span>
<span id="cb53-67"><a href="#cb53-67" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Best Parameters:&quot;</span>, grid_search_result.best_params_)</span>
<span id="cb53-68"><a href="#cb53-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-69"><a href="#cb53-69" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the best estimator from GridSearchCV to make predictions</span></span>
<span id="cb53-70"><a href="#cb53-70" aria-hidden="true" tabindex="-1"></a>best_lstm_model <span class="op">=</span> grid_search_result.best_estimator_</span>
<span id="cb53-71"><a href="#cb53-71" aria-hidden="true" tabindex="-1"></a>y_train_lstm_pred <span class="op">=</span> best_lstm_model.predict(X_train_reshaped)</span>
<span id="cb53-72"><a href="#cb53-72" aria-hidden="true" tabindex="-1"></a>y_test_lstm_pred <span class="op">=</span> best_lstm_model.predict(X_test_reshaped)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Fitting 5 folds for each of 2 candidates, totalling 10 fits
Epoch 1/20
394/400 [============================&gt;.] - ETA: 0s - loss: 0.6697 - accuracy: 0.5873</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 4s 4ms/step - loss: 0.6699 - accuracy: 0.5877
Epoch 2/20
392/400 [============================&gt;.] - ETA: 0s - loss: 0.6307 - accuracy: 0.6437</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.6307 - accuracy: 0.6438
Epoch 3/20
393/400 [============================&gt;.] - ETA: 0s - loss: 0.5949 - accuracy: 0.6799</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.5948 - accuracy: 0.6802
Epoch 4/20
393/400 [============================&gt;.] - ETA: 0s - loss: 0.5514 - accuracy: 0.7189</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.5516 - accuracy: 0.7188
Epoch 5/20
397/400 [============================&gt;.] - ETA: 0s - loss: 0.4962 - accuracy: 0.7620</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.4968 - accuracy: 0.7619
Epoch 6/20
395/400 [============================&gt;.] - ETA: 0s - loss: 0.4324 - accuracy: 0.8119</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.4329 - accuracy: 0.8120
Epoch 7/20
396/400 [============================&gt;.] - ETA: 0s - loss: 0.3633 - accuracy: 0.8540</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.3634 - accuracy: 0.8535
Epoch 8/20
393/400 [============================&gt;.] - ETA: 0s - loss: 0.2913 - accuracy: 0.8979</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.2916 - accuracy: 0.8975
Epoch 9/20
391/400 [============================&gt;.] - ETA: 0s - loss: 0.2280 - accuracy: 0.9281</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.2284 - accuracy: 0.9276
Epoch 10/20
392/400 [============================&gt;.] - ETA: 0s - loss: 0.1680 - accuracy: 0.9582</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.1684 - accuracy: 0.9581
Epoch 11/20
391/400 [============================&gt;.] - ETA: 0s - loss: 0.1190 - accuracy: 0.9770</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.1188 - accuracy: 0.9769
Epoch 12/20
394/400 [============================&gt;.] - ETA: 0s - loss: 0.0797 - accuracy: 0.9895</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0796 - accuracy: 0.9895
Epoch 13/20
390/400 [============================&gt;.] - ETA: 0s - loss: 0.0614 - accuracy: 0.9921</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0617 - accuracy: 0.9918
Epoch 14/20
394/400 [============================&gt;.] - ETA: 0s - loss: 0.0444 - accuracy: 0.9954</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0444 - accuracy: 0.9955
Epoch 15/20
397/400 [============================&gt;.] - ETA: 0s - loss: 0.0293 - accuracy: 0.9974</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0293 - accuracy: 0.9974
Epoch 16/20
392/400 [============================&gt;.] - ETA: 0s - loss: 0.0249 - accuracy: 0.9974</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0256 - accuracy: 0.9973
Epoch 17/20
393/400 [============================&gt;.] - ETA: 0s - loss: 0.0273 - accuracy: 0.9963</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0275 - accuracy: 0.9962
Epoch 18/20
395/400 [============================&gt;.] - ETA: 0s - loss: 0.0341 - accuracy: 0.9944</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0344 - accuracy: 0.9944
Epoch 19/20
397/400 [============================&gt;.] - ETA: 0s - loss: 0.0481 - accuracy: 0.9880</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0486 - accuracy: 0.9877
Epoch 20/20
397/400 [============================&gt;.] - ETA: 0s - loss: 0.0369 - accuracy: 0.9921</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0368 - accuracy: 0.9922
100/100 [==============================] - 1s 3ms/step
[CV] END ..........................................epochs=20; total time=  47.1s
Epoch 1/20
392/400 [============================&gt;.] - ETA: 0s - loss: 0.6687 - accuracy: 0.5910</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 3s 4ms/step - loss: 0.6686 - accuracy: 0.5910
Epoch 2/20
395/400 [============================&gt;.] - ETA: 0s - loss: 0.6286 - accuracy: 0.6436</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.6289 - accuracy: 0.6430
Epoch 3/20
394/400 [============================&gt;.] - ETA: 0s - loss: 0.5941 - accuracy: 0.6826</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.5935 - accuracy: 0.6832
Epoch 4/20
390/400 [============================&gt;.] - ETA: 0s - loss: 0.5492 - accuracy: 0.7223</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.5495 - accuracy: 0.7223
Epoch 5/20
398/400 [============================&gt;.] - ETA: 0s - loss: 0.4976 - accuracy: 0.7630</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.4976 - accuracy: 0.7630
Epoch 6/20
397/400 [============================&gt;.] - ETA: 0s - loss: 0.4310 - accuracy: 0.8116</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.4310 - accuracy: 0.8116
Epoch 7/20
390/400 [============================&gt;.] - ETA: 0s - loss: 0.3596 - accuracy: 0.8582</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.3590 - accuracy: 0.8581
Epoch 8/20
391/400 [============================&gt;.] - ETA: 0s - loss: 0.2859 - accuracy: 0.8989</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.2857 - accuracy: 0.8988
Epoch 9/20
400/400 [==============================] - ETA: 0s - loss: 0.2168 - accuracy: 0.9341</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.2168 - accuracy: 0.9341
Epoch 10/20
394/400 [============================&gt;.] - ETA: 0s - loss: 0.1609 - accuracy: 0.9588</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.1613 - accuracy: 0.9588
Epoch 11/20
391/400 [============================&gt;.] - ETA: 0s - loss: 0.1174 - accuracy: 0.9743</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.1178 - accuracy: 0.9743
Epoch 12/20
400/400 [==============================] - ETA: 0s - loss: 0.0858 - accuracy: 0.9843</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0858 - accuracy: 0.9843
Epoch 13/20
397/400 [============================&gt;.] - ETA: 0s - loss: 0.0571 - accuracy: 0.9930</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0572 - accuracy: 0.9930
Epoch 14/20
395/400 [============================&gt;.] - ETA: 0s - loss: 0.0437 - accuracy: 0.9946</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0437 - accuracy: 0.9947
Epoch 15/20
390/400 [============================&gt;.] - ETA: 0s - loss: 0.0310 - accuracy: 0.9964</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0315 - accuracy: 0.9962
Epoch 16/20
392/400 [============================&gt;.] - ETA: 0s - loss: 0.0317 - accuracy: 0.9951</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0318 - accuracy: 0.9952
Epoch 17/20
397/400 [============================&gt;.] - ETA: 0s - loss: 0.0185 - accuracy: 0.9982</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0185 - accuracy: 0.9982
Epoch 18/20
392/400 [============================&gt;.] - ETA: 0s - loss: 0.0152 - accuracy: 0.9976</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0155 - accuracy: 0.9976
Epoch 19/20
400/400 [==============================] - ETA: 0s - loss: 0.0667 - accuracy: 0.9799</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0667 - accuracy: 0.9799
Epoch 20/20
395/400 [============================&gt;.] - ETA: 0s - loss: 0.0567 - accuracy: 0.9844</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0562 - accuracy: 0.9845
100/100 [==============================] - 1s 3ms/step
[CV] END ..........................................epochs=20; total time=  45.1s
Epoch 1/20
395/400 [============================&gt;.] - ETA: 0s - loss: 0.6701 - accuracy: 0.5812</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 3s 4ms/step - loss: 0.6696 - accuracy: 0.5820
Epoch 2/20
393/400 [============================&gt;.] - ETA: 0s - loss: 0.6240 - accuracy: 0.6468</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.6239 - accuracy: 0.6466
Epoch 3/20
395/400 [============================&gt;.] - ETA: 0s - loss: 0.5842 - accuracy: 0.6878</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.5843 - accuracy: 0.6877
Epoch 4/20
397/400 [============================&gt;.] - ETA: 0s - loss: 0.5340 - accuracy: 0.7315</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.5343 - accuracy: 0.7312
Epoch 5/20
395/400 [============================&gt;.] - ETA: 0s - loss: 0.4751 - accuracy: 0.7802</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.4747 - accuracy: 0.7806
Epoch 6/20
400/400 [==============================] - ETA: 0s - loss: 0.4047 - accuracy: 0.8291</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.4047 - accuracy: 0.8291
Epoch 7/20
390/400 [============================&gt;.] - ETA: 0s - loss: 0.3309 - accuracy: 0.8736</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.3311 - accuracy: 0.8735
Epoch 8/20
395/400 [============================&gt;.] - ETA: 0s - loss: 0.2527 - accuracy: 0.9190</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.2526 - accuracy: 0.9189
Epoch 9/20
393/400 [============================&gt;.] - ETA: 0s - loss: 0.1887 - accuracy: 0.9469</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.1892 - accuracy: 0.9469
Epoch 10/20
394/400 [============================&gt;.] - ETA: 0s - loss: 0.1363 - accuracy: 0.9684</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.1364 - accuracy: 0.9684
Epoch 11/20
394/400 [============================&gt;.] - ETA: 0s - loss: 0.0891 - accuracy: 0.9859</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0893 - accuracy: 0.9859
Epoch 12/20
396/400 [============================&gt;.] - ETA: 0s - loss: 0.0597 - accuracy: 0.9932</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0598 - accuracy: 0.9933
Epoch 13/20
399/400 [============================&gt;.] - ETA: 0s - loss: 0.0423 - accuracy: 0.9958</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0423 - accuracy: 0.9958
Epoch 14/20
395/400 [============================&gt;.] - ETA: 0s - loss: 0.0329 - accuracy: 0.9963</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0328 - accuracy: 0.9963
Epoch 15/20
395/400 [============================&gt;.] - ETA: 0s - loss: 0.0282 - accuracy: 0.9969</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0281 - accuracy: 0.9970
Epoch 16/20
391/400 [============================&gt;.] - ETA: 0s - loss: 0.0291 - accuracy: 0.9956</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0295 - accuracy: 0.9955
Epoch 17/20
396/400 [============================&gt;.] - ETA: 0s - loss: 0.0361 - accuracy: 0.9931</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0363 - accuracy: 0.9931
Epoch 18/20
395/400 [============================&gt;.] - ETA: 0s - loss: 0.0399 - accuracy: 0.9910</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0397 - accuracy: 0.9911
Epoch 19/20
394/400 [============================&gt;.] - ETA: 0s - loss: 0.0227 - accuracy: 0.9960</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0230 - accuracy: 0.9957
Epoch 20/20
390/400 [============================&gt;.] - ETA: 0s - loss: 0.0195 - accuracy: 0.9967</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0194 - accuracy: 0.9967
100/100 [==============================] - 1s 3ms/step
[CV] END ..........................................epochs=20; total time=  45.0s
Epoch 1/20
390/400 [============================&gt;.] - ETA: 0s - loss: 0.6697 - accuracy: 0.5847</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 4s 5ms/step - loss: 0.6686 - accuracy: 0.5856
Epoch 2/20
394/400 [============================&gt;.] - ETA: 0s - loss: 0.6244 - accuracy: 0.6465</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.6241 - accuracy: 0.6465
Epoch 3/20
392/400 [============================&gt;.] - ETA: 0s - loss: 0.5841 - accuracy: 0.6906</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.5844 - accuracy: 0.6895
Epoch 4/20
393/400 [============================&gt;.] - ETA: 0s - loss: 0.5381 - accuracy: 0.7273</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.5384 - accuracy: 0.7273
Epoch 5/20
392/400 [============================&gt;.] - ETA: 0s - loss: 0.4850 - accuracy: 0.7730</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.4852 - accuracy: 0.7726
Epoch 6/20
391/400 [============================&gt;.] - ETA: 0s - loss: 0.4169 - accuracy: 0.8192</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.4176 - accuracy: 0.8188
Epoch 7/20
391/400 [============================&gt;.] - ETA: 0s - loss: 0.3395 - accuracy: 0.8692</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.3398 - accuracy: 0.8692
Epoch 8/20
395/400 [============================&gt;.] - ETA: 0s - loss: 0.2691 - accuracy: 0.9091</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 5ms/step - loss: 0.2687 - accuracy: 0.9095
Epoch 9/20
390/400 [============================&gt;.] - ETA: 0s - loss: 0.1973 - accuracy: 0.9458</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.1978 - accuracy: 0.9452
Epoch 10/20
391/400 [============================&gt;.] - ETA: 0s - loss: 0.1429 - accuracy: 0.9664</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.1440 - accuracy: 0.9657
Epoch 11/20
390/400 [============================&gt;.] - ETA: 0s - loss: 0.0999 - accuracy: 0.9834</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.1005 - accuracy: 0.9830
Epoch 12/20
396/400 [============================&gt;.] - ETA: 0s - loss: 0.0758 - accuracy: 0.9878</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 5ms/step - loss: 0.0758 - accuracy: 0.9879
Epoch 13/20
390/400 [============================&gt;.] - ETA: 0s - loss: 0.0536 - accuracy: 0.9926</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0534 - accuracy: 0.9927
Epoch 14/20
391/400 [============================&gt;.] - ETA: 0s - loss: 0.0360 - accuracy: 0.9968</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0362 - accuracy: 0.9968
Epoch 15/20
399/400 [============================&gt;.] - ETA: 0s - loss: 0.0302 - accuracy: 0.9966</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0302 - accuracy: 0.9966
Epoch 16/20
393/400 [============================&gt;.] - ETA: 0s - loss: 0.0270 - accuracy: 0.9962</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0272 - accuracy: 0.9961
Epoch 17/20
394/400 [============================&gt;.] - ETA: 0s - loss: 0.0272 - accuracy: 0.9955</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0276 - accuracy: 0.9954
Epoch 18/20
396/400 [============================&gt;.] - ETA: 0s - loss: 0.0276 - accuracy: 0.9960</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0277 - accuracy: 0.9959
Epoch 19/20
392/400 [============================&gt;.] - ETA: 0s - loss: 0.0236 - accuracy: 0.9959</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0237 - accuracy: 0.9959
Epoch 20/20
397/400 [============================&gt;.] - ETA: 0s - loss: 0.0322 - accuracy: 0.9921</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0323 - accuracy: 0.9921
100/100 [==============================] - 1s 3ms/step
[CV] END ..........................................epochs=20; total time=  45.4s
Epoch 1/20
389/400 [============================&gt;.] - ETA: 0s - loss: 0.6694 - accuracy: 0.5890</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 3s 4ms/step - loss: 0.6690 - accuracy: 0.5902
Epoch 2/20
400/400 [==============================] - ETA: 0s - loss: 0.6276 - accuracy: 0.6416</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.6276 - accuracy: 0.6416
Epoch 3/20
399/400 [============================&gt;.] - ETA: 0s - loss: 0.5906 - accuracy: 0.6835</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.5907 - accuracy: 0.6836
Epoch 4/20
396/400 [============================&gt;.] - ETA: 0s - loss: 0.5434 - accuracy: 0.7243</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.5432 - accuracy: 0.7246
Epoch 5/20
393/400 [============================&gt;.] - ETA: 0s - loss: 0.4847 - accuracy: 0.7742</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.4852 - accuracy: 0.7729
Epoch 6/20
394/400 [============================&gt;.] - ETA: 0s - loss: 0.4173 - accuracy: 0.8186</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.4180 - accuracy: 0.8180
Epoch 7/20
394/400 [============================&gt;.] - ETA: 0s - loss: 0.3397 - accuracy: 0.8695</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.3393 - accuracy: 0.8698
Epoch 8/20
393/400 [============================&gt;.] - ETA: 0s - loss: 0.2638 - accuracy: 0.9121</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.2640 - accuracy: 0.9117
Epoch 9/20
399/400 [============================&gt;.] - ETA: 0s - loss: 0.1986 - accuracy: 0.9438</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 5ms/step - loss: 0.1985 - accuracy: 0.9438
Epoch 10/20
392/400 [============================&gt;.] - ETA: 0s - loss: 0.1370 - accuracy: 0.9691</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.1371 - accuracy: 0.9691
Epoch 11/20
393/400 [============================&gt;.] - ETA: 0s - loss: 0.0910 - accuracy: 0.9868</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0914 - accuracy: 0.9868
Epoch 12/20
389/400 [============================&gt;.] - ETA: 0s - loss: 0.0604 - accuracy: 0.9933</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0604 - accuracy: 0.9933
Epoch 13/20
400/400 [==============================] - ETA: 0s - loss: 0.0488 - accuracy: 0.9941</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0488 - accuracy: 0.9941
Epoch 14/20
394/400 [============================&gt;.] - ETA: 0s - loss: 0.0370 - accuracy: 0.9957</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0371 - accuracy: 0.9957
Epoch 15/20
393/400 [============================&gt;.] - ETA: 0s - loss: 0.0261 - accuracy: 0.9971</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0262 - accuracy: 0.9970
Epoch 16/20
397/400 [============================&gt;.] - ETA: 0s - loss: 0.0275 - accuracy: 0.9957</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 5ms/step - loss: 0.0278 - accuracy: 0.9956
Epoch 17/20
394/400 [============================&gt;.] - ETA: 0s - loss: 0.0255 - accuracy: 0.9962</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0254 - accuracy: 0.9962
Epoch 18/20
400/400 [==============================] - ETA: 0s - loss: 0.0304 - accuracy: 0.9948</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0304 - accuracy: 0.9948
Epoch 19/20
397/400 [============================&gt;.] - ETA: 0s - loss: 0.0502 - accuracy: 0.9867</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0502 - accuracy: 0.9868
Epoch 20/20
395/400 [============================&gt;.] - ETA: 0s - loss: 0.0245 - accuracy: 0.9956</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0246 - accuracy: 0.9955
100/100 [==============================] - 1s 3ms/step
[CV] END ..........................................epochs=20; total time=  44.8s
Epoch 1/50
391/400 [============================&gt;.] - ETA: 0s - loss: 0.6719 - accuracy: 0.5840</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 3s 4ms/step - loss: 0.6715 - accuracy: 0.5851
Epoch 2/50
395/400 [============================&gt;.] - ETA: 0s - loss: 0.6258 - accuracy: 0.6459</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.6262 - accuracy: 0.6459
Epoch 3/50
389/400 [============================&gt;.] - ETA: 0s - loss: 0.5875 - accuracy: 0.6888</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.5873 - accuracy: 0.6888
Epoch 4/50
399/400 [============================&gt;.] - ETA: 0s - loss: 0.5403 - accuracy: 0.7278</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.5404 - accuracy: 0.7278
Epoch 5/50
389/400 [============================&gt;.] - ETA: 0s - loss: 0.4788 - accuracy: 0.7811</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.4799 - accuracy: 0.7798
Epoch 6/50
391/400 [============================&gt;.] - ETA: 0s - loss: 0.4133 - accuracy: 0.8191</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.4144 - accuracy: 0.8185
Epoch 7/50
392/400 [============================&gt;.] - ETA: 0s - loss: 0.3396 - accuracy: 0.8660</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.3402 - accuracy: 0.8659
Epoch 8/50
394/400 [============================&gt;.] - ETA: 0s - loss: 0.2632 - accuracy: 0.9122</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.2629 - accuracy: 0.9123
Epoch 9/50
391/400 [============================&gt;.] - ETA: 0s - loss: 0.1959 - accuracy: 0.9425</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.1965 - accuracy: 0.9426
Epoch 10/50
393/400 [============================&gt;.] - ETA: 0s - loss: 0.1382 - accuracy: 0.9692</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.1381 - accuracy: 0.9690
Epoch 11/50
391/400 [============================&gt;.] - ETA: 0s - loss: 0.0952 - accuracy: 0.9833</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0960 - accuracy: 0.9828
Epoch 12/50
391/400 [============================&gt;.] - ETA: 0s - loss: 0.0694 - accuracy: 0.9899</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0694 - accuracy: 0.9899
Epoch 13/50
397/400 [============================&gt;.] - ETA: 0s - loss: 0.0487 - accuracy: 0.9937</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0487 - accuracy: 0.9937
Epoch 14/50
396/400 [============================&gt;.] - ETA: 0s - loss: 0.0339 - accuracy: 0.9963</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0339 - accuracy: 0.9963
Epoch 15/50
392/400 [============================&gt;.] - ETA: 0s - loss: 0.0336 - accuracy: 0.9947</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0339 - accuracy: 0.9945
Epoch 16/50
393/400 [============================&gt;.] - ETA: 0s - loss: 0.0321 - accuracy: 0.9957</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0320 - accuracy: 0.9958
Epoch 17/50
393/400 [============================&gt;.] - ETA: 0s - loss: 0.0198 - accuracy: 0.9977</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0198 - accuracy: 0.9977
Epoch 18/50
397/400 [============================&gt;.] - ETA: 0s - loss: 0.0182 - accuracy: 0.9967</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0183 - accuracy: 0.9967
Epoch 19/50
393/400 [============================&gt;.] - ETA: 0s - loss: 0.0514 - accuracy: 0.9839</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0528 - accuracy: 0.9832
Epoch 20/50
389/400 [============================&gt;.] - ETA: 0s - loss: 0.0884 - accuracy: 0.9700</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0888 - accuracy: 0.9701
Epoch 21/50
399/400 [============================&gt;.] - ETA: 0s - loss: 0.0292 - accuracy: 0.9944</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0292 - accuracy: 0.9945
Epoch 22/50
389/400 [============================&gt;.] - ETA: 0s - loss: 0.0117 - accuracy: 0.9982</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0116 - accuracy: 0.9983
Epoch 23/50
390/400 [============================&gt;.] - ETA: 0s - loss: 0.0062 - accuracy: 0.9989</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0061 - accuracy: 0.9989
Epoch 24/50
397/400 [============================&gt;.] - ETA: 0s - loss: 0.0065 - accuracy: 0.9988</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0065 - accuracy: 0.9988
Epoch 25/50
389/400 [============================&gt;.] - ETA: 0s - loss: 0.0146 - accuracy: 0.9965</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 5ms/step - loss: 0.0148 - accuracy: 0.9964
Epoch 26/50
399/400 [============================&gt;.] - ETA: 0s - loss: 0.0222 - accuracy: 0.9948</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0223 - accuracy: 0.9947
Epoch 27/50
389/400 [============================&gt;.] - ETA: 0s - loss: 0.0676 - accuracy: 0.9777</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0668 - accuracy: 0.9778
Epoch 28/50
393/400 [============================&gt;.] - ETA: 0s - loss: 0.0154 - accuracy: 0.9973</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0153 - accuracy: 0.9973
Epoch 29/50
395/400 [============================&gt;.] - ETA: 0s - loss: 0.0074 - accuracy: 0.9986</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0074 - accuracy: 0.9986
Epoch 30/50
396/400 [============================&gt;.] - ETA: 0s - loss: 0.0044 - accuracy: 0.9991</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0044 - accuracy: 0.9991
Epoch 31/50
393/400 [============================&gt;.] - ETA: 0s - loss: 0.0056 - accuracy: 0.9987</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0056 - accuracy: 0.9987
Epoch 32/50
400/400 [==============================] - ETA: 0s - loss: 0.0024 - accuracy: 0.9998</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0024 - accuracy: 0.9998
Epoch 33/50
393/400 [============================&gt;.] - ETA: 0s - loss: 0.0052 - accuracy: 0.9991</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0054 - accuracy: 0.9991
Epoch 34/50
395/400 [============================&gt;.] - ETA: 0s - loss: 0.1365 - accuracy: 0.9461</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.1359 - accuracy: 0.9466
Epoch 35/50
392/400 [============================&gt;.] - ETA: 0s - loss: 0.0456 - accuracy: 0.9861</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0453 - accuracy: 0.9861
Epoch 36/50
391/400 [============================&gt;.] - ETA: 0s - loss: 0.0139 - accuracy: 0.9972</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0138 - accuracy: 0.9973
Epoch 37/50
393/400 [============================&gt;.] - ETA: 0s - loss: 0.0047 - accuracy: 0.9997</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0047 - accuracy: 0.9997
Epoch 38/50
400/400 [==============================] - ETA: 0s - loss: 0.0028 - accuracy: 0.9996</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0028 - accuracy: 0.9996
Epoch 39/50
398/400 [============================&gt;.] - ETA: 0s - loss: 0.0028 - accuracy: 0.9996</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0028 - accuracy: 0.9996
Epoch 40/50
393/400 [============================&gt;.] - ETA: 0s - loss: 0.0017 - accuracy: 0.9999</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0016 - accuracy: 0.9999
Epoch 41/50
393/400 [============================&gt;.] - ETA: 0s - loss: 0.0013 - accuracy: 0.9999</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0013 - accuracy: 0.9999
Epoch 42/50
393/400 [============================&gt;.] - ETA: 0s - loss: 0.0011 - accuracy: 0.9999</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0011 - accuracy: 0.9999
Epoch 43/50
395/400 [============================&gt;.] - ETA: 0s - loss: 0.0025 - accuracy: 0.9998</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0025 - accuracy: 0.9998
Epoch 44/50
394/400 [============================&gt;.] - ETA: 0s - loss: 0.1310 - accuracy: 0.9493</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.1322 - accuracy: 0.9488
Epoch 45/50
392/400 [============================&gt;.] - ETA: 0s - loss: 0.0949 - accuracy: 0.9643</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0943 - accuracy: 0.9647
Epoch 46/50
390/400 [============================&gt;.] - ETA: 0s - loss: 0.0212 - accuracy: 0.9962</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0212 - accuracy: 0.9962
Epoch 47/50
396/400 [============================&gt;.] - ETA: 0s - loss: 0.0068 - accuracy: 0.9997</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0068 - accuracy: 0.9997
Epoch 48/50
394/400 [============================&gt;.] - ETA: 0s - loss: 0.0034 - accuracy: 0.9999</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0034 - accuracy: 0.9999
Epoch 49/50
394/400 [============================&gt;.] - ETA: 0s - loss: 0.0031 - accuracy: 0.9997</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0031 - accuracy: 0.9997
Epoch 50/50
396/400 [============================&gt;.] - ETA: 0s - loss: 0.0034 - accuracy: 0.9998</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0034 - accuracy: 0.9998
100/100 [==============================] - 1s 3ms/step
[CV] END ..........................................epochs=50; total time= 1.6min
Epoch 1/50
391/400 [============================&gt;.] - ETA: 0s - loss: 0.6736 - accuracy: 0.5770</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 3s 4ms/step - loss: 0.6737 - accuracy: 0.5770
Epoch 2/50
394/400 [============================&gt;.] - ETA: 0s - loss: 0.6298 - accuracy: 0.6424</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.6297 - accuracy: 0.6427
Epoch 3/50
391/400 [============================&gt;.] - ETA: 0s - loss: 0.5942 - accuracy: 0.6845</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.5946 - accuracy: 0.6841
Epoch 4/50
399/400 [============================&gt;.] - ETA: 0s - loss: 0.5461 - accuracy: 0.7241</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.5464 - accuracy: 0.7238
Epoch 5/50
394/400 [============================&gt;.] - ETA: 0s - loss: 0.4934 - accuracy: 0.7682</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.4929 - accuracy: 0.7688
Epoch 6/50
394/400 [============================&gt;.] - ETA: 0s - loss: 0.4320 - accuracy: 0.8123</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.4322 - accuracy: 0.8119
Epoch 7/50
392/400 [============================&gt;.] - ETA: 0s - loss: 0.3638 - accuracy: 0.8590</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.3641 - accuracy: 0.8588
Epoch 8/50
392/400 [============================&gt;.] - ETA: 0s - loss: 0.2925 - accuracy: 0.8970</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.2933 - accuracy: 0.8963
Epoch 9/50
392/400 [============================&gt;.] - ETA: 0s - loss: 0.2314 - accuracy: 0.9302</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.2315 - accuracy: 0.9298
Epoch 10/50
391/400 [============================&gt;.] - ETA: 0s - loss: 0.1744 - accuracy: 0.9552</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.1753 - accuracy: 0.9548
Epoch 11/50
390/400 [============================&gt;.] - ETA: 0s - loss: 0.1289 - accuracy: 0.9722</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.1297 - accuracy: 0.9716
Epoch 12/50
393/400 [============================&gt;.] - ETA: 0s - loss: 0.0932 - accuracy: 0.9848</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0933 - accuracy: 0.9848
Epoch 13/50
394/400 [============================&gt;.] - ETA: 0s - loss: 0.0676 - accuracy: 0.9903</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0677 - accuracy: 0.9902
Epoch 14/50
399/400 [============================&gt;.] - ETA: 0s - loss: 0.0510 - accuracy: 0.9934</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0511 - accuracy: 0.9934
Epoch 15/50
394/400 [============================&gt;.] - ETA: 0s - loss: 0.0394 - accuracy: 0.9956</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0393 - accuracy: 0.9956
Epoch 16/50
400/400 [==============================] - ETA: 0s - loss: 0.0317 - accuracy: 0.9954</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0317 - accuracy: 0.9954
Epoch 17/50
400/400 [==============================] - ETA: 0s - loss: 0.0346 - accuracy: 0.9946</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0346 - accuracy: 0.9946
Epoch 18/50
399/400 [============================&gt;.] - ETA: 0s - loss: 0.0331 - accuracy: 0.9940</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0332 - accuracy: 0.9938
Epoch 19/50
397/400 [============================&gt;.] - ETA: 0s - loss: 0.0426 - accuracy: 0.9914</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0424 - accuracy: 0.9915
Epoch 20/50
390/400 [============================&gt;.] - ETA: 0s - loss: 0.0306 - accuracy: 0.9937</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0308 - accuracy: 0.9937
Epoch 21/50
394/400 [============================&gt;.] - ETA: 0s - loss: 0.0255 - accuracy: 0.9951</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0258 - accuracy: 0.9949
Epoch 22/50
392/400 [============================&gt;.] - ETA: 0s - loss: 0.0247 - accuracy: 0.9950</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0247 - accuracy: 0.9951
Epoch 23/50
391/400 [============================&gt;.] - ETA: 0s - loss: 0.0235 - accuracy: 0.9950</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0235 - accuracy: 0.9949
Epoch 24/50
400/400 [==============================] - ETA: 0s - loss: 0.0104 - accuracy: 0.9986</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0104 - accuracy: 0.9986
Epoch 25/50
393/400 [============================&gt;.] - ETA: 0s - loss: 0.0184 - accuracy: 0.9951</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0187 - accuracy: 0.9950
Epoch 26/50
396/400 [============================&gt;.] - ETA: 0s - loss: 0.0462 - accuracy: 0.9856</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0465 - accuracy: 0.9854
Epoch 27/50
396/400 [============================&gt;.] - ETA: 0s - loss: 0.0309 - accuracy: 0.9923</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0307 - accuracy: 0.9923
Epoch 28/50
394/400 [============================&gt;.] - ETA: 0s - loss: 0.0134 - accuracy: 0.9974</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0133 - accuracy: 0.9974
Epoch 29/50
396/400 [============================&gt;.] - ETA: 0s - loss: 0.0100 - accuracy: 0.9976</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0099 - accuracy: 0.9976
Epoch 30/50
394/400 [============================&gt;.] - ETA: 0s - loss: 0.0083 - accuracy: 0.9980</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0083 - accuracy: 0.9980
Epoch 31/50
398/400 [============================&gt;.] - ETA: 0s - loss: 0.0081 - accuracy: 0.9985</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 5ms/step - loss: 0.0081 - accuracy: 0.9985
Epoch 32/50
393/400 [============================&gt;.] - ETA: 0s - loss: 0.0084 - accuracy: 0.9985</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0091 - accuracy: 0.9982
Epoch 33/50
400/400 [==============================] - ETA: 0s - loss: 0.0826 - accuracy: 0.9695</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0826 - accuracy: 0.9695
Epoch 34/50
389/400 [============================&gt;.] - ETA: 0s - loss: 0.0304 - accuracy: 0.9916</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0303 - accuracy: 0.9916
Epoch 35/50
396/400 [============================&gt;.] - ETA: 0s - loss: 0.0075 - accuracy: 0.9994</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0075 - accuracy: 0.9995
Epoch 36/50
392/400 [============================&gt;.] - ETA: 0s - loss: 0.0053 - accuracy: 0.9990</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0053 - accuracy: 0.9990
Epoch 37/50
390/400 [============================&gt;.] - ETA: 0s - loss: 0.0085 - accuracy: 0.9980</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0084 - accuracy: 0.9980
Epoch 38/50
399/400 [============================&gt;.] - ETA: 0s - loss: 0.0114 - accuracy: 0.9973</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0114 - accuracy: 0.9973
Epoch 39/50
394/400 [============================&gt;.] - ETA: 0s - loss: 0.0077 - accuracy: 0.9986</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0077 - accuracy: 0.9986
Epoch 40/50
393/400 [============================&gt;.] - ETA: 0s - loss: 0.0185 - accuracy: 0.9945</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0198 - accuracy: 0.9939
Epoch 41/50
394/400 [============================&gt;.] - ETA: 0s - loss: 0.0653 - accuracy: 0.9768</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0648 - accuracy: 0.9770
Epoch 42/50
392/400 [============================&gt;.] - ETA: 0s - loss: 0.0124 - accuracy: 0.9979</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0125 - accuracy: 0.9979
Epoch 43/50
394/400 [============================&gt;.] - ETA: 0s - loss: 0.0048 - accuracy: 0.9992</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0048 - accuracy: 0.9992
Epoch 44/50
390/400 [============================&gt;.] - ETA: 0s - loss: 0.0028 - accuracy: 0.9995</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0027 - accuracy: 0.9995
Epoch 45/50
395/400 [============================&gt;.] - ETA: 0s - loss: 0.0112 - accuracy: 0.9967</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 5ms/step - loss: 0.0111 - accuracy: 0.9967
Epoch 46/50
395/400 [============================&gt;.] - ETA: 0s - loss: 0.0225 - accuracy: 0.9930</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0235 - accuracy: 0.9927
Epoch 47/50
394/400 [============================&gt;.] - ETA: 0s - loss: 0.0255 - accuracy: 0.9922</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0254 - accuracy: 0.9923
Epoch 48/50
396/400 [============================&gt;.] - ETA: 0s - loss: 0.0120 - accuracy: 0.9964</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0121 - accuracy: 0.9963
Epoch 49/50
393/400 [============================&gt;.] - ETA: 0s - loss: 0.0057 - accuracy: 0.9990</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0056 - accuracy: 0.9990
Epoch 50/50
393/400 [============================&gt;.] - ETA: 0s - loss: 0.0044 - accuracy: 0.9991</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0044 - accuracy: 0.9991
100/100 [==============================] - 1s 3ms/step
[CV] END ..........................................epochs=50; total time= 1.6min
Epoch 1/50
391/400 [============================&gt;.] - ETA: 0s - loss: 0.6678 - accuracy: 0.5858</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 3s 4ms/step - loss: 0.6678 - accuracy: 0.5855
Epoch 2/50
398/400 [============================&gt;.] - ETA: 0s - loss: 0.6227 - accuracy: 0.6466</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 5ms/step - loss: 0.6228 - accuracy: 0.6461
Epoch 3/50
398/400 [============================&gt;.] - ETA: 0s - loss: 0.5831 - accuracy: 0.6932</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 5ms/step - loss: 0.5835 - accuracy: 0.6925
Epoch 4/50
400/400 [==============================] - ETA: 0s - loss: 0.5279 - accuracy: 0.7381</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.5279 - accuracy: 0.7381
Epoch 5/50
395/400 [============================&gt;.] - ETA: 0s - loss: 0.4679 - accuracy: 0.7862</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.4685 - accuracy: 0.7855
Epoch 6/50
395/400 [============================&gt;.] - ETA: 0s - loss: 0.3941 - accuracy: 0.8356</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.3936 - accuracy: 0.8363
Epoch 7/50
396/400 [============================&gt;.] - ETA: 0s - loss: 0.3169 - accuracy: 0.8808</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 5ms/step - loss: 0.3175 - accuracy: 0.8802
Epoch 8/50
395/400 [============================&gt;.] - ETA: 0s - loss: 0.2375 - accuracy: 0.9229</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.2383 - accuracy: 0.9227
Epoch 9/50
390/400 [============================&gt;.] - ETA: 0s - loss: 0.1739 - accuracy: 0.9546</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.1741 - accuracy: 0.9543
Epoch 10/50
395/400 [============================&gt;.] - ETA: 0s - loss: 0.1239 - accuracy: 0.9727</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.1239 - accuracy: 0.9727
Epoch 11/50
390/400 [============================&gt;.] - ETA: 0s - loss: 0.0839 - accuracy: 0.9869</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0840 - accuracy: 0.9866
Epoch 12/50
394/400 [============================&gt;.] - ETA: 0s - loss: 0.0578 - accuracy: 0.9932</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0577 - accuracy: 0.9930
Epoch 13/50
392/400 [============================&gt;.] - ETA: 0s - loss: 0.0405 - accuracy: 0.9951</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0404 - accuracy: 0.9952
Epoch 14/50
392/400 [============================&gt;.] - ETA: 0s - loss: 0.0282 - accuracy: 0.9971</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0285 - accuracy: 0.9970
Epoch 15/50
392/400 [============================&gt;.] - ETA: 0s - loss: 0.0296 - accuracy: 0.9960</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0295 - accuracy: 0.9960
Epoch 16/50
392/400 [============================&gt;.] - ETA: 0s - loss: 0.0292 - accuracy: 0.9959</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 5ms/step - loss: 0.0293 - accuracy: 0.9959
Epoch 17/50
389/400 [============================&gt;.] - ETA: 0s - loss: 0.0263 - accuracy: 0.9957</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0267 - accuracy: 0.9955
Epoch 18/50
392/400 [============================&gt;.] - ETA: 0s - loss: 0.0553 - accuracy: 0.9856</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0556 - accuracy: 0.9855
Epoch 19/50
390/400 [============================&gt;.] - ETA: 0s - loss: 0.0510 - accuracy: 0.9852</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0517 - accuracy: 0.9847
Epoch 20/50
394/400 [============================&gt;.] - ETA: 0s - loss: 0.0275 - accuracy: 0.9942</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0275 - accuracy: 0.9941
Epoch 21/50
399/400 [============================&gt;.] - ETA: 0s - loss: 0.0149 - accuracy: 0.9973</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0149 - accuracy: 0.9973
Epoch 22/50
392/400 [============================&gt;.] - ETA: 0s - loss: 0.0127 - accuracy: 0.9977</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0128 - accuracy: 0.9977
Epoch 23/50
392/400 [============================&gt;.] - ETA: 0s - loss: 0.0119 - accuracy: 0.9980</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 5ms/step - loss: 0.0119 - accuracy: 0.9980
Epoch 24/50
394/400 [============================&gt;.] - ETA: 0s - loss: 0.0527 - accuracy: 0.9838</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0528 - accuracy: 0.9837
Epoch 25/50
393/400 [============================&gt;.] - ETA: 0s - loss: 0.0314 - accuracy: 0.9920</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0312 - accuracy: 0.9921
Epoch 26/50
398/400 [============================&gt;.] - ETA: 0s - loss: 0.0126 - accuracy: 0.9978</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0126 - accuracy: 0.9978
Epoch 27/50
394/400 [============================&gt;.] - ETA: 0s - loss: 0.0109 - accuracy: 0.9982</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0108 - accuracy: 0.9982
Epoch 28/50
394/400 [============================&gt;.] - ETA: 0s - loss: 0.0081 - accuracy: 0.9982</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0085 - accuracy: 0.9980
Epoch 29/50
392/400 [============================&gt;.] - ETA: 0s - loss: 0.0342 - accuracy: 0.9900</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0351 - accuracy: 0.9896
Epoch 30/50
393/400 [============================&gt;.] - ETA: 0s - loss: 0.0529 - accuracy: 0.9827</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 5ms/step - loss: 0.0530 - accuracy: 0.9824
Epoch 31/50
393/400 [============================&gt;.] - ETA: 0s - loss: 0.0135 - accuracy: 0.9970</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0134 - accuracy: 0.9970
Epoch 32/50
393/400 [============================&gt;.] - ETA: 0s - loss: 0.0067 - accuracy: 0.9987</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0066 - accuracy: 0.9987
Epoch 33/50
394/400 [============================&gt;.] - ETA: 0s - loss: 0.0029 - accuracy: 0.9995</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0028 - accuracy: 0.9995
Epoch 34/50
397/400 [============================&gt;.] - ETA: 0s - loss: 0.0017 - accuracy: 0.9999</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0017 - accuracy: 0.9999
Epoch 35/50
396/400 [============================&gt;.] - ETA: 0s - loss: 0.0156 - accuracy: 0.9949</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0161 - accuracy: 0.9948
Epoch 36/50
389/400 [============================&gt;.] - ETA: 0s - loss: 0.0810 - accuracy: 0.9679</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0804 - accuracy: 0.9685
Epoch 37/50
397/400 [============================&gt;.] - ETA: 0s - loss: 0.0275 - accuracy: 0.9923</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0275 - accuracy: 0.9923
Epoch 38/50
393/400 [============================&gt;.] - ETA: 0s - loss: 0.0094 - accuracy: 0.9980</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0093 - accuracy: 0.9980
Epoch 39/50
400/400 [==============================] - ETA: 0s - loss: 0.0046 - accuracy: 0.9992</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0046 - accuracy: 0.9992
Epoch 40/50
393/400 [============================&gt;.] - ETA: 0s - loss: 0.0060 - accuracy: 0.9988</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0059 - accuracy: 0.9988
Epoch 41/50
394/400 [============================&gt;.] - ETA: 0s - loss: 0.0038 - accuracy: 0.9995</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0039 - accuracy: 0.9995
Epoch 42/50
393/400 [============================&gt;.] - ETA: 0s - loss: 0.0073 - accuracy: 0.9985</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0073 - accuracy: 0.9985
Epoch 43/50
390/400 [============================&gt;.] - ETA: 0s - loss: 0.0371 - accuracy: 0.9873</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0383 - accuracy: 0.9869
Epoch 44/50
398/400 [============================&gt;.] - ETA: 0s - loss: 0.0581 - accuracy: 0.9783</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0581 - accuracy: 0.9784
Epoch 45/50
390/400 [============================&gt;.] - ETA: 0s - loss: 0.0190 - accuracy: 0.9946</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0188 - accuracy: 0.9946
Epoch 46/50
393/400 [============================&gt;.] - ETA: 0s - loss: 0.0062 - accuracy: 0.9990</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0061 - accuracy: 0.9991
Epoch 47/50
396/400 [============================&gt;.] - ETA: 0s - loss: 0.0023 - accuracy: 0.9998</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0023 - accuracy: 0.9998
Epoch 48/50
395/400 [============================&gt;.] - ETA: 0s - loss: 0.0022 - accuracy: 0.9996</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0022 - accuracy: 0.9996
Epoch 49/50
392/400 [============================&gt;.] - ETA: 0s - loss: 0.0032 - accuracy: 0.9994</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0032 - accuracy: 0.9995
Epoch 50/50
389/400 [============================&gt;.] - ETA: 0s - loss: 0.0135 - accuracy: 0.9952</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0150 - accuracy: 0.9945
100/100 [==============================] - 1s 3ms/step
[CV] END ..........................................epochs=50; total time= 1.6min
Epoch 1/50
400/400 [==============================] - ETA: 0s - loss: 0.6713 - accuracy: 0.5841</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 3s 5ms/step - loss: 0.6713 - accuracy: 0.5841
Epoch 2/50
390/400 [============================&gt;.] - ETA: 0s - loss: 0.6305 - accuracy: 0.6450</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.6309 - accuracy: 0.6441
Epoch 3/50
390/400 [============================&gt;.] - ETA: 0s - loss: 0.5887 - accuracy: 0.6849</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.5888 - accuracy: 0.6852
Epoch 4/50
391/400 [============================&gt;.] - ETA: 0s - loss: 0.5430 - accuracy: 0.7270</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.5434 - accuracy: 0.7272
Epoch 5/50
391/400 [============================&gt;.] - ETA: 0s - loss: 0.4903 - accuracy: 0.7690</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.4909 - accuracy: 0.7688
Epoch 6/50
392/400 [============================&gt;.] - ETA: 0s - loss: 0.4247 - accuracy: 0.8151</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.4259 - accuracy: 0.8143
Epoch 7/50
395/400 [============================&gt;.] - ETA: 0s - loss: 0.3530 - accuracy: 0.8599</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.3528 - accuracy: 0.8598
Epoch 8/50
396/400 [============================&gt;.] - ETA: 0s - loss: 0.2842 - accuracy: 0.8983</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 5ms/step - loss: 0.2847 - accuracy: 0.8979
Epoch 9/50
393/400 [============================&gt;.] - ETA: 0s - loss: 0.2166 - accuracy: 0.9358</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.2163 - accuracy: 0.9358
Epoch 10/50
395/400 [============================&gt;.] - ETA: 0s - loss: 0.1580 - accuracy: 0.9638</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.1580 - accuracy: 0.9636
Epoch 11/50
394/400 [============================&gt;.] - ETA: 0s - loss: 0.1138 - accuracy: 0.9775</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.1142 - accuracy: 0.9770
Epoch 12/50
396/400 [============================&gt;.] - ETA: 0s - loss: 0.0821 - accuracy: 0.9864</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0820 - accuracy: 0.9865
Epoch 13/50
391/400 [============================&gt;.] - ETA: 0s - loss: 0.0557 - accuracy: 0.9946</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0558 - accuracy: 0.9947
Epoch 14/50
391/400 [============================&gt;.] - ETA: 0s - loss: 0.0410 - accuracy: 0.9957</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0413 - accuracy: 0.9956
Epoch 15/50
397/400 [============================&gt;.] - ETA: 0s - loss: 0.0275 - accuracy: 0.9980</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 5ms/step - loss: 0.0276 - accuracy: 0.9980
Epoch 16/50
395/400 [============================&gt;.] - ETA: 0s - loss: 0.0238 - accuracy: 0.9972</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0237 - accuracy: 0.9973
Epoch 17/50
399/400 [============================&gt;.] - ETA: 0s - loss: 0.0248 - accuracy: 0.9965</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0248 - accuracy: 0.9965
Epoch 18/50
391/400 [============================&gt;.] - ETA: 0s - loss: 0.0263 - accuracy: 0.9950</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0269 - accuracy: 0.9949
Epoch 19/50
390/400 [============================&gt;.] - ETA: 0s - loss: 0.0379 - accuracy: 0.9928</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 5ms/step - loss: 0.0382 - accuracy: 0.9925
Epoch 20/50
391/400 [============================&gt;.] - ETA: 0s - loss: 0.0319 - accuracy: 0.9939</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0319 - accuracy: 0.9939
Epoch 21/50
399/400 [============================&gt;.] - ETA: 0s - loss: 0.0188 - accuracy: 0.9970</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 5ms/step - loss: 0.0187 - accuracy: 0.9970
Epoch 22/50
398/400 [============================&gt;.] - ETA: 0s - loss: 0.0154 - accuracy: 0.9973</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0153 - accuracy: 0.9973
Epoch 23/50
389/400 [============================&gt;.] - ETA: 0s - loss: 0.0104 - accuracy: 0.9984</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0105 - accuracy: 0.9984
Epoch 24/50
396/400 [============================&gt;.] - ETA: 0s - loss: 0.0301 - accuracy: 0.9917</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0302 - accuracy: 0.9917
Epoch 25/50
393/400 [============================&gt;.] - ETA: 0s - loss: 0.0625 - accuracy: 0.9802</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0623 - accuracy: 0.9802
Epoch 26/50
397/400 [============================&gt;.] - ETA: 0s - loss: 0.0245 - accuracy: 0.9952</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0244 - accuracy: 0.9952
Epoch 27/50
396/400 [============================&gt;.] - ETA: 0s - loss: 0.0122 - accuracy: 0.9977</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0124 - accuracy: 0.9976
Epoch 28/50
390/400 [============================&gt;.] - ETA: 0s - loss: 0.0070 - accuracy: 0.9988</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0070 - accuracy: 0.9988
Epoch 29/50
389/400 [============================&gt;.] - ETA: 0s - loss: 0.0077 - accuracy: 0.9980</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 5ms/step - loss: 0.0082 - accuracy: 0.9980
Epoch 30/50
392/400 [============================&gt;.] - ETA: 0s - loss: 0.0165 - accuracy: 0.9959</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 5ms/step - loss: 0.0166 - accuracy: 0.9959
Epoch 31/50
395/400 [============================&gt;.] - ETA: 0s - loss: 0.0403 - accuracy: 0.9860</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 5ms/step - loss: 0.0405 - accuracy: 0.9861
Epoch 32/50
394/400 [============================&gt;.] - ETA: 0s - loss: 0.0286 - accuracy: 0.9916</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0286 - accuracy: 0.9916
Epoch 33/50
389/400 [============================&gt;.] - ETA: 0s - loss: 0.0119 - accuracy: 0.9973</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0118 - accuracy: 0.9974
Epoch 34/50
397/400 [============================&gt;.] - ETA: 0s - loss: 0.0065 - accuracy: 0.9985</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 5ms/step - loss: 0.0064 - accuracy: 0.9985
Epoch 35/50
400/400 [==============================] - ETA: 0s - loss: 0.0055 - accuracy: 0.9987</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 5ms/step - loss: 0.0055 - accuracy: 0.9987
Epoch 36/50
391/400 [============================&gt;.] - ETA: 0s - loss: 0.0064 - accuracy: 0.9986</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0066 - accuracy: 0.9985
Epoch 37/50
390/400 [============================&gt;.] - ETA: 0s - loss: 0.0675 - accuracy: 0.9758</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0679 - accuracy: 0.9755
Epoch 38/50
389/400 [============================&gt;.] - ETA: 0s - loss: 0.0293 - accuracy: 0.9920</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0292 - accuracy: 0.9921
Epoch 39/50
392/400 [============================&gt;.] - ETA: 0s - loss: 0.0094 - accuracy: 0.9983</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0094 - accuracy: 0.9984
Epoch 40/50
393/400 [============================&gt;.] - ETA: 0s - loss: 0.0040 - accuracy: 0.9994</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0039 - accuracy: 0.9995
Epoch 41/50
392/400 [============================&gt;.] - ETA: 0s - loss: 0.0041 - accuracy: 0.9994</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0041 - accuracy: 0.9994
Epoch 42/50
400/400 [==============================] - ETA: 0s - loss: 0.0031 - accuracy: 0.9995</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 5ms/step - loss: 0.0031 - accuracy: 0.9995
Epoch 43/50
395/400 [============================&gt;.] - ETA: 0s - loss: 0.0042 - accuracy: 0.9993</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0043 - accuracy: 0.9992
Epoch 44/50
389/400 [============================&gt;.] - ETA: 0s - loss: 0.0352 - accuracy: 0.9877</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0381 - accuracy: 0.9865
Epoch 45/50
393/400 [============================&gt;.] - ETA: 0s - loss: 0.0617 - accuracy: 0.9775</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0615 - accuracy: 0.9776
Epoch 46/50
392/400 [============================&gt;.] - ETA: 0s - loss: 0.0133 - accuracy: 0.9974</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0137 - accuracy: 0.9973
Epoch 47/50
392/400 [============================&gt;.] - ETA: 0s - loss: 0.0070 - accuracy: 0.9984</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0072 - accuracy: 0.9984
Epoch 48/50
393/400 [============================&gt;.] - ETA: 0s - loss: 0.0041 - accuracy: 0.9994</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 5ms/step - loss: 0.0040 - accuracy: 0.9995
Epoch 49/50
394/400 [============================&gt;.] - ETA: 0s - loss: 0.0048 - accuracy: 0.9990</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 5ms/step - loss: 0.0048 - accuracy: 0.9991
Epoch 50/50
389/400 [============================&gt;.] - ETA: 0s - loss: 0.0063 - accuracy: 0.9993</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.0062 - accuracy: 0.9993
100/100 [==============================] - 1s 3ms/step
[CV] END ..........................................epochs=50; total time= 1.7min
Epoch 1/50
397/400 [============================&gt;.] - ETA: 0s - loss: 0.6683 - accuracy: 0.5867</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 3s 5ms/step - loss: 0.6684 - accuracy: 0.5866
Epoch 2/50
393/400 [============================&gt;.] - ETA: 0s - loss: 0.6257 - accuracy: 0.6452</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.6260 - accuracy: 0.6446
Epoch 3/50
394/400 [============================&gt;.] - ETA: 0s - loss: 0.5886 - accuracy: 0.6858</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.5887 - accuracy: 0.6853
Epoch 4/50
395/400 [============================&gt;.] - ETA: 0s - loss: 0.5375 - accuracy: 0.7301</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.5369 - accuracy: 0.7304
Epoch 5/50
394/400 [============================&gt;.] - ETA: 0s - loss: 0.4746 - accuracy: 0.7759</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 4ms/step - loss: 0.4748 - accuracy: 0.7756
Epoch 6/50
398/400 [============================&gt;.] - ETA: 0s - loss: 0.3999 - accuracy: 0.8327</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 5ms/step - loss: 0.3998 - accuracy: 0.8327
Epoch 7/50
400/400 [==============================] - ETA: 0s - loss: 0.3249 - accuracy: 0.8782</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 5ms/step - loss: 0.3249 - accuracy: 0.8782
Epoch 8/50
396/400 [============================&gt;.] - ETA: 0s - loss: 0.2451 - accuracy: 0.9221</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 5ms/step - loss: 0.2456 - accuracy: 0.9216
Epoch 9/50
398/400 [============================&gt;.] - ETA: 0s - loss: 0.1742 - accuracy: 0.9565</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 5ms/step - loss: 0.1741 - accuracy: 0.9566
Epoch 10/50
392/400 [============================&gt;.] - ETA: 0s - loss: 0.1232 - accuracy: 0.9747</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 5ms/step - loss: 0.1228 - accuracy: 0.9748
Epoch 11/50
396/400 [============================&gt;.] - ETA: 0s - loss: 0.0844 - accuracy: 0.9865</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 5ms/step - loss: 0.0846 - accuracy: 0.9864
Epoch 12/50
395/400 [============================&gt;.] - ETA: 0s - loss: 0.0571 - accuracy: 0.9938</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 5ms/step - loss: 0.0573 - accuracy: 0.9937
Epoch 13/50
400/400 [==============================] - ETA: 0s - loss: 0.0417 - accuracy: 0.9960</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 5ms/step - loss: 0.0417 - accuracy: 0.9960
Epoch 14/50
397/400 [============================&gt;.] - ETA: 0s - loss: 0.0368 - accuracy: 0.9955</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 5ms/step - loss: 0.0369 - accuracy: 0.9955
Epoch 15/50
392/400 [============================&gt;.] - ETA: 0s - loss: 0.0292 - accuracy: 0.9972</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 5ms/step - loss: 0.0291 - accuracy: 0.9973
Epoch 16/50
395/400 [============================&gt;.] - ETA: 0s - loss: 0.0299 - accuracy: 0.9950</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 5ms/step - loss: 0.0300 - accuracy: 0.9950
Epoch 17/50
391/400 [============================&gt;.] - ETA: 0s - loss: 0.0231 - accuracy: 0.9966</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 5ms/step - loss: 0.0233 - accuracy: 0.9965
Epoch 18/50
394/400 [============================&gt;.] - ETA: 0s - loss: 0.0338 - accuracy: 0.9922</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 5ms/step - loss: 0.0343 - accuracy: 0.9922
Epoch 19/50
396/400 [============================&gt;.] - ETA: 0s - loss: 0.0512 - accuracy: 0.9882</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 5ms/step - loss: 0.0510 - accuracy: 0.9884
Epoch 20/50
397/400 [============================&gt;.] - ETA: 0s - loss: 0.0287 - accuracy: 0.9946</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 5ms/step - loss: 0.0286 - accuracy: 0.9947
Epoch 21/50
395/400 [============================&gt;.] - ETA: 0s - loss: 0.0148 - accuracy: 0.9975</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 5ms/step - loss: 0.0148 - accuracy: 0.9976
Epoch 22/50
399/400 [============================&gt;.] - ETA: 0s - loss: 0.0123 - accuracy: 0.9975</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 5ms/step - loss: 0.0123 - accuracy: 0.9975
Epoch 23/50
390/400 [============================&gt;.] - ETA: 0s - loss: 0.0171 - accuracy: 0.9963</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 5ms/step - loss: 0.0173 - accuracy: 0.9962
Epoch 24/50
398/400 [============================&gt;.] - ETA: 0s - loss: 0.0619 - accuracy: 0.9791</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 5ms/step - loss: 0.0619 - accuracy: 0.9792
Epoch 25/50
397/400 [============================&gt;.] - ETA: 0s - loss: 0.0256 - accuracy: 0.9944</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 5ms/step - loss: 0.0256 - accuracy: 0.9945
Epoch 26/50
397/400 [============================&gt;.] - ETA: 0s - loss: 0.0120 - accuracy: 0.9975</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 5ms/step - loss: 0.0120 - accuracy: 0.9975
Epoch 27/50
391/400 [============================&gt;.] - ETA: 0s - loss: 0.0135 - accuracy: 0.9963</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 5ms/step - loss: 0.0134 - accuracy: 0.9964
Epoch 28/50
399/400 [============================&gt;.] - ETA: 0s - loss: 0.0117 - accuracy: 0.9973</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 5ms/step - loss: 0.0117 - accuracy: 0.9973
Epoch 29/50
399/400 [============================&gt;.] - ETA: 0s - loss: 0.0242 - accuracy: 0.9930</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 5ms/step - loss: 0.0243 - accuracy: 0.9930
Epoch 30/50
395/400 [============================&gt;.] - ETA: 0s - loss: 0.0120 - accuracy: 0.9978</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 5ms/step - loss: 0.0120 - accuracy: 0.9978
Epoch 31/50
397/400 [============================&gt;.] - ETA: 0s - loss: 0.0113 - accuracy: 0.9972</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 5ms/step - loss: 0.0115 - accuracy: 0.9972
Epoch 32/50
399/400 [============================&gt;.] - ETA: 0s - loss: 0.0158 - accuracy: 0.9964</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 5ms/step - loss: 0.0158 - accuracy: 0.9964
Epoch 33/50
393/400 [============================&gt;.] - ETA: 0s - loss: 0.0118 - accuracy: 0.9974</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 5ms/step - loss: 0.0118 - accuracy: 0.9974
Epoch 34/50
392/400 [============================&gt;.] - ETA: 0s - loss: 0.0082 - accuracy: 0.9982</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 5ms/step - loss: 0.0084 - accuracy: 0.9981
Epoch 35/50
389/400 [============================&gt;.] - ETA: 0s - loss: 0.0505 - accuracy: 0.9826</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 5ms/step - loss: 0.0527 - accuracy: 0.9818
Epoch 36/50
394/400 [============================&gt;.] - ETA: 0s - loss: 0.0355 - accuracy: 0.9885</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 5ms/step - loss: 0.0353 - accuracy: 0.9886
Epoch 37/50
393/400 [============================&gt;.] - ETA: 0s - loss: 0.0094 - accuracy: 0.9983</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 5ms/step - loss: 0.0094 - accuracy: 0.9981
Epoch 38/50
400/400 [==============================] - ETA: 0s - loss: 0.0062 - accuracy: 0.9990</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 5ms/step - loss: 0.0062 - accuracy: 0.9990
Epoch 39/50
396/400 [============================&gt;.] - ETA: 0s - loss: 0.0063 - accuracy: 0.9984</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 5ms/step - loss: 0.0063 - accuracy: 0.9984
Epoch 40/50
392/400 [============================&gt;.] - ETA: 0s - loss: 0.0064 - accuracy: 0.9985</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 5ms/step - loss: 0.0064 - accuracy: 0.9985
Epoch 41/50
400/400 [==============================] - ETA: 0s - loss: 0.0094 - accuracy: 0.9977</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 5ms/step - loss: 0.0094 - accuracy: 0.9977
Epoch 42/50
392/400 [============================&gt;.] - ETA: 0s - loss: 0.0181 - accuracy: 0.9943</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 5ms/step - loss: 0.0186 - accuracy: 0.9941
Epoch 43/50
390/400 [============================&gt;.] - ETA: 0s - loss: 0.0591 - accuracy: 0.9792</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 5ms/step - loss: 0.0586 - accuracy: 0.9794
Epoch 44/50
396/400 [============================&gt;.] - ETA: 0s - loss: 0.0189 - accuracy: 0.9944</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 5ms/step - loss: 0.0188 - accuracy: 0.9945
Epoch 45/50
393/400 [============================&gt;.] - ETA: 0s - loss: 0.0079 - accuracy: 0.9982</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 5ms/step - loss: 0.0080 - accuracy: 0.9981
Epoch 46/50
394/400 [============================&gt;.] - ETA: 0s - loss: 0.0110 - accuracy: 0.9972</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 5ms/step - loss: 0.0110 - accuracy: 0.9972
Epoch 47/50
396/400 [============================&gt;.] - ETA: 0s - loss: 0.0107 - accuracy: 0.9971</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 5ms/step - loss: 0.0107 - accuracy: 0.9971
Epoch 48/50
390/400 [============================&gt;.] - ETA: 0s - loss: 0.0070 - accuracy: 0.9982</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 5ms/step - loss: 0.0069 - accuracy: 0.9983
Epoch 49/50
400/400 [==============================] - ETA: 0s - loss: 0.0086 - accuracy: 0.9976</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 5ms/step - loss: 0.0086 - accuracy: 0.9976
Epoch 50/50
398/400 [============================&gt;.] - ETA: 0s - loss: 0.0366 - accuracy: 0.9867</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>400/400 [==============================] - 2s 5ms/step - loss: 0.0366 - accuracy: 0.9867
100/100 [==============================] - 1s 3ms/step
[CV] END ..........................................epochs=50; total time= 1.7min
Epoch 1/20
492/500 [============================&gt;.] - ETA: 0s - loss: 0.6634 - accuracy: 0.5979</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>500/500 [==============================] - 4s 5ms/step - loss: 0.6632 - accuracy: 0.5981
Epoch 2/20
493/500 [============================&gt;.] - ETA: 0s - loss: 0.6222 - accuracy: 0.6491</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>500/500 [==============================] - 2s 5ms/step - loss: 0.6227 - accuracy: 0.6488
Epoch 3/20
494/500 [============================&gt;.] - ETA: 0s - loss: 0.5816 - accuracy: 0.6890</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>500/500 [==============================] - 2s 5ms/step - loss: 0.5817 - accuracy: 0.6888
Epoch 4/20
492/500 [============================&gt;.] - ETA: 0s - loss: 0.5353 - accuracy: 0.7315</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>500/500 [==============================] - 2s 5ms/step - loss: 0.5353 - accuracy: 0.7312
Epoch 5/20
498/500 [============================&gt;.] - ETA: 0s - loss: 0.4782 - accuracy: 0.7747</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>500/500 [==============================] - 2s 5ms/step - loss: 0.4779 - accuracy: 0.7750
Epoch 6/20
491/500 [============================&gt;.] - ETA: 0s - loss: 0.4105 - accuracy: 0.8213</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>500/500 [==============================] - 2s 5ms/step - loss: 0.4105 - accuracy: 0.8214
Epoch 7/20
490/500 [============================&gt;.] - ETA: 0s - loss: 0.3389 - accuracy: 0.8675</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>500/500 [==============================] - 2s 5ms/step - loss: 0.3397 - accuracy: 0.8666
Epoch 8/20
498/500 [============================&gt;.] - ETA: 0s - loss: 0.2635 - accuracy: 0.9088</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>500/500 [==============================] - 2s 5ms/step - loss: 0.2636 - accuracy: 0.9087
Epoch 9/20
490/500 [============================&gt;.] - ETA: 0s - loss: 0.2007 - accuracy: 0.9409</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>500/500 [==============================] - 2s 5ms/step - loss: 0.2007 - accuracy: 0.9409
Epoch 10/20
500/500 [==============================] - ETA: 0s - loss: 0.1401 - accuracy: 0.9661</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>500/500 [==============================] - 2s 5ms/step - loss: 0.1401 - accuracy: 0.9661
Epoch 11/20
500/500 [==============================] - ETA: 0s - loss: 0.0999 - accuracy: 0.9812</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>500/500 [==============================] - 2s 5ms/step - loss: 0.0999 - accuracy: 0.9812
Epoch 12/20
493/500 [============================&gt;.] - ETA: 0s - loss: 0.0705 - accuracy: 0.9891</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>500/500 [==============================] - 2s 5ms/step - loss: 0.0707 - accuracy: 0.9891
Epoch 13/20
500/500 [==============================] - ETA: 0s - loss: 0.0550 - accuracy: 0.9917</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>500/500 [==============================] - 2s 5ms/step - loss: 0.0550 - accuracy: 0.9917
Epoch 14/20
493/500 [============================&gt;.] - ETA: 0s - loss: 0.0406 - accuracy: 0.9957</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>500/500 [==============================] - 2s 5ms/step - loss: 0.0407 - accuracy: 0.9957
Epoch 15/20
500/500 [==============================] - ETA: 0s - loss: 0.0324 - accuracy: 0.9958</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>500/500 [==============================] - 2s 5ms/step - loss: 0.0324 - accuracy: 0.9958
Epoch 16/20
489/500 [============================&gt;.] - ETA: 0s - loss: 0.0350 - accuracy: 0.9937</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>500/500 [==============================] - 2s 5ms/step - loss: 0.0356 - accuracy: 0.9934
Epoch 17/20
500/500 [==============================] - ETA: 0s - loss: 0.0419 - accuracy: 0.9911</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>500/500 [==============================] - 2s 5ms/step - loss: 0.0419 - accuracy: 0.9911
Epoch 18/20
494/500 [============================&gt;.] - ETA: 0s - loss: 0.0388 - accuracy: 0.9916</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>500/500 [==============================] - 2s 5ms/step - loss: 0.0390 - accuracy: 0.9915
Epoch 19/20
490/500 [============================&gt;.] - ETA: 0s - loss: 0.0321 - accuracy: 0.9929</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>500/500 [==============================] - 2s 5ms/step - loss: 0.0325 - accuracy: 0.9928
Epoch 20/20
490/500 [============================&gt;.] - ETA: 0s - loss: 0.0210 - accuracy: 0.9958</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>500/500 [==============================] - 2s 5ms/step - loss: 0.0208 - accuracy: 0.9959
Best Parameters: {&#39;epochs&#39;: 20}
500/500 [==============================] - 2s 3ms/step
125/125 [==============================] - 0s 3ms/step
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="47" id="HCpfYhgP1-7D">
<div class="sourceCode" id="cb795"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb795-1"><a href="#cb795-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pickle</span>
<span id="cb795-2"><a href="#cb795-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Save the model</span></span>
<span id="cb795-3"><a href="#cb795-3" aria-hidden="true" tabindex="-1"></a>pickle.dump(best_lstm_model, <span class="bu">open</span>(<span class="st">&#39;/content/drive/MyDrive/AML 2304/fore.pkl&#39;</span>, <span class="st">&#39;wb&#39;</span>))</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="48"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="KxCWou7fxtkJ" data-outputId="97b47f79-3007-4be9-e3cd-5b6e812c61d3">
<div class="sourceCode" id="cb796"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb796-1"><a href="#cb796-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> accuracy_score, precision_score, recall_score, f1_score, confusion_matrix</span>
<span id="cb796-2"><a href="#cb796-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb796-3"><a href="#cb796-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluate the best LSTM model</span></span>
<span id="cb796-4"><a href="#cb796-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Best LSTM Accuracy on Training Set:&quot;</span>, accuracy_score(y_train, y_train_lstm_pred))</span>
<span id="cb796-5"><a href="#cb796-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Best LSTM Accuracy on Test Set:&quot;</span>, accuracy_score(y_test, y_test_lstm_pred))</span>
<span id="cb796-6"><a href="#cb796-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb796-7"><a href="#cb796-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate metrics</span></span>
<span id="cb796-8"><a href="#cb796-8" aria-hidden="true" tabindex="-1"></a>precision <span class="op">=</span> precision_score(y_test, y_test_lstm_pred)</span>
<span id="cb796-9"><a href="#cb796-9" aria-hidden="true" tabindex="-1"></a>recall <span class="op">=</span> recall_score(y_test, y_test_lstm_pred)</span>
<span id="cb796-10"><a href="#cb796-10" aria-hidden="true" tabindex="-1"></a>f1 <span class="op">=</span> f1_score(y_test, y_test_lstm_pred)</span>
<span id="cb796-11"><a href="#cb796-11" aria-hidden="true" tabindex="-1"></a>conf_matrix <span class="op">=</span> confusion_matrix(y_test, y_test_lstm_pred)</span>
<span id="cb796-12"><a href="#cb796-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb796-13"><a href="#cb796-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Print metrics</span></span>
<span id="cb796-14"><a href="#cb796-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Precision:&quot;</span>, precision)</span>
<span id="cb796-15"><a href="#cb796-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Recall:&quot;</span>, recall)</span>
<span id="cb796-16"><a href="#cb796-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;F1-score:&quot;</span>, f1)</span>
<span id="cb796-17"><a href="#cb796-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Confusion Matrix:</span><span class="ch">\n</span><span class="st">&quot;</span>, conf_matrix)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Best LSTM Accuracy on Training Set: 0.998875
Best LSTM Accuracy on Test Set: 0.629
Precision: 0.6458865610628512
Recall: 0.6150851581508516
F1-score: 0.6301096709870389
Confusion Matrix:
 [[1252  693]
 [ 791 1264]]
</code></pre>
</div>
</div>
<section id="class-seperability-in-custom-lstm" class="cell markdown"
id="dHz1GMxUZgLB">
<h2>Class Seperability in Custom LSTM</h2>
</section>
<div class="cell code" data-execution_count="49"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="MBh3xaBcZub0" data-outputId="6d655409-2851-4cd9-8ecd-1f028b356fb2">
<div class="sourceCode" id="cb798"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb798-1"><a href="#cb798-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the F1 score for both the training and test sets</span></span>
<span id="cb798-2"><a href="#cb798-2" aria-hidden="true" tabindex="-1"></a>f1_score_train <span class="op">=</span> f1_score(y_train, y_train_lstm_pred)</span>
<span id="cb798-3"><a href="#cb798-3" aria-hidden="true" tabindex="-1"></a>f1_score_test <span class="op">=</span> f1_score(y_test, y_test_lstm_pred)</span>
<span id="cb798-4"><a href="#cb798-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb798-5"><a href="#cb798-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the inverse of the F1 score, as smaller F1 scores indicate better separability</span></span>
<span id="cb798-6"><a href="#cb798-6" aria-hidden="true" tabindex="-1"></a>train_separability_f1 <span class="op">=</span> <span class="dv">1</span> <span class="op">/</span> f1_score_train</span>
<span id="cb798-7"><a href="#cb798-7" aria-hidden="true" tabindex="-1"></a>test_separability_f1 <span class="op">=</span> <span class="dv">1</span> <span class="op">/</span> f1_score_test</span>
<span id="cb798-8"><a href="#cb798-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb798-9"><a href="#cb798-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&#39;Training class separability (F1 score): </span><span class="sc">{</span>train_separability_f1<span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb798-10"><a href="#cb798-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&#39;Test class separability (F1 score): </span><span class="sc">{</span>test_separability_f1<span class="sc">}</span><span class="ss">&#39;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Training class separability (F1 score): 1.0011347875425545
Test class separability (F1 score): 1.5870253164556962
</code></pre>
</div>
</div>
<section id="shap-for-custom-lstm" class="cell markdown"
id="IPCMvIiPZnvD">
<h2>SHAP for Custom LSTM</h2>
</section>
<div class="cell code" data-execution_count="50"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="s82FI3UXl2HR" data-outputId="f10975aa-0fc7-44bf-e7c0-1fa126959513">
<div class="sourceCode" id="cb800"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb800-1"><a href="#cb800-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pip install shap</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Collecting shap
  Downloading shap-0.45.0-cp310-cp310-manylinux_2_12_x86_64.manylinux2010_x86_64.manylinux_2_17_x86_64.manylinux2014_x86_64.whl (538 kB)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 0.0/538.2 kB ? eta -:--:--━━━━━━━━━━╸━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 143.4/538.2 kB 4.3 MB/s eta 0:00:01━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 538.2/538.2 kB 7.9 MB/s eta 0:00:00
ent already satisfied: numpy in /usr/local/lib/python3.10/dist-packages (from shap) (1.25.2)
Requirement already satisfied: scipy in /usr/local/lib/python3.10/dist-packages (from shap) (1.11.4)
Requirement already satisfied: scikit-learn in /usr/local/lib/python3.10/dist-packages (from shap) (1.2.2)
Requirement already satisfied: pandas in /usr/local/lib/python3.10/dist-packages (from shap) (2.0.3)
Requirement already satisfied: tqdm&gt;=4.27.0 in /usr/local/lib/python3.10/dist-packages (from shap) (4.66.2)
Requirement already satisfied: packaging&gt;20.9 in /usr/local/lib/python3.10/dist-packages (from shap) (24.0)
Collecting slicer==0.0.7 (from shap)
  Downloading slicer-0.0.7-py3-none-any.whl (14 kB)
Requirement already satisfied: numba in /usr/local/lib/python3.10/dist-packages (from shap) (0.58.1)
Requirement already satisfied: cloudpickle in /usr/local/lib/python3.10/dist-packages (from shap) (2.2.1)
Requirement already satisfied: llvmlite&lt;0.42,&gt;=0.41.0dev0 in /usr/local/lib/python3.10/dist-packages (from numba-&gt;shap) (0.41.1)
Requirement already satisfied: python-dateutil&gt;=2.8.2 in /usr/local/lib/python3.10/dist-packages (from pandas-&gt;shap) (2.8.2)
Requirement already satisfied: pytz&gt;=2020.1 in /usr/local/lib/python3.10/dist-packages (from pandas-&gt;shap) (2023.4)
Requirement already satisfied: tzdata&gt;=2022.1 in /usr/local/lib/python3.10/dist-packages (from pandas-&gt;shap) (2024.1)
Requirement already satisfied: joblib&gt;=1.1.1 in /usr/local/lib/python3.10/dist-packages (from scikit-learn-&gt;shap) (1.4.0)
Requirement already satisfied: threadpoolctl&gt;=2.0.0 in /usr/local/lib/python3.10/dist-packages (from scikit-learn-&gt;shap) (3.4.0)
Requirement already satisfied: six&gt;=1.5 in /usr/local/lib/python3.10/dist-packages (from python-dateutil&gt;=2.8.2-&gt;pandas-&gt;shap) (1.16.0)
Installing collected packages: slicer, shap
Successfully installed shap-0.45.0 slicer-0.0.7
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="51"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="zvQDZ31hNizB" data-outputId="ba87e469-ab1d-4875-d3e3-963b78007883">
<div class="sourceCode" id="cb802"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb802-1"><a href="#cb802-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;X_test_reshaped:&quot;</span>,X_test_reshaped.shape)</span>
<span id="cb802-2"><a href="#cb802-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;X_train_reshaped:&quot;</span>,X_train_reshaped.shape)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>X_test_reshaped: (4000, 1, 43636)
X_train_reshaped: (16000, 1, 43636)
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="52"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:989,&quot;referenced_widgets&quot;:[&quot;b3c0a1c41e0c46898d56db4650d4c242&quot;,&quot;8ddce95f718d454e8d390b92798a6f72&quot;,&quot;e14672603b9b4ae6b742051fbd98404b&quot;,&quot;11e07e189e5e4a81a769fe76f3097211&quot;,&quot;000d2b288816438eb84e0ab1b59b5320&quot;,&quot;d96e2e211b5941f39768158a9ad41263&quot;,&quot;df18e80f11ae4f6da7d0143a4d4afee6&quot;,&quot;a7315ebf1f6c4c4faf10fef3f9438ad2&quot;,&quot;2205d2740a674cb9bf85874c36f09b86&quot;,&quot;8418e6a82b6342d6b14d239927314a42&quot;,&quot;aa8e0d7bdb05445f80aa499bbd6b12c6&quot;]}"
id="8kchACU3eG_8" data-outputId="31f865b3-65a4-4f8e-d941-ebf4633307e8">
<div class="sourceCode" id="cb804"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb804-1"><a href="#cb804-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pickle</span>
<span id="cb804-2"><a href="#cb804-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> shap</span>
<span id="cb804-3"><a href="#cb804-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb804-4"><a href="#cb804-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb804-5"><a href="#cb804-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Load your LSTM model from the pickle file</span></span>
<span id="cb804-6"><a href="#cb804-6" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(<span class="st">&#39;/content/drive/MyDrive/AML 2304/best_lstm_model.pkl&#39;</span>, <span class="st">&#39;rb&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb804-7"><a href="#cb804-7" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> pickle.load(f)</span>
<span id="cb804-8"><a href="#cb804-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb804-9"><a href="#cb804-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Define a custom predict function</span></span>
<span id="cb804-10"><a href="#cb804-10" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> predict_fn(x):</span>
<span id="cb804-11"><a href="#cb804-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Reshape x to have a sequence length of 1</span></span>
<span id="cb804-12"><a href="#cb804-12" aria-hidden="true" tabindex="-1"></a>    x_reshaped <span class="op">=</span> np.expand_dims(x, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb804-13"><a href="#cb804-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> model.predict(x_reshaped)</span>
<span id="cb804-14"><a href="#cb804-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb804-15"><a href="#cb804-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure X_train_reshaped is a numpy array</span></span>
<span id="cb804-16"><a href="#cb804-16" aria-hidden="true" tabindex="-1"></a>X_train_reshaped <span class="op">=</span> np.array(X_train_reshaped)</span>
<span id="cb804-17"><a href="#cb804-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb804-18"><a href="#cb804-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Reshape X_train_reshaped if needed</span></span>
<span id="cb804-19"><a href="#cb804-19" aria-hidden="true" tabindex="-1"></a>X_train_reshaped <span class="op">=</span> X_train_reshaped.reshape(X_train_reshaped.shape[<span class="dv">0</span>], <span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb804-20"><a href="#cb804-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb804-21"><a href="#cb804-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample a subset of your training data</span></span>
<span id="cb804-22"><a href="#cb804-22" aria-hidden="true" tabindex="-1"></a>sample_size <span class="op">=</span> <span class="dv">7</span>  <span class="co"># Specify the number of samples you want to process</span></span>
<span id="cb804-23"><a href="#cb804-23" aria-hidden="true" tabindex="-1"></a>indices <span class="op">=</span> np.random.choice(X_train_reshaped.shape[<span class="dv">0</span>], sample_size, replace<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb804-24"><a href="#cb804-24" aria-hidden="true" tabindex="-1"></a>X_train_subset <span class="op">=</span> X_train_reshaped[indices]</span>
<span id="cb804-25"><a href="#cb804-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb804-26"><a href="#cb804-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize the SHAP KernelExplainer with summarized background data using kmeans</span></span>
<span id="cb804-27"><a href="#cb804-27" aria-hidden="true" tabindex="-1"></a>background_data <span class="op">=</span> shap.kmeans(X_train_subset, <span class="dv">7</span>)</span>
<span id="cb804-28"><a href="#cb804-28" aria-hidden="true" tabindex="-1"></a>explainer_train <span class="op">=</span> shap.KernelExplainer(predict_fn, background_data)</span>
<span id="cb804-29"><a href="#cb804-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb804-30"><a href="#cb804-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate SHAP values for your training data subset</span></span>
<span id="cb804-31"><a href="#cb804-31" aria-hidden="true" tabindex="-1"></a>shap_values_train_subset <span class="op">=</span> explainer_train.shap_values(X_train_subset)</span>
<span id="cb804-32"><a href="#cb804-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb804-33"><a href="#cb804-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the SHAP values for the training data subset</span></span>
<span id="cb804-34"><a href="#cb804-34" aria-hidden="true" tabindex="-1"></a>shap.summary_plot(shap_values_train_subset, features<span class="op">=</span>X_train_subset)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>1/1 [==============================] - 0s 372ms/step
</code></pre>
</div>
<div class="output display_data">
<div class="sourceCode" id="cb806"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb806-1"><a href="#cb806-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;model_id&quot;</span><span class="fu">:</span><span class="st">&quot;b3c0a1c41e0c46898d56db4650d4c242&quot;</span><span class="fu">,</span><span class="dt">&quot;version_major&quot;</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span><span class="dt">&quot;version_minor&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">}</span></span></code></pre></div>
</div>
<div class="output stream stdout">
<pre><code>1/1 [==============================] - 0s 44ms/step
749/749 [==============================] - 2s 3ms/step
1/1 [==============================] - 0s 25ms/step
749/749 [==============================] - 2s 3ms/step
1/1 [==============================] - 0s 25ms/step
749/749 [==============================] - 2s 3ms/step
1/1 [==============================] - 0s 25ms/step
749/749 [==============================] - 2s 3ms/step
1/1 [==============================] - 0s 23ms/step
749/749 [==============================] - 2s 3ms/step
1/1 [==============================] - 0s 23ms/step
749/749 [==============================] - 2s 3ms/step
1/1 [==============================] - 0s 24ms/step
749/749 [==============================] - 2s 3ms/step
</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_bbbc7c3ec5c04b7191d21d4c180a5040/4499c8d9951a94b198ae3dd5a87b2d9343550023.png" /></p>
</div>
</div>
<section id="lstm-based-svm" class="cell markdown" id="eMSu06dMa0e7">
<h1>LSTM based SVM</h1>
</section>
<section id="imports" class="cell markdown" id="nR40JxAwf3AA">
<h2>imports</h2>
</section>
<div class="cell code" id="OVSeOqlmdAho">
<div class="sourceCode" id="cb808"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb808-1"><a href="#cb808-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb808-2"><a href="#cb808-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.models <span class="im">import</span> Sequential</span>
<span id="cb808-3"><a href="#cb808-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.layers <span class="im">import</span> LSTM, Dense, Embedding, SpatialDropout1D</span>
<span id="cb808-4"><a href="#cb808-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.svm <span class="im">import</span> SVC</span>
<span id="cb808-5"><a href="#cb808-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb808-6"><a href="#cb808-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> classification_report, accuracy_score</span></code></pre></div>
</div>
<section id="feature-extraction-from-lstm" class="cell markdown"
id="tAw3YjX2a4A5">
<h2>Feature Extraction from LSTM</h2>
</section>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="YOp3R7Fxbby5" data-outputId="7c497782-e045-421b-fc69-bf3febdf9869">
<div class="sourceCode" id="cb809"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb809-1"><a href="#cb809-1" aria-hidden="true" tabindex="-1"></a><span class="co">&#39;&#39;&#39;# Extracting features from the LSTM layer</span></span>
<span id="cb809-2"><a href="#cb809-2" aria-hidden="true" tabindex="-1"></a><span class="co">feature_extractor = Model(inputs=best_lstm_model.input, outputs=best_lstm_model.layers[0].output)&#39;&#39;&#39;</span></span>
<span id="cb809-3"><a href="#cb809-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb809-4"><a href="#cb809-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.models <span class="im">import</span> Model</span>
<span id="cb809-5"><a href="#cb809-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb809-6"><a href="#cb809-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract features from the LSTM layer</span></span>
<span id="cb809-7"><a href="#cb809-7" aria-hidden="true" tabindex="-1"></a>X_train_lstm <span class="op">=</span> best_lstm_model.extract_features(X_train_reshaped)</span>
<span id="cb809-8"><a href="#cb809-8" aria-hidden="true" tabindex="-1"></a>X_test_lstm <span class="op">=</span> best_lstm_model.extract_features(X_test_reshaped)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>500/500 [==============================] - 2s 3ms/step
125/125 [==============================] - 1s 3ms/step
</code></pre>
</div>
</div>
<section id="reshaping-lstm-inputs-in-2d-for-feed-in-to-svm-model"
class="cell markdown" id="o_53-G7LbiDr">
<h2>Reshaping LSTM inputs in 2D for feed in to SVM Model</h2>
</section>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="ajMJQrm8d-8k" data-outputId="1b94b318-16bd-4f6c-db18-72c988ce7dbe">
<div class="sourceCode" id="cb811"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb811-1"><a href="#cb811-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;X_train_lstm shape:&quot;</span>, X_train_lstm.shape)</span>
<span id="cb811-2"><a href="#cb811-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;X_test_lstm shape:&quot;</span>, X_test_lstm.shape)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>X_train_lstm shape: (16000, 64)
X_test_lstm shape: (4000, 64)
</code></pre>
</div>
</div>
<div class="cell code" id="kHvpF_BabxhO">
<div class="sourceCode" id="cb813"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb813-1"><a href="#cb813-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Reshape LSTM features for SVM</span></span>
<span id="cb813-2"><a href="#cb813-2" aria-hidden="true" tabindex="-1"></a>X_train_lstm_reshaped <span class="op">=</span> X_train_lstm.reshape(X_train_lstm.shape[<span class="dv">0</span>], X_train_lstm.shape[<span class="dv">1</span>])</span>
<span id="cb813-3"><a href="#cb813-3" aria-hidden="true" tabindex="-1"></a>X_test_lstm_reshaped <span class="op">=</span> X_test_lstm.reshape(X_test_lstm.shape[<span class="dv">0</span>], X_test_lstm.shape[<span class="dv">1</span>])</span></code></pre></div>
</div>
<section id="model-initialization-and-training-and-predicting"
class="cell markdown" id="VT2HCL6vcC0v">
<h2>Model initialization and training and predicting</h2>
</section>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="zgJCesb8cI7c" data-outputId="70873c67-e960-444f-f3d4-bd98c1654c60">
<div class="sourceCode" id="cb814"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb814-1"><a href="#cb814-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the parameter grid</span></span>
<span id="cb814-2"><a href="#cb814-2" aria-hidden="true" tabindex="-1"></a>param_grid <span class="op">=</span> {</span>
<span id="cb814-3"><a href="#cb814-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;C&#39;</span>: [<span class="fl">0.1</span>, <span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">100</span>],</span>
<span id="cb814-4"><a href="#cb814-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;gamma&#39;</span>: [<span class="fl">0.01</span>, <span class="fl">0.1</span>, <span class="dv">1</span>, <span class="dv">10</span>],</span>
<span id="cb814-5"><a href="#cb814-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;kernel&#39;</span>: [<span class="st">&#39;rbf&#39;</span>, <span class="st">&#39;linear&#39;</span>]</span>
<span id="cb814-6"><a href="#cb814-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb814-7"><a href="#cb814-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb814-8"><a href="#cb814-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize the SVM Classifier</span></span>
<span id="cb814-9"><a href="#cb814-9" aria-hidden="true" tabindex="-1"></a>svm_classifier <span class="op">=</span> SVC(probability<span class="op">=</span><span class="va">True</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb814-10"><a href="#cb814-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb814-11"><a href="#cb814-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize GridSearchCV</span></span>
<span id="cb814-12"><a href="#cb814-12" aria-hidden="true" tabindex="-1"></a>grid_search <span class="op">=</span> GridSearchCV(estimator<span class="op">=</span>svm_classifier, param_grid<span class="op">=</span>param_grid, cv<span class="op">=</span><span class="dv">5</span>, n_jobs<span class="op">=-</span><span class="dv">1</span>, verbose<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb814-13"><a href="#cb814-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb814-14"><a href="#cb814-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit GridSearchCV to the training data</span></span>
<span id="cb814-15"><a href="#cb814-15" aria-hidden="true" tabindex="-1"></a>grid_search.fit(X_train_lstm_reshaped, y_train)</span>
<span id="cb814-16"><a href="#cb814-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb814-17"><a href="#cb814-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the best parameters found by GridSearchCV</span></span>
<span id="cb814-18"><a href="#cb814-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Best Parameters:&quot;</span>, grid_search.best_params_)</span>
<span id="cb814-19"><a href="#cb814-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb814-20"><a href="#cb814-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the best estimator from GridSearchCV to make predictions</span></span>
<span id="cb814-21"><a href="#cb814-21" aria-hidden="true" tabindex="-1"></a>best_svm_classifier <span class="op">=</span> grid_search.best_estimator_</span>
<span id="cb814-22"><a href="#cb814-22" aria-hidden="true" tabindex="-1"></a>y_train_pred_svm_tuned <span class="op">=</span> best_svm_classifier.predict(X_train_lstm_reshaped)</span>
<span id="cb814-23"><a href="#cb814-23" aria-hidden="true" tabindex="-1"></a>y_test_pred_svm_tuned <span class="op">=</span> best_svm_classifier.predict(X_test_lstm_reshaped)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Fitting 5 folds for each of 32 candidates, totalling 160 fits
Best Parameters: {&#39;C&#39;: 0.1, &#39;gamma&#39;: 0.1, &#39;kernel&#39;: &#39;rbf&#39;}
</code></pre>
</div>
</div>
<section id="tl-svm-model-evaluation" class="cell markdown"
id="Tt-b-CPAcNRD">
<h2>TL SVM Model Evaluation</h2>
</section>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="ZarBYpbKcUKj" data-outputId="e309c2eb-cdbf-40e9-eca1-d03233c5cfe7">
<div class="sourceCode" id="cb816"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb816-1"><a href="#cb816-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluate the tuned SVM model</span></span>
<span id="cb816-2"><a href="#cb816-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Tuned SVM Accuracy on Training Set:&quot;</span>, accuracy_score(y_train, y_train_pred_svm_tuned))</span>
<span id="cb816-3"><a href="#cb816-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Tuned SVM Accuracy on Test Set:&quot;</span>, accuracy_score(y_test, y_test_pred_svm_tuned))</span>
<span id="cb816-4"><a href="#cb816-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb816-5"><a href="#cb816-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate metrics</span></span>
<span id="cb816-6"><a href="#cb816-6" aria-hidden="true" tabindex="-1"></a>precision <span class="op">=</span> precision_score(y_test, y_test_pred_svm_tuned)</span>
<span id="cb816-7"><a href="#cb816-7" aria-hidden="true" tabindex="-1"></a>recall <span class="op">=</span> recall_score(y_test, y_test_pred_svm_tuned)</span>
<span id="cb816-8"><a href="#cb816-8" aria-hidden="true" tabindex="-1"></a>f1 <span class="op">=</span> f1_score(y_test, y_test_pred_svm_tuned)</span>
<span id="cb816-9"><a href="#cb816-9" aria-hidden="true" tabindex="-1"></a>conf_matrix <span class="op">=</span> confusion_matrix(y_test, y_test_pred_svm_tuned)</span>
<span id="cb816-10"><a href="#cb816-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb816-11"><a href="#cb816-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Print metrics</span></span>
<span id="cb816-12"><a href="#cb816-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Precision:&quot;</span>, precision)</span>
<span id="cb816-13"><a href="#cb816-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Recall:&quot;</span>, recall)</span>
<span id="cb816-14"><a href="#cb816-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;F1-score:&quot;</span>, f1)</span>
<span id="cb816-15"><a href="#cb816-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Confusion Matrix:</span><span class="ch">\n</span><span class="st">&quot;</span>, conf_matrix)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Tuned SVM Accuracy on Training Set: 0.9990625
Tuned SVM Accuracy on Test Set: 0.6205
Precision: 0.6418383518225039
Recall: 0.5912408759124088
F1-score: 0.6155015197568389
Confusion Matrix:
 [[1267  678]
 [ 840 1215]]
</code></pre>
</div>
</div>
<section
id="comparison-of-custom-lstm-model-and-transfered-learnt-svm-model-based-on-custom-lstm"
class="cell markdown" id="v3QYcRVoh_BB">
<h1>Comparison of custom LSTM model and Transfered learnt SVM model
based on custom LSTM</h1>
</section>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:486}"
id="pGUNJWDNiJNT" data-outputId="ccf8f465-6071-4a3a-8529-7ccc7a77f52a">
<div class="sourceCode" id="cb818"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb818-1"><a href="#cb818-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb818-2"><a href="#cb818-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb818-3"><a href="#cb818-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> precision_score, recall_score, accuracy_score</span>
<span id="cb818-4"><a href="#cb818-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb818-5"><a href="#cb818-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate metrics for LSTM model</span></span>
<span id="cb818-6"><a href="#cb818-6" aria-hidden="true" tabindex="-1"></a>lstm_train_accuracy <span class="op">=</span> accuracy_score(y_train, y_train_lstm_pred)</span>
<span id="cb818-7"><a href="#cb818-7" aria-hidden="true" tabindex="-1"></a>lstm_test_accuracy <span class="op">=</span> accuracy_score(y_test, y_test_lstm_pred)</span>
<span id="cb818-8"><a href="#cb818-8" aria-hidden="true" tabindex="-1"></a>lstm_precision <span class="op">=</span> precision_score(y_test, y_test_lstm_pred)</span>
<span id="cb818-9"><a href="#cb818-9" aria-hidden="true" tabindex="-1"></a>lstm_recall <span class="op">=</span> recall_score(y_test, y_test_lstm_pred)</span>
<span id="cb818-10"><a href="#cb818-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb818-11"><a href="#cb818-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate metrics for SVM model</span></span>
<span id="cb818-12"><a href="#cb818-12" aria-hidden="true" tabindex="-1"></a>svm_train_accuracy <span class="op">=</span> accuracy_score(y_train, y_train_pred_svm_tuned)</span>
<span id="cb818-13"><a href="#cb818-13" aria-hidden="true" tabindex="-1"></a>svm_test_accuracy <span class="op">=</span> accuracy_score(y_test, y_test_pred_svm_tuned)</span>
<span id="cb818-14"><a href="#cb818-14" aria-hidden="true" tabindex="-1"></a>svm_precision <span class="op">=</span> precision_score(y_test, y_test_pred_svm_tuned)</span>
<span id="cb818-15"><a href="#cb818-15" aria-hidden="true" tabindex="-1"></a>svm_recall <span class="op">=</span> recall_score(y_test, y_test_pred_svm_tuned)</span>
<span id="cb818-16"><a href="#cb818-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb818-17"><a href="#cb818-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Find maximum values for each metric for both models</span></span>
<span id="cb818-18"><a href="#cb818-18" aria-hidden="true" tabindex="-1"></a>max_train_accuracy_lstm <span class="op">=</span> lstm_train_accuracy</span>
<span id="cb818-19"><a href="#cb818-19" aria-hidden="true" tabindex="-1"></a>max_test_accuracy_lstm <span class="op">=</span> lstm_test_accuracy</span>
<span id="cb818-20"><a href="#cb818-20" aria-hidden="true" tabindex="-1"></a>max_precision_lstm <span class="op">=</span> lstm_precision</span>
<span id="cb818-21"><a href="#cb818-21" aria-hidden="true" tabindex="-1"></a>max_recall_lstm <span class="op">=</span> lstm_recall</span>
<span id="cb818-22"><a href="#cb818-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb818-23"><a href="#cb818-23" aria-hidden="true" tabindex="-1"></a>max_train_accuracy_svm <span class="op">=</span> svm_train_accuracy</span>
<span id="cb818-24"><a href="#cb818-24" aria-hidden="true" tabindex="-1"></a>max_test_accuracy_svm <span class="op">=</span> svm_test_accuracy</span>
<span id="cb818-25"><a href="#cb818-25" aria-hidden="true" tabindex="-1"></a>max_precision_svm <span class="op">=</span> svm_precision</span>
<span id="cb818-26"><a href="#cb818-26" aria-hidden="true" tabindex="-1"></a>max_recall_svm <span class="op">=</span> svm_recall</span>
<span id="cb818-27"><a href="#cb818-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb818-28"><a href="#cb818-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Create labels and metrics arrays for both models</span></span>
<span id="cb818-29"><a href="#cb818-29" aria-hidden="true" tabindex="-1"></a>labels <span class="op">=</span> [<span class="st">&#39;Train Accuracy&#39;</span>, <span class="st">&#39;Test Accuracy&#39;</span>, <span class="st">&#39;Precision&#39;</span>, <span class="st">&#39;Recall&#39;</span>]</span>
<span id="cb818-30"><a href="#cb818-30" aria-hidden="true" tabindex="-1"></a>lstm_metrics <span class="op">=</span> [lstm_train_accuracy, lstm_test_accuracy, lstm_precision, lstm_recall]</span>
<span id="cb818-31"><a href="#cb818-31" aria-hidden="true" tabindex="-1"></a>svm_metrics <span class="op">=</span> [svm_train_accuracy, svm_test_accuracy, svm_precision, svm_recall]</span>
<span id="cb818-32"><a href="#cb818-32" aria-hidden="true" tabindex="-1"></a>max_values_lstm <span class="op">=</span> [max_train_accuracy_lstm, max_test_accuracy_lstm, max_precision_lstm, max_recall_lstm]</span>
<span id="cb818-33"><a href="#cb818-33" aria-hidden="true" tabindex="-1"></a>max_values_svm <span class="op">=</span> [max_train_accuracy_svm, max_test_accuracy_svm, max_precision_svm, max_recall_svm]</span>
<span id="cb818-34"><a href="#cb818-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb818-35"><a href="#cb818-35" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.arange(<span class="bu">len</span>(labels))</span>
<span id="cb818-36"><a href="#cb818-36" aria-hidden="true" tabindex="-1"></a>width <span class="op">=</span> <span class="fl">0.35</span></span>
<span id="cb818-37"><a href="#cb818-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb818-38"><a href="#cb818-38" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb818-39"><a href="#cb818-39" aria-hidden="true" tabindex="-1"></a>rects1 <span class="op">=</span> ax.bar(x <span class="op">-</span> width<span class="op">/</span><span class="dv">2</span>, lstm_metrics, width, label<span class="op">=</span><span class="st">&#39;LSTM&#39;</span>, color<span class="op">=</span><span class="st">&#39;cyan&#39;</span>)</span>
<span id="cb818-40"><a href="#cb818-40" aria-hidden="true" tabindex="-1"></a>rects2 <span class="op">=</span> ax.bar(x <span class="op">+</span> width<span class="op">/</span><span class="dv">2</span>, svm_metrics, width, label<span class="op">=</span><span class="st">&#39;SVM&#39;</span>, color<span class="op">=</span><span class="st">&#39;magenta&#39;</span>)</span>
<span id="cb818-41"><a href="#cb818-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb818-42"><a href="#cb818-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Add annotations for maximum values</span></span>
<span id="cb818-43"><a href="#cb818-43" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, v <span class="kw">in</span> <span class="bu">enumerate</span>(max_values_lstm):</span>
<span id="cb818-44"><a href="#cb818-44" aria-hidden="true" tabindex="-1"></a>    ax.text(i <span class="op">-</span> width<span class="op">/</span><span class="dv">2</span>, v <span class="op">+</span> <span class="fl">0.01</span>, <span class="ss">f&#39;</span><span class="sc">{</span>v<span class="sc">:.4f}</span><span class="ss">&#39;</span>, ha<span class="op">=</span><span class="st">&#39;center&#39;</span>, va<span class="op">=</span><span class="st">&#39;bottom&#39;</span>, color<span class="op">=</span><span class="st">&#39;white&#39;</span>, fontweight<span class="op">=</span><span class="st">&#39;bold&#39;</span>, rotation<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb818-45"><a href="#cb818-45" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, v <span class="kw">in</span> <span class="bu">enumerate</span>(max_values_svm):</span>
<span id="cb818-46"><a href="#cb818-46" aria-hidden="true" tabindex="-1"></a>    ax.text(i <span class="op">+</span> width<span class="op">/</span><span class="dv">2</span>, v <span class="op">+</span> <span class="fl">0.01</span>, <span class="ss">f&#39;</span><span class="sc">{</span>v<span class="sc">:.4f}</span><span class="ss">&#39;</span>, ha<span class="op">=</span><span class="st">&#39;center&#39;</span>, va<span class="op">=</span><span class="st">&#39;bottom&#39;</span>, color<span class="op">=</span><span class="st">&#39;white&#39;</span>, fontweight<span class="op">=</span><span class="st">&#39;bold&#39;</span>, rotation<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb818-47"><a href="#cb818-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb818-48"><a href="#cb818-48" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">&#39;Scores&#39;</span>)</span>
<span id="cb818-49"><a href="#cb818-49" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">&#39;Comparison of LSTM and SVM Models&#39;</span>)</span>
<span id="cb818-50"><a href="#cb818-50" aria-hidden="true" tabindex="-1"></a>ax.set_xticks(x)</span>
<span id="cb818-51"><a href="#cb818-51" aria-hidden="true" tabindex="-1"></a>ax.set_xticklabels(labels, color<span class="op">=</span><span class="st">&#39;white&#39;</span>)  <span class="co"># Set labels color to white</span></span>
<span id="cb818-52"><a href="#cb818-52" aria-hidden="true" tabindex="-1"></a>ax.legend()</span>
<span id="cb818-53"><a href="#cb818-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb818-54"><a href="#cb818-54" aria-hidden="true" tabindex="-1"></a><span class="co"># Set background color</span></span>
<span id="cb818-55"><a href="#cb818-55" aria-hidden="true" tabindex="-1"></a>fig.patch.set_facecolor(<span class="st">&#39;black&#39;</span>)</span>
<span id="cb818-56"><a href="#cb818-56" aria-hidden="true" tabindex="-1"></a>ax.set_facecolor(<span class="st">&#39;black&#39;</span>)</span>
<span id="cb818-57"><a href="#cb818-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb818-58"><a href="#cb818-58" aria-hidden="true" tabindex="-1"></a>fig.tight_layout()</span>
<span id="cb818-59"><a href="#cb818-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb818-60"><a href="#cb818-60" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_bbbc7c3ec5c04b7191d21d4c180a5040/ea01df346535f77ed6a9cdcf9a58bf713fd8ac48.png" /></p>
</div>
</div>
<section id="svm" class="cell markdown" id="UlRBSFH0inaK">
<h1>SVM</h1>
</section>
<section id="initializing-svm-and-making-train-test-split"
class="cell markdown" id="jycxpngpjf9u">
<h2>initializing SVM and making train test split</h2>
</section>
<div class="cell code" id="YrPwCKQKisg8">
<div class="sourceCode" id="cb819"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb819-1"><a href="#cb819-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.svm <span class="im">import</span> SVC</span>
<span id="cb819-2"><a href="#cb819-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> classification_report, accuracy_score, precision_score, recall_score, f1_score, confusion_matrix</span>
<span id="cb819-3"><a href="#cb819-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb819-4"><a href="#cb819-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb819-5"><a href="#cb819-5" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> combined_matrix_combined</span>
<span id="cb819-6"><a href="#cb819-6" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> df[<span class="st">&#39;label&#39;</span>]<span class="co"># Target variable</span></span></code></pre></div>
</div>
<div class="cell code" id="mfJZS943jJlD">
<div class="sourceCode" id="cb820"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb820-1"><a href="#cb820-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Splitting the dataset into the Training set and Test set</span></span>
<span id="cb820-2"><a href="#cb820-2" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X, y, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb820-3"><a href="#cb820-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb820-4"><a href="#cb820-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Initializing the SVM Classifier</span></span>
<span id="cb820-5"><a href="#cb820-5" aria-hidden="true" tabindex="-1"></a>svm_classifier <span class="op">=</span> SVC(probability<span class="op">=</span><span class="va">True</span>, kernel<span class="op">=</span><span class="st">&#39;rbf&#39;</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb820-6"><a href="#cb820-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb820-7"><a href="#cb820-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Training the model on the training set</span></span>
<span id="cb820-8"><a href="#cb820-8" aria-hidden="true" tabindex="-1"></a>svm_classifier.fit(X_train, y_train)</span>
<span id="cb820-9"><a href="#cb820-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb820-10"><a href="#cb820-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Making predictions on the training set</span></span>
<span id="cb820-11"><a href="#cb820-11" aria-hidden="true" tabindex="-1"></a>y_train_pred <span class="op">=</span> svm_classifier.predict(X_train)</span>
<span id="cb820-12"><a href="#cb820-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb820-13"><a href="#cb820-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Making predictions on the test set</span></span>
<span id="cb820-14"><a href="#cb820-14" aria-hidden="true" tabindex="-1"></a>y_test_pred <span class="op">=</span> svm_classifier.predict(X_test)</span></code></pre></div>
</div>
<section id="svm-evaluation" class="cell markdown" id="z69w2f8cjn6G">
<h2>SVM Evaluation</h2>
</section>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="YncdtQaDjpwa" data-outputId="1d79d4db-f6c6-4ae0-f3e5-453279bb6b53">
<div class="sourceCode" id="cb821"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb821-1"><a href="#cb821-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate accuracies</span></span>
<span id="cb821-2"><a href="#cb821-2" aria-hidden="true" tabindex="-1"></a>train_accuracy <span class="op">=</span> accuracy_score(y_train, y_train_pred)</span>
<span id="cb821-3"><a href="#cb821-3" aria-hidden="true" tabindex="-1"></a>test_accuracy <span class="op">=</span> accuracy_score(y_test, y_test_pred)</span>
<span id="cb821-4"><a href="#cb821-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb821-5"><a href="#cb821-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Print accuracies</span></span>
<span id="cb821-6"><a href="#cb821-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Train Accuracy:&quot;</span>, train_accuracy)</span>
<span id="cb821-7"><a href="#cb821-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Test Accuracy:&quot;</span>, test_accuracy)</span>
<span id="cb821-8"><a href="#cb821-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb821-9"><a href="#cb821-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate metrics</span></span>
<span id="cb821-10"><a href="#cb821-10" aria-hidden="true" tabindex="-1"></a>precision <span class="op">=</span> precision_score(y_test, y_test_pred)</span>
<span id="cb821-11"><a href="#cb821-11" aria-hidden="true" tabindex="-1"></a>recall <span class="op">=</span> recall_score(y_test, y_test_pred)</span>
<span id="cb821-12"><a href="#cb821-12" aria-hidden="true" tabindex="-1"></a>f1 <span class="op">=</span> f1_score(y_test, y_test_pred)</span>
<span id="cb821-13"><a href="#cb821-13" aria-hidden="true" tabindex="-1"></a>conf_matrix <span class="op">=</span> confusion_matrix(y_test, y_test_pred)</span>
<span id="cb821-14"><a href="#cb821-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb821-15"><a href="#cb821-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Print metrics</span></span>
<span id="cb821-16"><a href="#cb821-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Precision:&quot;</span>, precision)</span>
<span id="cb821-17"><a href="#cb821-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Recall:&quot;</span>, recall)</span>
<span id="cb821-18"><a href="#cb821-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;F1-score:&quot;</span>, f1)</span>
<span id="cb821-19"><a href="#cb821-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Confusion Matrix:</span><span class="ch">\n</span><span class="st">&quot;</span>, conf_matrix)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Train Accuracy: 0.802375
Test Accuracy: 0.6215
Precision: 0.6467889908256881
Recall: 0.5567620927936822
F1-score: 0.5984084880636605
Confusion Matrix:
 [[679 308]
 [449 564]]
</code></pre>
</div>
</div>
<div class="cell code" id="EvyqEBAUp0Ke">
<div class="sourceCode" id="cb823"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb823-1"><a href="#cb823-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> lime <span class="im">import</span> lime_tabular</span>
<span id="cb823-2"><a href="#cb823-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb823-3"><a href="#cb823-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert feature names to strings</span></span>
<span id="cb823-4"><a href="#cb823-4" aria-hidden="true" tabindex="-1"></a>feature_names_str <span class="op">=</span> [<span class="bu">str</span>(i) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(X_train.shape[<span class="dv">1</span>])]</span>
<span id="cb823-5"><a href="#cb823-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb823-6"><a href="#cb823-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize LIME explainer</span></span>
<span id="cb823-7"><a href="#cb823-7" aria-hidden="true" tabindex="-1"></a>explainer <span class="op">=</span> lime_tabular.LimeTabularExplainer(X_train.toarray(),</span>
<span id="cb823-8"><a href="#cb823-8" aria-hidden="true" tabindex="-1"></a>                                              feature_names<span class="op">=</span>feature_names_str,</span>
<span id="cb823-9"><a href="#cb823-9" aria-hidden="true" tabindex="-1"></a>                                              class_names<span class="op">=</span>[<span class="st">&#39;Non-Sarcastic&#39;</span>, <span class="st">&#39;Sarcastic&#39;</span>],</span>
<span id="cb823-10"><a href="#cb823-10" aria-hidden="true" tabindex="-1"></a>                                              discretize_continuous<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb823-11"><a href="#cb823-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb823-12"><a href="#cb823-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Define function to explain predictions for multiple instances</span></span>
<span id="cb823-13"><a href="#cb823-13" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> explain_predictions(instance_indices):</span>
<span id="cb823-14"><a href="#cb823-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> idx <span class="kw">in</span> instance_indices:</span>
<span id="cb823-15"><a href="#cb823-15" aria-hidden="true" tabindex="-1"></a>        instance <span class="op">=</span> X_test.toarray()[idx]</span>
<span id="cb823-16"><a href="#cb823-16" aria-hidden="true" tabindex="-1"></a>        explanation <span class="op">=</span> explainer.explain_instance(instance, svm_classifier.predict_proba, num_features<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb823-17"><a href="#cb823-17" aria-hidden="true" tabindex="-1"></a>        explanation.show_in_notebook()</span>
<span id="cb823-18"><a href="#cb823-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb823-19"><a href="#cb823-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Explain predictions for 10 specific instances (e.g., indices 0 to 9)</span></span>
<span id="cb823-20"><a href="#cb823-20" aria-hidden="true" tabindex="-1"></a>instance_indices <span class="op">=</span> <span class="bu">range</span>(<span class="dv">5</span>)</span>
<span id="cb823-21"><a href="#cb823-21" aria-hidden="true" tabindex="-1"></a>explain_predictions(instance_indices)</span></code></pre></div>
</div>
<section id="rf-classifier" class="cell markdown" id="PBwH8BxHryzi">
<h1>RF Classifier</h1>
</section>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="FS7lTNJw8a_o" data-outputId="250ad20c-194a-4680-92f1-197e49ea9cc7">
<div class="sourceCode" id="cb824"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb824-1"><a href="#cb824-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb824-2"><a href="#cb824-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> RandomForestClassifier</span>
<span id="cb824-3"><a href="#cb824-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> accuracy_score</span>
<span id="cb824-4"><a href="#cb824-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tensorflow <span class="im">as</span> tf</span>
<span id="cb824-5"><a href="#cb824-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb824-6"><a href="#cb824-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;labels&#39; is a binary column indicating sarcasm (1) or not sarcasm (0)</span></span>
<span id="cb824-7"><a href="#cb824-7" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> combined_matrix_combined</span>
<span id="cb824-8"><a href="#cb824-8" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> df[<span class="st">&quot;label&quot;</span>]</span>
<span id="cb824-9"><a href="#cb824-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb824-10"><a href="#cb824-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Split the data into training and testing sets</span></span>
<span id="cb824-11"><a href="#cb824-11" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X, y, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb824-12"><a href="#cb824-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb824-13"><a href="#cb824-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Defining and training the RandomForestClassifier</span></span>
<span id="cb824-14"><a href="#cb824-14" aria-hidden="true" tabindex="-1"></a>rf_classifier <span class="op">=</span> RandomForestClassifier(n_estimators<span class="op">=</span><span class="dv">250</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb824-15"><a href="#cb824-15" aria-hidden="true" tabindex="-1"></a>rf_classifier.fit(X_train, y_train)</span>
<span id="cb824-16"><a href="#cb824-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb824-17"><a href="#cb824-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Make predictions</span></span>
<span id="cb824-18"><a href="#cb824-18" aria-hidden="true" tabindex="-1"></a>y_train_pred <span class="op">=</span> rf_classifier.predict(X_train)</span>
<span id="cb824-19"><a href="#cb824-19" aria-hidden="true" tabindex="-1"></a>y_test_pred <span class="op">=</span> rf_classifier.predict(X_test)</span>
<span id="cb824-20"><a href="#cb824-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb824-21"><a href="#cb824-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the accuracy of the model on training set</span></span>
<span id="cb824-22"><a href="#cb824-22" aria-hidden="true" tabindex="-1"></a>train_accuracy <span class="op">=</span> accuracy_score(y_train, y_train_pred)</span>
<span id="cb824-23"><a href="#cb824-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Train Accuracy:&quot;</span>, train_accuracy)</span>
<span id="cb824-24"><a href="#cb824-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb824-25"><a href="#cb824-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the accuracy of the model on test set</span></span>
<span id="cb824-26"><a href="#cb824-26" aria-hidden="true" tabindex="-1"></a>test_accuracy <span class="op">=</span> accuracy_score(y_test, y_test_pred)</span>
<span id="cb824-27"><a href="#cb824-27" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Test Accuracy:&quot;</span>, test_accuracy)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Train Accuracy: 1.0
Test Accuracy: 0.6045
</code></pre>
</div>
</div>
<div class="cell markdown" id="lOndq-Rx8a_o">
<p><strong>Evaluating the RF Classifier</strong></p>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="HlPaBn0f8a_o" data-outputId="3650e796-7982-45f5-acc8-bb077b11c32c">
<div class="sourceCode" id="cb826"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb826-1"><a href="#cb826-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> accuracy_score, precision_score, recall_score, f1_score, confusion_matrix</span>
<span id="cb826-2"><a href="#cb826-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb826-3"><a href="#cb826-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate predictions</span></span>
<span id="cb826-4"><a href="#cb826-4" aria-hidden="true" tabindex="-1"></a>y_pred <span class="op">=</span> rf_classifier.predict(X_test)</span>
<span id="cb826-5"><a href="#cb826-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb826-6"><a href="#cb826-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate accuracy</span></span>
<span id="cb826-7"><a href="#cb826-7" aria-hidden="true" tabindex="-1"></a>accuracy <span class="op">=</span> accuracy_score(y_test, y_pred)</span>
<span id="cb826-8"><a href="#cb826-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Accuracy:&quot;</span>, accuracy)</span>
<span id="cb826-9"><a href="#cb826-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb826-10"><a href="#cb826-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate precision</span></span>
<span id="cb826-11"><a href="#cb826-11" aria-hidden="true" tabindex="-1"></a>precision <span class="op">=</span> precision_score(y_test, y_pred)</span>
<span id="cb826-12"><a href="#cb826-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Precision:&quot;</span>, precision)</span>
<span id="cb826-13"><a href="#cb826-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb826-14"><a href="#cb826-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate recall</span></span>
<span id="cb826-15"><a href="#cb826-15" aria-hidden="true" tabindex="-1"></a>recall <span class="op">=</span> recall_score(y_test, y_pred)</span>
<span id="cb826-16"><a href="#cb826-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Recall:&quot;</span>, recall)</span>
<span id="cb826-17"><a href="#cb826-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb826-18"><a href="#cb826-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate F1-score</span></span>
<span id="cb826-19"><a href="#cb826-19" aria-hidden="true" tabindex="-1"></a>f1 <span class="op">=</span> f1_score(y_test, y_pred)</span>
<span id="cb826-20"><a href="#cb826-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;F1-score:&quot;</span>, f1)</span>
<span id="cb826-21"><a href="#cb826-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb826-22"><a href="#cb826-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate confusion matrix</span></span>
<span id="cb826-23"><a href="#cb826-23" aria-hidden="true" tabindex="-1"></a>conf_matrix <span class="op">=</span> confusion_matrix(y_test, y_pred)</span>
<span id="cb826-24"><a href="#cb826-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Confusion Matrix:</span><span class="ch">\n</span><span class="st">&quot;</span>, conf_matrix)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Accuracy: 0.6045
Precision: 0.62117903930131
Recall: 0.5616979269496545
F1-score: 0.589942975635044
Confusion Matrix:
 [[640 347]
 [444 569]]
</code></pre>
</div>
</div>
<div class="cell markdown" id="GhzhdEPG8a_p">
<p><strong>Model Interpretability using LIME (Local Interpretable
Model-agnostic Explanations):</strong></p>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="kqk34qGV8a_p" data-outputId="c0040069-1d53-4327-c162-bc01abe39d75">
<div class="sourceCode" id="cb828"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb828-1"><a href="#cb828-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check the type of values in the label column</span></span>
<span id="cb828-2"><a href="#cb828-2" aria-hidden="true" tabindex="-1"></a>label_types <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb828-3"><a href="#cb828-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> val <span class="kw">in</span> df[<span class="st">&quot;label&quot;</span>]:</span>
<span id="cb828-4"><a href="#cb828-4" aria-hidden="true" tabindex="-1"></a>    label_types.add(<span class="bu">type</span>(val))</span>
<span id="cb828-5"><a href="#cb828-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb828-6"><a href="#cb828-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Types present in label column:&quot;</span>, label_types)</span>
<span id="cb828-7"><a href="#cb828-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb828-8"><a href="#cb828-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Check if the label column has values other than 0 and 1</span></span>
<span id="cb828-9"><a href="#cb828-9" aria-hidden="true" tabindex="-1"></a>unique_values <span class="op">=</span> <span class="bu">set</span>(df[<span class="st">&quot;label&quot;</span>])</span>
<span id="cb828-10"><a href="#cb828-10" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="bu">len</span>(unique_values <span class="op">-</span> {<span class="dv">0</span>, <span class="dv">1</span>}) <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb828-11"><a href="#cb828-11" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;Label column has values other than 0 and 1.&quot;</span>)</span>
<span id="cb828-12"><a href="#cb828-12" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb828-13"><a href="#cb828-13" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;Label column only has values 0 and 1.&quot;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Types present in label column: {&lt;class &#39;int&#39;&gt;}
Label column only has values 0 and 1.
</code></pre>
</div>
</div>
<div class="cell code" id="IFn-oZ6b8a_q">
<div class="sourceCode" id="cb830"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb830-1"><a href="#cb830-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> lime <span class="im">import</span> lime_tabular</span>
<span id="cb830-2"><a href="#cb830-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb830-3"><a href="#cb830-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert feature names to strings</span></span>
<span id="cb830-4"><a href="#cb830-4" aria-hidden="true" tabindex="-1"></a>feature_names_str <span class="op">=</span> [<span class="bu">str</span>(i) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(X_train.shape[<span class="dv">1</span>])]</span>
<span id="cb830-5"><a href="#cb830-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb830-6"><a href="#cb830-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize LIME explainer</span></span>
<span id="cb830-7"><a href="#cb830-7" aria-hidden="true" tabindex="-1"></a>explainer <span class="op">=</span> lime_tabular.LimeTabularExplainer(X_train.toarray(),</span>
<span id="cb830-8"><a href="#cb830-8" aria-hidden="true" tabindex="-1"></a>                                              feature_names<span class="op">=</span>feature_names_str,</span>
<span id="cb830-9"><a href="#cb830-9" aria-hidden="true" tabindex="-1"></a>                                              class_names<span class="op">=</span>[<span class="st">&#39;Non-Sarcastic&#39;</span>, <span class="st">&#39;Sarcastic&#39;</span>],</span>
<span id="cb830-10"><a href="#cb830-10" aria-hidden="true" tabindex="-1"></a>                                              discretize_continuous<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb830-11"><a href="#cb830-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb830-12"><a href="#cb830-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Define function to explain predictions for multiple instances</span></span>
<span id="cb830-13"><a href="#cb830-13" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> explain_predictions(instance_indices):</span>
<span id="cb830-14"><a href="#cb830-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> idx <span class="kw">in</span> instance_indices:</span>
<span id="cb830-15"><a href="#cb830-15" aria-hidden="true" tabindex="-1"></a>        instance <span class="op">=</span> X_test.toarray()[idx]</span>
<span id="cb830-16"><a href="#cb830-16" aria-hidden="true" tabindex="-1"></a>        explanation <span class="op">=</span> explainer.explain_instance(instance, rf_classifier.predict_proba, num_features<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb830-17"><a href="#cb830-17" aria-hidden="true" tabindex="-1"></a>        explanation.show_in_notebook()</span>
<span id="cb830-18"><a href="#cb830-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb830-19"><a href="#cb830-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Explain predictions for 5 specific instances</span></span>
<span id="cb830-20"><a href="#cb830-20" aria-hidden="true" tabindex="-1"></a>instance_indices <span class="op">=</span> <span class="bu">range</span>(<span class="dv">5</span>)</span>
<span id="cb830-21"><a href="#cb830-21" aria-hidden="true" tabindex="-1"></a>explain_predictions(instance_indices)</span></code></pre></div>
</div>
<section id="naive-bayes" class="cell markdown" id="aFCehAQ0-5Tw">
<h1>Naive Bayes</h1>
</section>
<section id="initializing-naive-bayes-and-doing-train-test-split"
class="cell markdown" id="fWBnIZTq_NGj">
<h2>Initializing Naive Bayes and doing Train test Split</h2>
</section>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="zxClRP1g_Jok" data-outputId="c7a44d93-cb8b-4b16-9b99-e2f868dcd85a">
<div class="sourceCode" id="cb831"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb831-1"><a href="#cb831-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.naive_bayes <span class="im">import</span> MultinomialNB</span>
<span id="cb831-2"><a href="#cb831-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> classification_report, accuracy_score</span>
<span id="cb831-3"><a href="#cb831-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb831-4"><a href="#cb831-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> scipy.sparse <span class="im">as</span> sp</span>
<span id="cb831-5"><a href="#cb831-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> GridSearchCV</span>
<span id="cb831-6"><a href="#cb831-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb831-7"><a href="#cb831-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the parameter grid</span></span>
<span id="cb831-8"><a href="#cb831-8" aria-hidden="true" tabindex="-1"></a>param_grid <span class="op">=</span> {</span>
<span id="cb831-9"><a href="#cb831-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;alpha&#39;</span>: [<span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="fl">1.0</span>, <span class="fl">2.0</span>, <span class="fl">5.0</span>, <span class="fl">10.0</span>],  <span class="co"># alpha values to try</span></span>
<span id="cb831-10"><a href="#cb831-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;fit_prior&#39;</span>: [<span class="va">True</span>, <span class="va">False</span>]  <span class="co"># fit_prior values to try</span></span>
<span id="cb831-11"><a href="#cb831-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb831-12"><a href="#cb831-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb831-13"><a href="#cb831-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Clip negative values to 0</span></span>
<span id="cb831-14"><a href="#cb831-14" aria-hidden="true" tabindex="-1"></a>X_clipped <span class="op">=</span> combined_matrix_combined.maximum(<span class="dv">0</span>)</span>
<span id="cb831-15"><a href="#cb831-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb831-16"><a href="#cb831-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to dense array if needed</span></span>
<span id="cb831-17"><a href="#cb831-17" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> sp.issparse(X_clipped):</span>
<span id="cb831-18"><a href="#cb831-18" aria-hidden="true" tabindex="-1"></a>    X_clipped <span class="op">=</span> X_clipped.toarray()</span>
<span id="cb831-19"><a href="#cb831-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb831-20"><a href="#cb831-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Split the data</span></span>
<span id="cb831-21"><a href="#cb831-21" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X_clipped, y, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb831-22"><a href="#cb831-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb831-23"><a href="#cb831-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize Naive Bayes classifier</span></span>
<span id="cb831-24"><a href="#cb831-24" aria-hidden="true" tabindex="-1"></a>nb_classifier <span class="op">=</span> MultinomialNB()</span>
<span id="cb831-25"><a href="#cb831-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb831-26"><a href="#cb831-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the GridSearchCV object</span></span>
<span id="cb831-27"><a href="#cb831-27" aria-hidden="true" tabindex="-1"></a>grid_search <span class="op">=</span> GridSearchCV(estimator<span class="op">=</span>MultinomialNB(), param_grid<span class="op">=</span>param_grid, cv<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb831-28"><a href="#cb831-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb831-29"><a href="#cb831-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform the grid search</span></span>
<span id="cb831-30"><a href="#cb831-30" aria-hidden="true" tabindex="-1"></a>grid_search.fit(X_train, y_train)</span>
<span id="cb831-31"><a href="#cb831-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb831-32"><a href="#cb831-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the best parameters found</span></span>
<span id="cb831-33"><a href="#cb831-33" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Best Parameters:&quot;</span>, grid_search.best_params_)</span>
<span id="cb831-34"><a href="#cb831-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb831-35"><a href="#cb831-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the best model</span></span>
<span id="cb831-36"><a href="#cb831-36" aria-hidden="true" tabindex="-1"></a>best_nb_classifier <span class="op">=</span> grid_search.best_estimator_</span>
<span id="cb831-37"><a href="#cb831-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb831-38"><a href="#cb831-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Predicting the Train and Test set results using the best model</span></span>
<span id="cb831-39"><a href="#cb831-39" aria-hidden="true" tabindex="-1"></a>y_train_pred <span class="op">=</span> best_nb_classifier.predict(X_train)</span>
<span id="cb831-40"><a href="#cb831-40" aria-hidden="true" tabindex="-1"></a>y_test_pred <span class="op">=</span> best_nb_classifier.predict(X_test)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Best Parameters: {&#39;alpha&#39;: 0.1, &#39;fit_prior&#39;: False}
</code></pre>
</div>
</div>
<section id="nb-evaluation" class="cell markdown" id="q2pgXkz-DSaC">
<h2>NB Evaluation</h2>
</section>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="6GcXtWN4DOWI" data-outputId="379725ba-44cd-49e1-e5a6-af30ed22d482">
<div class="sourceCode" id="cb833"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb833-1"><a href="#cb833-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate accuracies</span></span>
<span id="cb833-2"><a href="#cb833-2" aria-hidden="true" tabindex="-1"></a>train_accuracy <span class="op">=</span> accuracy_score(y_train, y_train_pred)</span>
<span id="cb833-3"><a href="#cb833-3" aria-hidden="true" tabindex="-1"></a>test_accuracy <span class="op">=</span> accuracy_score(y_test, y_test_pred)</span>
<span id="cb833-4"><a href="#cb833-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb833-5"><a href="#cb833-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Print accuracies</span></span>
<span id="cb833-6"><a href="#cb833-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Train Accuracy:&quot;</span>, train_accuracy)</span>
<span id="cb833-7"><a href="#cb833-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Test Accuracy:&quot;</span>, test_accuracy)</span>
<span id="cb833-8"><a href="#cb833-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb833-9"><a href="#cb833-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate metrics</span></span>
<span id="cb833-10"><a href="#cb833-10" aria-hidden="true" tabindex="-1"></a>precision <span class="op">=</span> precision_score(y_test, y_test_pred)</span>
<span id="cb833-11"><a href="#cb833-11" aria-hidden="true" tabindex="-1"></a>recall <span class="op">=</span> recall_score(y_test, y_test_pred)</span>
<span id="cb833-12"><a href="#cb833-12" aria-hidden="true" tabindex="-1"></a>f1 <span class="op">=</span> f1_score(y_test, y_test_pred)</span>
<span id="cb833-13"><a href="#cb833-13" aria-hidden="true" tabindex="-1"></a>conf_matrix <span class="op">=</span> confusion_matrix(y_test, y_test_pred)</span>
<span id="cb833-14"><a href="#cb833-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb833-15"><a href="#cb833-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Print metrics</span></span>
<span id="cb833-16"><a href="#cb833-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Precision:&quot;</span>, precision)</span>
<span id="cb833-17"><a href="#cb833-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Recall:&quot;</span>, recall)</span>
<span id="cb833-18"><a href="#cb833-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;F1-score:&quot;</span>, f1)</span>
<span id="cb833-19"><a href="#cb833-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Confusion Matrix:</span><span class="ch">\n</span><span class="st">&quot;</span>, conf_matrix)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Train Accuracy: 0.72375
Test Accuracy: 0.5995
Precision: 0.5990654205607476
Recall: 0.6327739387956565
F1-score: 0.6154584733557369
Confusion Matrix:
 [[558 429]
 [372 641]]
</code></pre>
</div>
</div>
<section
id="comparison-of-all-4-models-rf-classifier-lstm-svm-and-naive-bayes-classifier"
class="cell markdown" id="gqfaZFDUFlUo">
<h1>Comparison of All 4 Models RF classifier, LSTM, SVM and Naive Bayes
Classifier</h1>
</section>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:123}"
id="CY0DrJ6bFsG-" data-outputId="629de670-49f7-4806-9ecc-86cd83402045">
<div class="sourceCode" id="cb835"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb835-1"><a href="#cb835-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb835-2"><a href="#cb835-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb835-3"><a href="#cb835-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb835-4"><a href="#cb835-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the models and their corresponding names</span></span>
<span id="cb835-5"><a href="#cb835-5" aria-hidden="true" tabindex="-1"></a>models <span class="op">=</span> [rf_classifier, LSTMmodel, svm_classifier, best_nb_classifier]</span>
<span id="cb835-6"><a href="#cb835-6" aria-hidden="true" tabindex="-1"></a>model_names <span class="op">=</span> [<span class="st">&#39;Random Forest&#39;</span>, <span class="st">&#39;LSTM&#39;</span>, <span class="st">&#39;SVM&#39;</span>, <span class="st">&#39;Naive Bayes&#39;</span>]</span>
<span id="cb835-7"><a href="#cb835-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb835-8"><a href="#cb835-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize lists to store the metrics</span></span>
<span id="cb835-9"><a href="#cb835-9" aria-hidden="true" tabindex="-1"></a>train_accuracy <span class="op">=</span> []</span>
<span id="cb835-10"><a href="#cb835-10" aria-hidden="true" tabindex="-1"></a>test_accuracy <span class="op">=</span> []</span>
<span id="cb835-11"><a href="#cb835-11" aria-hidden="true" tabindex="-1"></a>precision <span class="op">=</span> []</span>
<span id="cb835-12"><a href="#cb835-12" aria-hidden="true" tabindex="-1"></a>recall <span class="op">=</span> []</span>
<span id="cb835-13"><a href="#cb835-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb835-14"><a href="#cb835-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate metrics for each model</span></span>
<span id="cb835-15"><a href="#cb835-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> model <span class="kw">in</span> models:</span>
<span id="cb835-16"><a href="#cb835-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> model <span class="op">==</span> LSTMmodel:</span>
<span id="cb835-17"><a href="#cb835-17" aria-hidden="true" tabindex="-1"></a>        X_train_reshaped <span class="op">=</span> X_train.reshape(X_train.shape[<span class="dv">0</span>], <span class="dv">1</span>, X_train.shape[<span class="dv">1</span>])</span>
<span id="cb835-18"><a href="#cb835-18" aria-hidden="true" tabindex="-1"></a>        X_test_reshaped <span class="op">=</span> X_test.reshape(X_test.shape[<span class="dv">0</span>], <span class="dv">1</span>, X_test.shape[<span class="dv">1</span>])</span>
<span id="cb835-19"><a href="#cb835-19" aria-hidden="true" tabindex="-1"></a>        train_accuracy.append(accuracy_score(y_train, np.<span class="bu">round</span>(model.predict(X_train_reshaped))))</span>
<span id="cb835-20"><a href="#cb835-20" aria-hidden="true" tabindex="-1"></a>        test_accuracy.append(accuracy_score(y_test, np.<span class="bu">round</span>(model.predict(X_test_reshaped))))</span>
<span id="cb835-21"><a href="#cb835-21" aria-hidden="true" tabindex="-1"></a>        precision.append(precision_score(y_test, np.<span class="bu">round</span>(model.predict(X_test_reshaped))))</span>
<span id="cb835-22"><a href="#cb835-22" aria-hidden="true" tabindex="-1"></a>        recall.append(recall_score(y_test, np.<span class="bu">round</span>(model.predict(X_test_reshaped))))</span>
<span id="cb835-23"><a href="#cb835-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb835-24"><a href="#cb835-24" aria-hidden="true" tabindex="-1"></a>        train_accuracy.append(accuracy_score(y_train, model.predict(X_train)))</span>
<span id="cb835-25"><a href="#cb835-25" aria-hidden="true" tabindex="-1"></a>        test_accuracy.append(accuracy_score(y_test, model.predict(X_test)))</span>
<span id="cb835-26"><a href="#cb835-26" aria-hidden="true" tabindex="-1"></a>        precision.append(precision_score(y_test, model.predict(X_test)))</span>
<span id="cb835-27"><a href="#cb835-27" aria-hidden="true" tabindex="-1"></a>        recall.append(recall_score(y_test, model.predict(X_test)))</span>
<span id="cb835-28"><a href="#cb835-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb835-29"><a href="#cb835-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting</span></span>
<span id="cb835-30"><a href="#cb835-30" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">6</span>))</span>
<span id="cb835-31"><a href="#cb835-31" aria-hidden="true" tabindex="-1"></a>bar_width <span class="op">=</span> <span class="fl">0.2</span></span>
<span id="cb835-32"><a href="#cb835-32" aria-hidden="true" tabindex="-1"></a>index <span class="op">=</span> np.arange(<span class="bu">len</span>(models))</span>
<span id="cb835-33"><a href="#cb835-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb835-34"><a href="#cb835-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Bar plots</span></span>
<span id="cb835-35"><a href="#cb835-35" aria-hidden="true" tabindex="-1"></a>rects1 <span class="op">=</span> ax.bar(index, train_accuracy, bar_width, label<span class="op">=</span><span class="st">&#39;Train Accuracy&#39;</span>)</span>
<span id="cb835-36"><a href="#cb835-36" aria-hidden="true" tabindex="-1"></a>rects2 <span class="op">=</span> ax.bar(index <span class="op">+</span> bar_width, test_accuracy, bar_width, label<span class="op">=</span><span class="st">&#39;Test Accuracy&#39;</span>)</span>
<span id="cb835-37"><a href="#cb835-37" aria-hidden="true" tabindex="-1"></a>rects3 <span class="op">=</span> ax.bar(index <span class="op">+</span> <span class="dv">2</span> <span class="op">*</span> bar_width, precision, bar_width, label<span class="op">=</span><span class="st">&#39;Precision&#39;</span>)</span>
<span id="cb835-38"><a href="#cb835-38" aria-hidden="true" tabindex="-1"></a>rects4 <span class="op">=</span> ax.bar(index <span class="op">+</span> <span class="dv">3</span> <span class="op">*</span> bar_width, recall, bar_width, label<span class="op">=</span><span class="st">&#39;Recall&#39;</span>)</span>
<span id="cb835-39"><a href="#cb835-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb835-40"><a href="#cb835-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Adding labels, title, and legend</span></span>
<span id="cb835-41"><a href="#cb835-41" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">&#39;Models&#39;</span>)</span>
<span id="cb835-42"><a href="#cb835-42" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">&#39;Scores&#39;</span>)</span>
<span id="cb835-43"><a href="#cb835-43" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">&#39;Comparison of Model Performance&#39;</span>)</span>
<span id="cb835-44"><a href="#cb835-44" aria-hidden="true" tabindex="-1"></a>ax.set_xticks(index <span class="op">+</span> <span class="fl">1.5</span> <span class="op">*</span> bar_width)</span>
<span id="cb835-45"><a href="#cb835-45" aria-hidden="true" tabindex="-1"></a>ax.set_xticklabels(model_names)</span>
<span id="cb835-46"><a href="#cb835-46" aria-hidden="true" tabindex="-1"></a>ax.legend()</span>
<span id="cb835-47"><a href="#cb835-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb835-48"><a href="#cb835-48" aria-hidden="true" tabindex="-1"></a><span class="co"># Highlighting maximum values</span></span>
<span id="cb835-49"><a href="#cb835-49" aria-hidden="true" tabindex="-1"></a>max_train_acc <span class="op">=</span> <span class="bu">max</span>(train_accuracy)</span>
<span id="cb835-50"><a href="#cb835-50" aria-hidden="true" tabindex="-1"></a>max_test_acc <span class="op">=</span> <span class="bu">max</span>(test_accuracy)</span>
<span id="cb835-51"><a href="#cb835-51" aria-hidden="true" tabindex="-1"></a>max_prec <span class="op">=</span> <span class="bu">max</span>(precision)</span>
<span id="cb835-52"><a href="#cb835-52" aria-hidden="true" tabindex="-1"></a>max_rec <span class="op">=</span> <span class="bu">max</span>(recall)</span>
<span id="cb835-53"><a href="#cb835-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb835-54"><a href="#cb835-54" aria-hidden="true" tabindex="-1"></a>ax.annotate(<span class="ss">f&#39;Max Train Acc: </span><span class="sc">{</span>max_train_acc<span class="sc">:.3f}</span><span class="ss">&#39;</span>, xy<span class="op">=</span>(train_accuracy.index(max_train_acc), max_train_acc),</span>
<span id="cb835-55"><a href="#cb835-55" aria-hidden="true" tabindex="-1"></a>            xytext<span class="op">=</span>(<span class="op">-</span><span class="dv">20</span>, <span class="dv">10</span>), textcoords<span class="op">=</span><span class="st">&#39;offset points&#39;</span>, arrowprops<span class="op">=</span><span class="bu">dict</span>(arrowstyle<span class="op">=</span><span class="st">&#39;-&gt;&#39;</span>, connectionstyle<span class="op">=</span><span class="st">&#39;angle3&#39;</span>))</span>
<span id="cb835-56"><a href="#cb835-56" aria-hidden="true" tabindex="-1"></a>ax.annotate(<span class="ss">f&#39;Max Test Acc: </span><span class="sc">{</span>max_test_acc<span class="sc">:.3f}</span><span class="ss">&#39;</span>, xy<span class="op">=</span>(test_accuracy.index(max_test_acc), max_test_acc),</span>
<span id="cb835-57"><a href="#cb835-57" aria-hidden="true" tabindex="-1"></a>            xytext<span class="op">=</span>(<span class="op">-</span><span class="dv">20</span>, <span class="dv">10</span>), textcoords<span class="op">=</span><span class="st">&#39;offset points&#39;</span>, arrowprops<span class="op">=</span><span class="bu">dict</span>(arrowstyle<span class="op">=</span><span class="st">&#39;-&gt;&#39;</span>, connectionstyle<span class="op">=</span><span class="st">&#39;angle3&#39;</span>))</span>
<span id="cb835-58"><a href="#cb835-58" aria-hidden="true" tabindex="-1"></a>ax.annotate(<span class="ss">f&#39;Max Precision: </span><span class="sc">{</span>max_prec<span class="sc">:.3f}</span><span class="ss">&#39;</span>, xy<span class="op">=</span>(precision.index(max_prec), max_prec),</span>
<span id="cb835-59"><a href="#cb835-59" aria-hidden="true" tabindex="-1"></a>            xytext<span class="op">=</span>(<span class="op">-</span><span class="dv">20</span>, <span class="dv">10</span>), textcoords<span class="op">=</span><span class="st">&#39;offset points&#39;</span>, arrowprops<span class="op">=</span><span class="bu">dict</span>(arrowstyle<span class="op">=</span><span class="st">&#39;-&gt;&#39;</span>, connectionstyle<span class="op">=</span><span class="st">&#39;angle3&#39;</span>))</span>
<span id="cb835-60"><a href="#cb835-60" aria-hidden="true" tabindex="-1"></a>ax.annotate(<span class="ss">f&#39;Max Recall: </span><span class="sc">{</span>max_rec<span class="sc">:.3f}</span><span class="ss">&#39;</span>, xy<span class="op">=</span>(recall.index(max_rec), max_rec),</span>
<span id="cb835-61"><a href="#cb835-61" aria-hidden="true" tabindex="-1"></a>            xytext<span class="op">=</span>(<span class="op">-</span><span class="dv">20</span>, <span class="dv">10</span>), textcoords<span class="op">=</span><span class="st">&#39;offset points&#39;</span>, arrowprops<span class="op">=</span><span class="bu">dict</span>(arrowstyle<span class="op">=</span><span class="st">&#39;-&gt;&#39;</span>, connectionstyle<span class="op">=</span><span class="st">&#39;angle3&#39;</span>))</span>
<span id="cb835-62"><a href="#cb835-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb835-63"><a href="#cb835-63" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb835-64"><a href="#cb835-64" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output execute_result" data-execution_count="68">
<div class="sourceCode" id="cb836"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb836-1"><a href="#cb836-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;type&quot;</span><span class="fu">:</span><span class="st">&quot;string&quot;</span><span class="fu">}</span></span></code></pre></div>
</div>
</div>
</body>
</html>
